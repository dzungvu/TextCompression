b'InternationalJournalofComputerVision50(3),271293,2002\nc2002KluwerAcademicPublishers.ManufacturedinTheNetherlands.\nAMultiphaseLevelSetFrameworkforImageSegmentation\nUsingtheMumfordandShahModel\nLUMINITAA.VESEANDTONYF.CHAN\nDepartmentofMathematics,UniversityofCalifornia,LosAngeles,California,USA\nReceivedDecember18,2000;RevisedJuly2,2002;AcceptedJuly10,2002\nAbstract.WeproposeanewmultiphaselevelsetframeworkforimagesegmentationusingtheMumfordand\nShahmodel,forpiecewiseconstantandpiecewisesmoothoptimalapproximations.Theproposedmethodisalso\n\nageneralizationofanactivecontourmodelwithoutedgesbased2-phasesegmentation,developedbytheauthors\n\nearlierinT.ChanandL.Vese(1999.In\nScale-Space99,M.Nilsenetal.(Eds.),LNCS,vol.1682,pp.141151)and\nT.ChanandL.Vese(2001.IEEE-IP,10(2):266277).Themultiphaselevelsetformulationisnewandofinterest\n\nonitsown:byconstruction,itautomaticallyavoidstheproblemsofvacuumandoverlap;itneedsonlylog\nnlevel\nsetfunctionsfor\nnphasesinthepiecewiseconstantcase;itcanrepresentboundarieswithcomplextopologies,\nincludingtriplejunctions;inthepiecewisesmoothcase,onlytwolevelsetfunctionsformallysufcetorepresent\n\nanypartition,basedonTheFour-ColorTheorem.Finally,wevalidatetheproposedmodelsbynumericalresultsfor\n\nsignalandimagedenoisingandsegmentation,implementedusingtheOsherandSethianlevelsetmethod.\nKeywords:\nenergyminimization,multi-phasemotion,imagesegmentation,levelsets,curvature,PDEs,denois-\ning,edgedetection,activecontours\n1.IntroductionandMotivations,Related\nRelevantWork\nThemethodintroducedinthispaperextendsandgener-\nalizestheactivecontourmodelwithoutedgesbasedbi-\n\nnarysegmentationandlevelsets,previouslyproposed\n\nbytheauthorsinChanandVese(1999,2001).Inthat\n\nwork,toobtainanactivecontourmodelforobjectde-\n\ntection,thebasicideawastolookforaparticularparti-\n\ntionofagivenimageintotworegions,onerepresenting\n\ntheobjectstobedetected,andthesecondonerepre-\n\nsentingthebackground.Theactivecontourwasgiven\n\nbytheboundarybetweenthesetworegions.Itturned\n\noutthatthemodelwasaparticularcaseofthemini-\n\nmalpartitionproblemofMumfordandShah(1989)for\n\nsegmentationofimages.Fortheimplementationofthe\n\nactivecontourmodelfromChanandVese(1999,2001),\nTheauthorswouldliketodedicatethispapertoStanleyOsher,on\ntheoccasionofhis60thbirthday.\nthelevelsetmethodofOsherandSethian(1988)was\nsuccessfullyused,togetherwithaparticularnumerical\n\napproximation,whichallowedtoautomaticallydetect\n\ninteriorcontours.Themethodwastheneasilyextended\n\ntovector-valuedimages(Chanetal.,2000),andisro-\n\nbustwithrespecttonoise.\nInthispaper,wegeneralizefurtherthisactivecon-\ntourmodel(basedbinarysegmentation),tosegment\n\nimageswithmorethantworegions,byproposinga\n\nnewmultiphaselevelsetframeworkforthe(Mumford\n\nandShah,1989)problem.Wewillshowthat,witha\n\nreducednumberoflevelsetfunctions,triplejunctions\n\nandcomplextopologiescanberepresented.Inaddition,\n\nthephasesusedinthepartitiondonotproducevac-\n\nuumandoverlap.Finally,inthepiecewisesmooth\n\ncase,basedonTheFour-ColorTheorem,weshowthat\n\nonlytwolevelsetfunctionsformallyshouldsufceto\n\nrepresentanypartition.\nTheoutlineofthepaperisasfollows:inthisIn-\ntroduction,wegivethenecessarybackgroundonthe\n'b'272VeseandChan\nmaintwoingredientsofthemethod:theMumfordand\nShahmodelandvariationallevelsets;then,weshortly\n\ndescribethemostrelatedrelevantwork.InSection2,\n\nwepresenttheproposedmodelinthepiecewisecon-\n\nstantcaseintwodimensions,whileinSection3we\n\nconsiderthepiecewisesmoothversionofthemodel,\n\ninoneandtwodimensions.Finally,inSection4we\n\npresentnumericalresultsforsignalandimagedenois-\n\ningandsegmentation,usingtheproposedmodels,and\n\nweendthepaperbyashortconcludingsectionandan\n\nappendix,withthedetailsofthenumericalalgorithms.\n1.1.TheMumfordandShahProblem\nLet2beopenandbounded.Forthepurpose\nofillustration,weconsiderforthemomentthetwo-\n\ndimensionalcase,butanydimensioncouldbecon-\n\nsidered.Forinstance,wewillalsotreattheone-\n\ndimensionalcaseinSection3.Let\nCbeaclosedsubset\nin,madeupofa\nnitesetofsmoothcurves.Thecon-\nnectedcomponentsof\nCaredenotedby\ni,such\nthatiiC.Wealsodenoteby\nCthelength\nofcurvesmakingup\nC.Let\nu0:beagiven\nboundedimage-function.\nThesegmentationproblemincomputervision,as\nformulatedbyMumfordandShah(1989),canbede-\n\nnedasfollows:givenanobservedimage\nu0,ndade-\ncompositioniofandanoptimalpiecewisesmooth\napproximationuofu0,suchthat\nuvariessmoothly\nwithineach\ni,andrapidlyordiscontinuouslyacross\ntheboundariesof\ni.Tosolvethisproblem,MumfordandShah(1989)\nproposedthefollowingminimizationproblem:\ninfuCFMS(uC)(uu0)2dxdy\nCu2dxdy\nC(1)where\n0are\nxedparameters,toweightthe\ndifferenttermsintheenergy.For(\nuC)aminimizerof\ntheaboveenergy,\nuisan\noptimalpiecewisesmooth\napproximationoftheinitial,possiblynoisy,image\nu0,andChastheroleofapproximatingtheedgesof\nu0;uwillbesmoothonlyoutside\nC,i.e.on\nC.Theoretical\nresultsofexistenceandregularityofminimizersof(1)\n\ncanbefoundforexampleinMumfordandShah(1989),\n\nMorelandSolimini(1988,1989,1994),andDeGiorgi\n\netal.(1989).\nAreducedcaseoftheabovemodelisobtainedby\nrestrictingthesegmentedimage\nutopiecewiseconstant\nfunctions,i.e.\nuconstantciinsideeachconnected\ncomponenti.Thentheproblemisoftencalledthe\nminimalpartitionproblem,\nandinordertosolveit,\ninMumfordandShah(1989)itisproposedtominimize\n\nthefollowingfunctional:\nEMS(uC)ii(u0ci)2dxdy\nC(2)Itiseasytoseethat,fora\nxed\nC,theenergy\nfrom(2)isminimizedinthevariables\ncibysetting\ncimean(u0)in\niTheoreticalresultsforexis-\ntenceandregularityofminimizersof(2)canbefound\n\nforexampleinMumfordandShah(1989),Massari\n\nandTamanini(1993),Tamanini(1996),Tamaniniand\n\nCongedo(1996),andLeonardiandTamanini(1998).\nItisnoteasytominimizeinpracticethefunctionals\n(1)and(2),becauseoftheunknownset\nCoflowerdi-\nmension,andalsobecausetheproblemsarenotconvex.\n\nAftergivingthenecessarybackgroundonthelevelset\n\nmethod,wewillreviewsomealternativesolutionsto\n\nthisproblem,andotherrelatedrelevantmodelsforim-\n\nagesegmentation,beforepresentingtheproposedlevel\n\nsetformulations.\n1.2.TheLevelSetMethodandVariational\nLevelSets\nOsherandSethian(1988)proposedaneffectiveim-\nplicitrepresentationforevolvingcurvesandsurfaces,\n\nwhichhasfoundmanyapplications,becauseitallows\n\nforautomaticchangeoftopology,suchasmergingand\n\nbreaking,andthecalculationsaremadeona\nxedrect-\nangulargrid.\nAgivencurve\nC(theboundaryofanopenset\n,i.e.C)isrepresentedimplicitly,asthezerolevel\nsetofascalarLipschitzcontinuousfunction\n:(calledlevelsetfunction),suchthat(seeFig.1):\n(xy)0in\n\n(xy)0in\n(xy)0on\n\nAtypicalexampleoflevelsetfunctionisgivenby\nthesigneddistancefunctiontothecurve.Usingthis\n\nrepresentation,geometricalquantities,propertiesand\n\nmotionscanbeexpressed.Indeed,usingtheHeaviside\n\nfunctionH(z),equalwith1if\nz0andwith0if\nz0,'b'ImageSegmentationUsingtheMumfordandShahModel273\nFigure1\n.Acurve,givenbythezerolevelsetofthefunction\n,istheboundarybetweentheregions:\n(xy):(xy)0and(xy):(xy)0.thelengthof\nCandtheareaof\ncanbeexpressed\nrespectivelybyEvansandGariepy(1992):\nCH()H()dxdy\n(3)(wementionthatthe\nrstintegralisinthesenseof\nmeasures).Consideringany\nC1()approximationandre-\ngularizationHoftheHeavisidefunctionas\n0,anddenotingby\nH(anapproximationto\ntheone-dimensionalDiracdeltafunction\n0),we\ncanapproximatethelengthfunctionalby\nL()H()dxdy\n()dxdy\n,andthearea\nfunctionalby\nA()H()dxdy\n.ThenwecanformallywritetheassociatedEuler-\nLagrangeequations,obtainedbyminimizingtheabove\n\nfunctionalswithrespectto\n,andparameterizingthe\ndescentdirectionsbyanarti\ncialtime\nt,respectively\n(withassociatedinitialconditions):\nt()div\nort()Astandardrescalingcanbemade,asinZhaoetal.\n(1996),byreplacing\n()by\n,givingthefollow-\ningequations,alreadyintroducedinOsherandSethian\n\n(1988)inthecontextofthelevelsettheory:\nt\ndiv\nort\n(4)(motionbymeancurvatureminimizingthelength,and\nmotionwithconstantspeedminimizingthearea).Here,\nrepresentstheunitnormaltoalevelcurveof\nateverypoint,anddiv(\n)representsthecurvatureof\nthelevelcurve.\nFormorerecentandgeneralexpositionsonthelevel\nsetmethodandapplications,wereferthereaderto\n\nSethian(1999),OsherandFedkiw(2001,toappear).\n\nTheoreticalresultsofexistence,uniqueness,andreg-\n\nularityofthefrontfortheequationsfrom(4),inthe\n\nsenseofviscositysolutions,canbefoundinmanypa-\n\npers,forinstanceinBarles(1994)forHamilton-Jacobi\n\nequations,andinEvansandSpruck(1991),Chenetal.\n\n(1991),andCrandalletal.(1992),ormorerecentlyin\n\nBarlesandSouganidis(1998),forgeneralizedmean\n\ncurvature\nowequationsandevolutionoffronts.\n1.3.RelatedRelevantWorkforImageSegmentation\nWebrie\nymentionheresomeofthemostrelatedrele-\nvantworks,andwediscusstheirconnectionsordiffer-\n\nenceswithourapproach.\n1.3.1.TheWeakFormulationoftheMumfordand\nShahProblemandApproximations.\nAweakfor-\nmulationof(1)hasbeenproposedinDeGiorgiand\n\nAmbrosio(1988),andstudiedinDalMasoetal.(1992),\n\nwhereCisreplacedbytheset\nJuofjumpsof\nu,inorder\ntoprovetheexistenceofminimizers(itisknownthat\n\naglobalminimizerof(1),oroftheweakformulation,\n\nisnotuniqueingeneral).InMorelandSolimini(1988,\n\n1989),theauthorsproposedaconstructiveexistence\n\nresultinthepiecewise-constantcase,andinKoep\neretal.(1994),apracticalmulti-scalealgorithmbasedon\n\nregionsgrowingandmergingisproposedforthiscase.\n\nForageneralexpositionofthesegmentationproblem\n\nbyvariationalmethods,bothintheoryandpractice,\n\nwereferthereadertoMorelandSolimini(1994).We\n\nalsorefertoAmbrosio(1989)fortheoreticalresultson\n\nfunctionalsde\nnedontheappropriatespaceforimage\nsegmentation:the\nSBV()spaceofspecialfunctions\nofboundedvariation.\nTwoellipticapproximationsby\n-convergenceto\ntheweakformulationoftheMumford-Shahfunc-\n\ntionalhavebeenproposedinAmbrosioandTortorelli\n\n(1990,1992).Theyapproximatedaminimizer(\nuJu)ofFMS(uJu),bytwosmoothfunctions(\nu),such\nthat,as\n0,uuand1inthe\nL2()-topology,and\nisdifferentfrom1onlyinasmall\nneighborhoodof\nJu,whichshrinksas\n0.Theel-\nlipticapproximationsleadtoacoupledsystemoftwo\n\nequationsintheunknowns\nuand,towhichstandard\nPDEnumericalmethodscanbeapplied.\nRelatedapproximationsandnumericalresultscanbe\nfoundinMarch(1992),Chambolle(1992,1995,1999),\n'b'274VeseandChan\nBourdinandChambolle(2000),andBourdin(1999).\nAlso,inChambolleandDalMaso(1999),theauthors\n\nprovideanapproximationby\nconvergence\nbasedonthe\nniteelementmethod,totheweakformulation.\nNotethat,mostofthemethodssolvingtheweak\nformulation,donotexplicitlycomputethepartitionof\n\ntheimageandthesetofcurves\nC.Ingeneral(seefor\ninstanceAmbrosioandTortorelli(1990,1992)),only\n\nanapproximationto\nCisobtained,byasequenceof\nregionsenclosing\nC,butconverginginthelimittothe\nemptyset.\n1.3.2.ActiveContoursWithoutEdges.\nWerecall\nnowtheauthors\nsactivecontourmodelwithoutedges\nfromChanandVese(1999,2001),whichisapartic-\n\nularcaseandthemotivationoftheproposedmodels\n\nfromthepresentpaper.Giventhecurve\nC,with\nanopensubset,andtwounknownconstants\nc1andc2,denoting\n1,2,wehavepro-\nposedtominimizethefollowingenergywithrespect\n\ntoc1c2andC:F2(c1c2C)1(u0(xy)c1)2dxdy\n2(u0(xy)c2)2dxdy\nC(5)orinthelevelsetformulation,with\nC(xy)(xy)0:F2(c1c2)(u0(xy)c1)2H()dxdy\n(u0(xy)c2)2(1H())dxdy\nH()ConsideringHandany\nC1approximationsand\nregularizationsoftheHeavisidefunction\nHandDelta\nfunction0,as\n0andwith\nH,andminimiz-\ningtheenergy,weobtain:\n(0xy)0(xy):c1()u0(xy)H((txy))dxdy\nH((txy))dxdy\nc2()u0(xy)(1H((txy)))dxdy\n(1H((txy)))dxdy\nt()div\n(u0c1)2(u0c2)2Thismodelperformsactivecontours,lookingfora\n2-phasesegmentationoftheimage,givenby\nu(xy)c1H((xy))c2(1H((xy))).Themainadvan-\ntages,bycomparisonwithotheractivecontourmodels,\n\nare:itautomaticallydetectsinteriorcontours,theini-\n\ntialcurvecanbeplacedanywhereintheimage,andit\n\ndetectsbothcontourswith,orwithoutgradient(called\n\ncognitivecontours,followingKanizsa(1997)).Natural\n\ngeneralizationsarepresentedinthispaper,inSections\n\n2and3,forimagesegmentation,wheremorethantwo\n\nsegmentsandnon-constantregionscanberepresented,\n\nusinganewmulti-phaselevelsetapproach.\n1.3.3.InwardandOutwardCurveEvolutionUsing\nLevelSetMethod.\nAsimilarmodelwithChanand\nVese(1999,2001)wasproposedinAmadieuetal.\n\n(1999).Again,thismodelislimitedtoobjectdetec-\n\ntionandtwo-phasesegmentation,anditcannotseg-\n\nmentimageswithmorethantwosegmentsandwith\n\ntriplejunctions,forinstance.Wewillnotgiveherethe\n\ndetailsofthemodelfromAmadieuetal.(1999),being\n\nsimilarwiththatonefromChanandVese(1999,2001).\nTheprevioustwomodelsalreadydiscussedabove,\nChanandVese(1999,2001)andAmadieuetal.(1999),\n\ncannotdetectmorethantwosegmentsandtriplejunc-\n\ntions.Whenworkingwithlevelsetstorepresenttriple\n\njunctionsandmorethantwosegments,thegeneralidea\n\nistousemorethenonelevelsetfunction.Relatedrel-\n\nevantworkispresentednext,andthisistheideaused\n\nintheproposedapproach,butinadifferentway.\n1.3.4.AVariationalLevelSetApproachtoMulti-\nphaseMotion.\nTheworkfromZhaoetal.(1996)\nisdevotedtomotionofjunctionsandboundariesof\n\nmultiplephases,inavariationallevelsetapproach.\n\nEachphase\niisrepresentedviaalevelsetfunction\ni,suchthat\ni(xy):i(xy)0.Theto-\ntallengthofboundariesbetweenphasesiscomputed\n\nas12iH(i).Inordertokeepthephasesdis-\njoint(nooverlap)andtheirunionthedomain\n(novacuum),theauthorsinZhaoetal.(1996)haveadded\n\nanadditionaltermtotheenergywhichisminimized,\n\nintheform\n(iH(i)1)2dxdy\n.TheLagrange\nmultiplierisupdatedateachtimestep,tokeepthe\nconstraintiH(i)1atallpointssatis\ned.Mo-\ntionsoftriplejunctionsarethenobtained.\n'b'ImageSegmentationUsingtheMumfordandShahModel275\n1.3.5.ALevelSetModelforImageClassication.\nInSamsonetal.(1999,2000),theauthorshaveapplied\n\nthemulti-phaselevelsetrepresentationfromZhaoetal.\n\n(1996)tothereducedmodelofMumfordandShah,for\n\npiecewiseconstantimagesegmentation.Theproblem\n\niscalledclassi\ncation,becausethemeanintensities\nciofclassesareassumedtobeknowna-priori,andonly\nthesetofboundaries\nCisunknown.\n1.3.6.AStatisticalApproachtoSnakesforBimodal\nandTrimodalImagery.\nInYezzietal.(1999),the\nauthorsareagainusingtheideaofcombiningseveral\n\nlevelsetfunctions,torepresentmorethantwosegments\n\ninanimage.Theyareshowingnumericalresultswith\n\nbinaryows(relatedwiththemodelsChanandVese\n(1999,2001)andAmadieuetal.(1999)),butwithaddi-\n\ntionalchoicesforthesegmentationcriteria(insteadof\nuu02dxdy\n,theyproposeotherchoices,withdif-\nferentstatisticalmeanings).Theyalsoproposeinterest-\n\ningternary\nows,wheretwoevolvingcurvessegment\nanimageintothreeregions(twoforegroundregions\n\nandonebackgroundregion).\n1.3.7.CoupledGeodesicActiveRegionsforImage\nSegmentation:ALevelSetApproach.\nInParagios\nandDeriche(2000),theauthorsareusingagainmul-\n\ntiplelevelsetfunctionsforimagesegmentation,ina\n\nprobabilisticframework.AsinZhaoetal.(1996)and\n\nSamsonetal.(1999,2000),eachregionisassociated\n\nwithonelevelsetfunction.So,if\nNregionsneedto\nbesegmented,then\nNlevelsetfunctionsareneeded.\nResultsofcoupledcurveevolutionareobtained,toseg-\n\nmentimageswithupto\nvedifferentregions.\nAswehaveseen,thereareseveralchoicesforthe\nrepresentationofthedifferentphasesandtheirbound-\n\nariesbylevelsets.Asmentionedabove,a\nrstidea\nwasproposedinZhaoetal.(1996),andthenappliedin\n\nSamsonetal.(1999,2000):alevelsetfunctionisasso-\n\nciatedtoeachphaseoreachconnectedcomponent\ni(thisisalsousedinParagiosandDeriche(2000)).But\nthennaturalproblemsofvacuumandoverlapappear,\n\nandthesehavebeensolvedbyaddingadditionalcon-\n\nstraintsintotheabovementionedmodels.Aninterest-\n\ningidea,butdifferentthanours,toremovetheproblems\n\nofvacuumandoverlap,hasbeenusedinMerriman\n\netal.(1994),butitisnotclearhowtoincorporatethis\n\nformulationintoavariationalframework.Theiridea\n\nwasthat,ateachstep,aftercomputingthecharacter-\n\nisticfunctions\ni,associatedwitheachphase\ni,to\nre-denethesecharacteristicfunctionsby:\ni(xy)maxj(xy)1jnumberofphases\n,toavoid\ntheproblemsofvacuumandoverlap.Foranotherwork\n\nonpartitions,wealsoreferthereadertoEietal.(1999).\n\nFinally,wewouldalsoliketorefertoaprojection\n\nmethodformotionoftriplejunctionsbylevelsets\n\n(Smithetal.,2002).\nInthispaper,weproposeadifferentmulti-phase\nlevelsetrepresentation,andbyconstruction,thedis-\n\ntinctphasesaredisjoint(nooverlap)andtheirunionis\n\nthedomain\n(novacuum);also,weneedfewerlevel\nsetfunctionstorepresentthesamenumberofphases.\n\nFinally,wewillseethattriplejunctionsandothercom-\n\nplextopologiescanbedetectedandrepresentedbythe\n\nproposedmulti-phaselevelsetrepresentation.Based\n\nonthesecharacteristics,wethinkthattheproposedap-\n\nproachisnewanddifferentthantheexistingrelated\n\nmodels.Theapplicationsoftheproposedmulti-phase\n\nlevelsetformulationaredevotedinthispapertoimage\n\nsegmentation,viaMumfordandShah(1989).\nManyotherauthorshavestudiedtheminimization\noftheMumford-Shahfunctionalandrelatedproblems\n\nforsegmentation,bothintheoryandinpractice,and\n\nitisimpossibletomentionallofthem.However,we\n\nwouldliketomentionZhuetal.(1995),ZhuandYuille\n\n(1996),Shah(1996,1999),ShiandMalik(2000),and\n\nSharonetal.(2000).\nAninterestingapplicationofthelevelsetmethod\nandenergyminimizationtosegmentationofthree-\n\ndimensionalstructureshasbeenproposedinLorigo\n\netal.(1999),toextractcomplicatedcurve-likestruc-\n\ntures,suchasbloodvessels.\nForgeneralexpositionsonsegmentationofimages\nbyvariationalmethods,bothintheoryandalgorithms,\n\nwereferthereadertoMumfordetal.(1993)and\n\nMorelandSolimini(1994).Also,forrecentexposi-\n\ntionsofgeometricPDE\ns,variationalproblemsand\nimageprocessing(includingsnakes,activecontours,\n\ncurveevolutionproblems),wereferthereadertoSapiro\n\n(2001),AubertandKornprobst(2001),andGuichard\n\nandMorel(toappear).\nTosummarize\n,inthispaperwepropose:anextension\nandgeneralizationoftheactivecontourmodelwithout\n\nedgesfromChanandVese(1999,2001),tothegeneral\n\nMumfordandShahmodel,intwocases:thepiecewise\n\nconstantcase(2),andthepiecewisesmoothcase(1).\n\nTheproposedmodelscanidentifyindividualsegments\n\ninimageswithmultiplesegmentsandjunctions,as\n\ncomparedwiththeinitialmodel(ChanandVese,1999,\n\n2001),wherethedetectedobjectswerebelongingtothe\n\nsamesegment.Wealsoproposeanewrepresentation\n'b'276VeseandChan\nformultiphasemotionbylevelsets(requiringonly\nlog2nlevelsetfunctionsfor\nnsegmentsorphasesin\nthepiecewiseconstantcase),allowingfortriplejunc-\n\ntions,forexample,withoutvacuumoroverlapbetween\n\nphases.Inthepiecewisesmoothcase,basedonThe\n\nFour-ColorTheorem,weshowthatonlytwolevelset\n\nfunctionssuf\nceforimagesegmentation.Finally,the\nproposedmodelsinheritalltheadvantagesofourac-\n\ntivecontourmodelwithoutedges:detectionofedges\n\nwithorwithoutgradient,detectionofinteriorcon-\n\ntours,automaticchangeoftopology,robustnesswith\n\nrespecttonoise.Themodelscanperforminparallelac-\n\ntivecontours,segmentation,denoising,objectandedge\n\ndetection.2.DescriptionoftheModel\ninthePiecewise-ConstantCase\nInthissection,weshowhowwecangeneralizethe\n2-phasepiecewiseconstantactivecontourmodelwith-\n\noutedges(ChanandVese,1999,2001),topiecewise\n\nconstantsegmentationofimageswithmorethantwo\n\nsegmentsandjunctions,using(2).\nWenoteagainthat,usingonlyonelevelsetfunc-\ntion,wecanrepresentonlytwophasesorsegmentsin\n\ntheimage.Also,othergeometricalfeatures,suchas\n\ntriplejunctions,cannotberepresentedusingonlyone\n\nlevelsetfunction.Ourgoalistolookforanewmulti-\n\nphaselevelsetmodelwithwhichwecanrepresentmore\n\nthantwosegmentsorphases,triplejunctionsandother\n\ncomplextopologies,inanef\ncientway.Wewillneed\nonlylog\n2nlevelsetfunctionstorepresent\nnphasesorsegmentswithcomplextopologies,suchastriple\n\njunctions.Inaddition,ourformulationautomatically\n\nremovestheproblemsofvacuumandoverlap,because\n\nourpartitionisadisjointdecompositionandcovering\n\nofthedomain\nbyde\nnition.Thisisexplainednext.\nLetusconsider\nmlognlevelsetfunctions\ni:.Theunionofthezero-levelsets\nofiwillrepresenttheedgesinthesegmentedim-\nage.Wealsointroducethe\nvectorlevelsetfunction\n(1m),andthe\nvectorHeavisidefunction\nH()(H(1)H(m))whosecomponentsare\nonly1or0.Wecannowde\nnethesegmentsorphasesin\nthedomain\n,inthefollowingway:twopixels(\nx1y1)and(\nx2y2)in\nwillbelongtothesamephaseor\nclass,ifandonlyif\nH((x1y1))H((x2y2)).In\notherwords,theclassesorphasesaregivenbythelevel\n\nsetsofthefunction\nH(),i.e.oneclassisformedby\ntheset\n(xy)H((xy))constantvector\nH(())(onephaseorclasscontainsthosepixels(\nxy)of\nhavingthesamevalue\nH((xy))).Thereareupto\nn2mpossibilitiesforthevector-\nvaluesintheimageof\nH().Inthisway,wecande-\nneupto\nn2mphasesorclassesinthedomainof\ndenition.Theclassesde\nnedinthiswayforma\ndisjointdecompositionandcoveringof\n.Therefore,\neachpixel(\nxy)willbelongtoone,andonlyone\nclass,byde\nnition,andthereisnovacuumorover-\nlapamongthephases.Thisisanimportantadvantage,\n\ncomparingwiththeclassicalmultiphaserepresentation\n\nintroducedinZhaoetal.(1996),andusedinSamson\n\netal.(1999,2000).Thesetofcurves\nCisrepresented\nbytheunionofthezerolevelsetsofthefunctions\ni.Welabeltheclassesby\nI,with1\nI2mn.Now,letusintroduceaconstantvectorofaverages\n\nc(c1cn),where\ncImean(u0)intheclass\nI,andthecharacteristicfunction\nIforeachclass\nI.Then\nthereducedMumford-Shahenergy(2)canbewritten\n\nas:FMSn(c)1In2m(u0(xy)cI)2Idxdy\n121In2mI(6)Inordertosimplifythemodel,wewillreplacethe\nlengthtermby\niH(i)(i.e.thesumofthe\nlengthofthezero-levelsetsof\ni).Thus,insomecases,\nsomepartsofthecurveswillcountmorethanoncein\n\nthetotallengthterm,orinotherwords,someedgeswill\n\nhaveadifferentweightinthetotallengthterm.Wewill\n\nseethatwiththisslightmodi\ncationandsimpli\ncation,westillobtainverysatisfactoryresults(itmayhave\n\nonlyaverysmalleffectinmostofthecases,because\n\nthettingtermisdominant).\nTherefore,theenergythatwewillminimizeisgiven\nby:Fn(c)1In2m(u0cI)2Idxdy\n1imH(i)(7)Clearly,for\nn2(andtherefore\nm1),weobtain\nthe2-phaseenergy(5)consideredinouractivecontour\n'b'ImageSegmentationUsingtheMumfordandShahModel277\n\n\n\n\nFigure2\n.Left:2curves\n1020partitionthedomaininto4regions:\n1020,1020,1020,1020.Right:3curves\n102030partitionthedomaininto8regions:\n102030,102030,102030,102030,102030,102030,102030,102030.modelwithoutedges.Forthepurposeofillustration,let\nuswritetheaboveenergyfor\nn4phasesorclasses\n(andthereforeusing\nm2levelsetfunctions;see\nFig.2left):\nF4(c)(u0c11)2H(1)H(2)dxdy\n(u0c10)2H(1)(1H(2))dxdy\n(u0c01)2(1H(1))H(2)dxdy\n(u0c00)2(1H(1))(1H(2))dxdy\nH(1)H(2)(8)wherec(c11c10c01c00)isaconstantvector,and\n(12).Withthesenotations,wecanexpresstheimage-\nfunctionuas:uc11H(1)H(2)c10H(1)(1H(2))c01(1H(1))H(2)c00(1H(1))(1H(2))TheEuler-Lagrangeequationsobtainedbyminimiz-\ning(8)withrespectto\ncand,embeddedinady-\nnamicalscheme,are:given\n1(0xy)10(xy),2(0xy)20(xy),c11()mean(u0)in\n(xy):1(txy)02(txy)0c10()mean(u0)in\n(xy):1(txy)02(txy)0c01()mean(u0)in\n(xy):1(txy)02(txy)0c00()mean(u0)in\n(xy):1(txy)02(txy)01t(1)div\n11[((u0c11)2(u0c01)2)H(2)((u0c10)2(u0c00)2)(1H(2))]2t(2)div\n22[((u0c11)2(u0c10)2)H(1)((u0c01)2(u0c00)2)(1H(1))]Wenotethattheequationsin\n(12)aregov-\nernedbybothmeancurvatureandjumpofthedata\n\nenergytermsacrosstheboundary.\nWeshowinFig.2right,thepartitionofthedomain\nintoeightregions,usingthreelevelsetfunctions.\nItiseasytoextendtheproposedmodeltovector-\nvaluedfunctions,suchascolorimages,following\n\nforinstance(Chanetal.2000).Inthiscase,\nu0(u01u0N)istheinitialdata,with\nNchan-nels(\nN3forcolorRGBimages),andfor\neachchannel\ni1N,wehavetheconstants\n'b'278VeseandChan\ncI(cI1cIN).Inthiscase,themodelfor\nmultichannelsegmentationwillbe:\nFn(cI)1In2mNi1u0icIi2Idxdy\n1imH(i)Notethat,evenifweworkwithvector-valuedimages,\nthelevelsetfunctionsarethesameforallchannels(i.e.\n\nwedonotneedadditionallevelsetfunctionsforeach\n\nchannel).TheassociatedEuler-Lagrangeequationscan\n\neasilybededuced.\n3.DescriptionoftheModel\ninthePiecewise-SmoothCase\nInthissection,weproposeamulti-phaselevelsetfor-\nmulationandalgorithmforthegeneralproblemof\n\nMumfordandShah(1989)inimageprocessing(1),\n\ntocomputepiecewisesmoothoptimalapproximations\n\nofagivenimage.Weconsiderthecases:\n(1)Inonedimension:forsignalsegmentationandde-\nnoising,weshowthat,usingonlyonelevelset\n\nfunction,wecanrepresentanysignalwithany\n\nnumberofsegmentsinthepartition.\n(2)Intwodimensions:\n(i)wegeneralizethe2-phasepiecewise-constant\nmodelfromChanandVese(1999,2001),to\n\npiecewise-smoothoptimalapproximationsus-\n\ningonlyonelevelsetfunction:differentre-\n\ngionsofdistinctintensitiescanberepresented\n\nanddetectedwiththecorrectintensities.\n(ii)followingtheideaofthemulti-phaselevelset\npartitionfromtheprevioussection,weshow\n\nthat,inthepiecewise-smoothcase,usingonly\n\ntwolevelsetfunctions,producinguptofour\n\nphases,anygeneralcasecanbeconsidered\n\nandrepresentedbytheproposedformulation.\n\nOurmainideaisbasedonTheFour-Color\n\nTheorem.3.1.TheOne-DimensionalCase:SignalDenoising\nandSegmentation\nInmanyapplications,wedealwithasourcesignal\nuon(ab).Theproblemofreconstructing\nufromadis-\nturbedinput\nu0derivingfromadistortedtransmission,\ncanbemodeledas\nndingtheminimum\nminuC(ab)Cu2dxbauu02dx#(C)(9)whereCdenotesthesetofdiscontinuitypointsof\nu,and\n#(C)denotesthecardinalof\nC(thecountingmeasure).\nWelet\nCx(ab)(x)0,with\nbe-ingaonedimensionallevelsetfunction,andwein-\n\ntroducetwofunctions\nuandu,suchthat\nu(x)u(x)H((x))u(x)(1H((x)).Thesetwofunc-\ntionsreplacethetwounknownconstantsusedinChan\n\nandVese(1999,2001),andaresuchthat\nuC1(0),and\nuC1(0).Thentheenergy(9)can\nbewritteninthelevelsetformulationas:\nminuuba(u)2H()dxba(u)2(1H())dxbauu02H()dxbauu02(1H())dxbaH()Minimizingthisenergywithrespectto\nuu,and\n,weobtaintheassociatedEuler-Lagrangeequations,\nembeddedinadynamicalscheme:\nuu0(u)inx:(tx)0(u)0on\nx:(tx)0uu0(u)inx:(tx)0(u)0on\nx:(tx)0t()uu02uu02(u)2(u)2Notethat,inonedimensionforsignalsegmentation,\nonlyonelevelsetfunctionsuf\ncestorepresentapiece-\nwisesmoothfunction\nu,togetherwithitssetofjumps.\n3.2.TheTwo-DimensionalCase:Two-PhaseModel\nWeconsiderthecorrespondingtwo-dimensionalcase,\nundertheassumptionthattheedges(denotedby\nC)in\n'b'ImageSegmentationUsingtheMumfordandShahModel279\ntheimagecanberepresentedbyonelevelsetfunction\n,i.e.\nC(xy)(xy)0.Themostgeneral\ncase,allowingforanytypeofedges,includingtriple\n\njunctions,willalsobeconsidered.\nAsinthe1-dimensionalcase,thelinkbetweenthe\nunknowns\nuandcanbeexpressedbyintroducingtwo\nfunctionsuandu,suchthat\nu(xy)u(xy)if\n(xy)0u(xy)if\n(xy)0Weassumethat\nuanduareC1functionson\n0andon\n0respectively(andthereforewithcontinu-\nousderivativesuptoallboundarypoints,i.e.uptothe\n\nboundary0).Weillustrateourformulationin\nFig.3(left).\nThenweobtainthefollowingminimizationproblem\nfrom(1):\ninfuuF(uu)uu02H()dxdy\nuu02(1H())dxdy\nu2H())dxdy\nu2(1H())dxdy\nH()MinimizingF(uu)withrespectto\nu,u,and,weobtainthefollowingEuler-Lagrange\nu=u-u=u-u=u-u=u-u=u+u=u+u=u+u=u++u=u+-u=-+u=u++u=u+-u=u+-u=u+-Figure3\n.Left:exampleofpartitionoftheimage\nuinregionswithboundariesrepresentedviaasinglelevelsetfunction\n0,andwith\nsmoothvalue-functions\nu,uoneachsideofthecurve.Right:exampleofpartitionoftheimage\nuinregionswithboundariesrepresentedvia\ntwolevelsetfunctions\n1020,andwithsmoothvalue-functions\nu,u,uandu,onallsidesofthecurves.\nequations(embeddedinadynamicalschemefor\n):uu0uin(xy):(txy)0un0on\n(xy):(txy)0\n(10)uu0uin(xy):(txy)0un0on\n(xy):(txy)0\n(11)t()uu02u2uu02u2(12)where\nndenotesthepartialderivativeinthenor-\nmaldirection\nnatthecorrespondingboundary.Wealso\nassociatetheboundarycondition\nn0on\ntoEq.(12).\nTheequationsfor\nuanduwillhaveasmoothing\nanddenoisingeffectontheimage\nu0,butonlyinside\nhomogeneousregions,andnotacrossedges.\nWewouldliketomentionthatideasverysimilarwith\nthosefromtheabovecase,havebeenalsodeveloped\n\nbyTsaietal.(2001),independentlyandcontempo-\n\nraneously.Also,afterthisworkhadbeencompleted,\n\ntheauthorsnoticedthatL.Cohenandcollaborators\n\nhavepreviouslyusedalevelsetmethodforavariant\n\noftheMumfordandShahmodel,relatedwiththeone\n\ndescribedinthissubsection.Theauthorsusedthisto\n\ndetecttheboundaryofalake(seeCohenetal.,1993;\n\nCohen,1997).\n'b'280VeseandChan\n3.3.TheTwo-DimensionalCase:Four-Phase\nModelIntheprevioustwocases,wehaveshownhowwe\ncanminimizethegeneralMumford-Shahfunctional\n\nforsegmentationinthecasewherethesetofcontours\nCcanberepresentedbyasinglelevelsetfunction,\ni.e.C0andhasoppositesignsoneachside\nofC.Bythismethod,wecanalreadydetectseveralob-\njectsofdistinctgray-levels,butwehaveaconstrainton\n\nthetypeofedges.Therearecaseswheretheboundaries\n\nofregionsformingapartitionoftheimagecouldnot\n\nberepresentedinthisway(i.e.usingasinglelevelset\n\nfunction).Again,thenaturalideaistousemorethan\n\nonelevelsetfunction,asinSection2.\nWeshowthatinthegeneralcase,theproblemcan\nbesolvedusingonlytwolevelsetfunctions,andwe\n\ndonothavetoknowa-priorihowmanygray-levelsthe\n\nimagehas(orhowmanysegments).Theideaisbased\n\nonTheFour-ColorTheoremandisasfollows.\nBasedonthisobservation,wecan\ncolorallthe\nregionsinapartitionusingonlyfour\ncolors,suchthatanytwoadjacentregionshavedifferent\ncol-ors.Therefore,usingtwolevelsetfunctions,we\ncanidentifythefour\ncolorsbythefollowing(dis-\njoint)sets:\n1020,1020,1020,1020.Theboundaries\noftheregionsformingthepartitionwillbegivenby\n\n1020,andthiswillbethesetofcurves\nC.Again,inourparticularmultiphaseformulationof\ntheproblem,wedonothavetheproblemsof\nover-\nlappingorvacuum,\n(i.e.thephasesaredisjoint,and\ntheirunionistheentiredomain\n).Asinthepreviouscase,thelinkbetweenthefunc-\ntionuandthefourregionscanbemadebyintroduc-\ningfourfunctions\nuuuu,whicharein\nfacttherestrictionsof\nutoeachofthefourphases,as\nfollows:\nu(xy)\n\n\n\nu(xy)if1(xy)0and\n2(xy)0u(xy)if1(xy)0and\n2(xy)0u(xy)if1(xy)0and\n2(xy)0u(xy)if1(xy)0and\n2(xy)0ThesenotationsareillustratedinFig.3(right).\nAgain,usingtheHeavisidefunction,therelation\nbetweenu,thefourfunctions\nu,u,u,u,andthelevelsetfunctions\n1and2canbeexpressed\nby:uuH(1)H(2)uH(1)(1H(2))u(1H(1))H(2)u(1H(1))(1H(2))Usingthenotation\n(12),weintroducean\nenergyinlevelsetformulation,basedontheMumford-\n\nShahfunctional(1):\nF(u)uu02H(1)H(2)dxdy\nu2H(1)H(2)dxdy\nuu02H(1)(1H(2))dxdy\nu2H(1)(1H(2))dxdy\nuu02(1H(1))H(2)dxdy\nu2(1H(1))H(2)dxdy\nuu02(1H(1))(1H(2))dxdy\nu2(1H(1))(1H(2))dxdy\nH(1)H(2)AsinSection2,wenotethattheexpression\nH(1)H(2)isnotexactlythelength\ntermof\nC,itisjustanapproximationandsimpli\ncation.Inpractice,wehaveobtainedsatisfactoryresultsusing\n\ntheaboveformula,andtheassociatedEuler-Lagrange\n\nequationsaresimpli\ned.WeobtaintheassociatedEuler-Lagrangeequations\nasinthepreviouscases,embeddedinadynamic\n\nscheme,assuming(\ntxy)i(txy):minimizing\ntheenergywithrespecttothefunctions\nu,u,u,u,wehave,foreach\nxed\nt:uu0uin1020un0on\n10201020;uu0uin1020un0on\n10201020;'b'ImageSegmentationUsingtheMumfordandShahModel281\nuu0uin1020un0on\n10201020;uu0uin1020un0on\n10201020TheEuler-Lagrangeequationsevolving\n1and2,em-\nbeddedinadynamicscheme,formallyare:\n1t(1)11uu02H(2)u2H(2)uu02(1H(2))u2(1H(2))uu02H(2)u2H(2)uu02(1H(2))u2(1H(2))02t(2)22uu02H(1)u2H(1)uu02H(1)u2H(1)uu02(1H(1))u2(1H(1))uu02(1H(1))u2(1H(1))Wehavementionedintheintroductionexistence\nresultsfortheMumford-Shahminimizationproblem.\n\nTheglobalminimizerisnotuniqueingeneral.Wecan\n\nalsoshow,bystandardtechniquesofthecalculusof\n\nvariationsonthespaces\nBV()and\nSBV()(functions\nofboundedvariationandspecialfunctionsofbounded\n\nvariationrespectively),andacompactnessresultdue\n\ntoAmbrosio(1989),thattheproposedminimization\n\nproblemsfromthispaper,inthelevelsetformulation,\n\nhaveaminimizer.Finally,becausethereisnounique-\n\nnessamongminimizers,andbecausetheproblemsare\n\nnon-convex,thenumericalresultsmaydependonthe\n\ninitialchoiceofthecurves,andwemaycomputealocal\n\nminimumonly.Wethinkthat,usingtheseedinitializa-\n\ntion(seeSection4),thealgorithmshavethetendency\n\nofcomputingaglobalminimum.\n4.NumericalResults\nWexthespacesteps\nhxy1,thetime\nstept01,and\nh.4.1.NumericalResultsinthePiecewise-Constant\nCase(2D)\nWeshownownumericalresultsusingthemodelsfrom\nSection2,andinparticularusingthefour-phase(with\n\ntwolevelsetfunctions)andtheeight-phase(withthree\n\nlevelsetfunctions)models.Theonlyvaryingparameter\n\nis,thecoef\ncientofthelengthterm.Wegivethe\ncputimeinsecondsforourcalculations,performed\n\nona140MHzSunUltra1with256MBofRAM.In\n\nournumericalalgorithm,we\nrstinitializethelevelset\nfunctionsby\n0i,thenwecomputetheaverages\ncI,and\nwesolveonestepofthePDE\nsin\ni.Thenweiterate\ntheselasttwosteps.\nWeshowinparticularthattriplejunctionscanbe\nrepresentedanddetectedusingonlytwolevelsetfunc-\n\ntions,thatinteriorcontoursareautomaticallydetected\n\nandalsothatthemodelisrobustinthepresenceof\n\nnoiseandcomplextopologies.\nWebeginwithanoisysyntheticimagewithfourre-\ngions(Figs.4,5and6),andweconsiderseveraldiffer-\n\nentinitialconditions.Fortheinitialconditions(a),(b),\n\n(c)weusethefour-phasepiecewiseconstantmodel,\n\nwhilefor(d)weusetheeight-phasepiecewiseconstant\n\nmodel.TheenergydecreaseisshowninFig.4bottom\n\nfortheinitialconditions(a)\n(d).Theimagecontains\nthreeobjectsofdistinctintensities,allcorrectlyde-\n\ntectedandsegmentedforinitialconditions(a),(c),(d).\n\nThisisanimprovementoftheauthorsprevious2-phase\n\nactivecontourmodel(ChanandVese,1999,2001),\n\nwithwhichallthreeobjectswouldhavethesamein-\n\ntensityinthesegmentedimage,belongingtothesame\n\nsegmentorphase.\nBecausetheenergywhichisminimizedisnotcon-\nvex,andalsothatthereisnouniquenessforthemin-\n\nimizers,thealgorithmmaynotconvergetoaglobal\n\nminimizerforagiveninitialcondition.Itisthennatu-\n\nraltoconsiderdifferentinitialconditionsforthesame\n\nimagewiththesameparameters,andtocomparethe\n\nsteady-statesolutionsfromournumericalalgorithm.\n\nFor(c),weseedwithsmallinitialcurves.Onlyus-\n\ningtheinitialconditions(a),(c),(d)dowecompute\n\naglobalminimizerforthisimage.For(b),thealgo-\n\nrithmistrappedinalocalminimum.Ingeneral,for\n\nrealimageswithmorecomplicatedfeatures,wethink\n\nthatinitialconditionsofthetypes(c),(d)shouldbe\n\nused,whichhavethetendencytoconvergetoaglobal\n\nminimizer.Thistypeofinitialconditionisalsorelated\n\ntotheregiongrowingalgorithm(Koep\neretal.,1994).\nWealsonotethatusingtheinitialcondition(c),the\n'b'282VeseandChan\nFigure4\n.Fourdifferentinitialconditionsandtheenergiesversusiterations.\nalgorithmismuchfaster(seeFig.6left).InFig.6\nright,weshowanumericalresultonthesame\n\nimagewithfoursegments,butusingthe8-phase\n\nmodelwith3levelsetfunctions.Thecorrectseg-\n\nmentationisobtained,andfour\nnalsegmentsare\nempty.\nInFig.7weshowanoisysyntheticimagewitha\ntriplejunction.Usingonlyonelevelsetfunction,the\n\ntriplejunctioncannotberepresented.Mostofthemod-\n\nelsneedthreelevelsetfunctions,asinZhaoetal.(1996)\n\nandSamsonetal.(1999,2000).Here,weneedonlytwo\n\nlevelsetfunctionstorepresentthetriplejunction.We\nshowtheirzerolevelsets,whichhavetooverlapona\nsegmentofthetriplejunction.\nWeshownextnumericalresultsontworealpictures\n(anMRIbrainimageandahouse),inFigs.8,9and10.\n\nWeuseheretwolevelsetfunctions,detectingfour\n\nphases.Wealsoshowthe\nnalfoursegmentsdetected\nbythealgorithm.Weseehowthemodelcanhandle\n\ncomplextopologies,andalsothatthefourphasesin\n\nFig.9identifyquitewellthegraymatter,thewhite\n\nmatter,etc.\nInFig.11weshowanexampleofacolorRGB\nimage(threechannels)withcontourswithoutgradient\n'b'ImageSegmentationUsingtheMumfordandShahModel283\nFigure5\n.Segmentationofanoisysyntheticimage,usingthe4-phasepiecewiseconstantmodel.Firstand3rdcolumns:theevolvingcontours\noverlayontheoriginalimage;2ndand4thcolumns:computedaveragesofthefoursegments\nc11c10c01c00.Left:(a)\n001652552,size100100,cpu\n30.00sec.Right:(b)\n001652552,size\n100100,steadystate(thealgorithmcomputesonlyalocalminimum\ninthiscase).\n(cognitivecontoursfollowingKanizsa(1997)).We\nalsoseethatthisresultisanimprovementoftheresult\n\nonthesamepicturefromChanetal.(2000),wherethe\n\nthreeobjectshadthesameintensityintheend.Here,\n\nthecorrectintensitiesaredetected,foreachobject.\n\nAgain,thisgeneralizedmodelcandetect\ncontourswithoutedges.\nInFig.12weshowhowthemodelworksonan-\nothercolorRGBimage,whereweusethreelevelset\n\nfunctions123,representinguptoeightphasesor\ncolors.Thealgorithmdetectssixsegmentsandjunc-\n\ntions.Intheclassicalapproaches,itwouldhavebeen\n\nnecessarilytoconsideratleastsixlevelsetfunctions\n\n(here,2ofthe\nnal8segmentsareempty).\n'b'284VeseandChan\nFigure6\n.Left:(c)\n001652552,size\n100100,cpu\n8.46sec(veryfast).Right:(d)three-levelsetsevolutionwithupto8phases\n(atsteadystatethecorrectsegmentationisobtained,withfoursegments,whiletheotherfoursegmentsareempty).\n001652552,size100100.Figure7\n.Resultsonasyntheticimage,withatriplejunction,usingthe4-phasepiecewiseconstantmodelwith2levelsetfunctions.Wealso\nshowthezerolevelsetsof\n1and2.0052552,size\n6464,cpu\n3.51sec.\n'b'ImageSegmentationUsingtheMumfordandShahModel285\nFigure8\n.SegmentationofanMRIbrainimage,usingtwolevelsetfunctionsandfourconstantphases.\n0012552,size\n163181,cpu12.86sec.\nFigure9\n.Thealgorithmdepictsquitewellthe\nnalfoursegmentsfromthepreviousresult(whitematter,graymatter,etc.).The\nnalaverages\narec1145,c10159,c019,c00103.'b'286VeseandChan\nFigure10\n.Segmentationofarealoutdoorpicture,usingtwolevelsetfunctionsandfourconstantphases.Inthebottomrow,weshowthe\nnalfoursegmentsobtained.The\nnalaveragesare:\nc11159,c10205,c0123,and\nc0097.0012552,size\n10389,cpu\n7.88sec.\n4.2.NumericalResultsinthePiecewise-Smooth\nCase(1D&2D)\nWebeginthispartbyanexperimentalresultforsig-\nnaldenoisingandsegmentation.WeshowinFig.13\n\nleftanoriginalsignalanditsnoisyversion,together\n\nwithtwopoints,where\n0attheinitialtime.\nInFig.13right,weshowthesegmentedsignal,and\n\nthedetectedsetofjumpsgivenby\n0atthe\nsteadystate,usingtheproposedlevelsetalgorithm\n\nindimension1,fromSection3.Notethatpiecewise-\n\nsmoothregionsareverywellreconstructedbythe\n\nmodel,andthatthejumpsarewelllocatedandwithout\n\nsmearing.WeshowinFigs.14and15twonumericalresults\nusingthe2-phasealgorithmfromSection3:the\nevolvingcurvesaresuperposedovertheinitialnoisy\nimageu0,andthedenoisedversions\nuofu0arealso\nshown.InFig.14,weseethatthemodelperforms\n\nasactivecontours,denoisingandedge-detection,and\n\nseveralobjectsofdistinctintensitiescanbecorrectly\n\nsegmentedwithonlyonelevelsetfunction.InFig.15,\n\nweapplythemodeltoarealpiecewise-smooth\n\nimage.Aswehavealreadymentioned,similarresults\n\nwiththosefromFigs.14and15havebeenobtained\n\nindependentlyandcontemporaneouslybyTsaietal.\n\n(2001).Finally,weshowinFig.16numericalresultson\narealnoisyimage,usingthefour-phasemodelfrom\n\nSection3.Attheinitialtime,thetwocurvesgivenby\n\n10and20areshownindifferentcolors\n(weuseagaintheseedinitialization).\n'b'ImageSegmentationUsingtheMumfordandShahModel287\nFigure11\n.Numericalresultsonasyntheticcolorpicture.Weshowinparticularthatcontoursnotde\nnedbygradientcanbedetected.These\narecalledcognitivecontours(Kanizsa,1997).\n042552,size\n48100,cpu\n42.17sec.\nFigure12\n.Colornoisypicturewithjunctions.Weusethreelevelsetfunctionsrepresentinguptoeightconstantregions.Heresixsegments\naredetected.Weshowthe\nnalzero-levelsetsof\n123.0022552,size\n100100,cpu\n65.45sec.\n'b'288VeseandChan\n10203040506070809010011001020304050Original SignalNoisy Signal   \nInitial phi=010203040506070809010011001020304050Reconstructed Signal\nNoisy Signal        \nFinal phi=0       \nFigure13\n.Left:originalandnoisysignal,togetherwiththesetofpointswhere\n0attheinitialtime,representedbysquaresonthe\nx-axis.Right:reconstructedsignal,noisysignal,andthesetofpointswhere\n0atthesteadystate(thejumps).\nFigure14\n.Resultsonanoisyimage,usingthe2-phaselevelsetalgorithmforthepiecewisesmoothMumford-Shahmodel.Thealgorithm\nperformsasactivecontours,denoisingandedgedetection.\nFigure15\n.Numericalresultusingthe2-phasepiecewise-smoothMumford-Shahlevelsetalgorithm,onapiecewise-smoothrealimage.\n003052552,10,size\n110112.'b'ImageSegmentationUsingtheMumfordandShahModel289\nFigure16\n.Firstrow:originalandnoisyimage.2nd\n5throws:curvesover\nu0,denoised\nuandthefourarti\ncialphasesforincreasingtimes,by\nthe4-phasepiecewise-smoothmodelfromSection3.\n00042552,5,size\n152100,withre-initializationtothedistancefunction.\n5.Conclusion\nInthispaper,wehaveintroducedanewmultiphase\nmodelforMumford-Shahimagesegmentation,bylevel\n\nsets.Theproposedmodelisacommonframeworkto\n\nperformactivecontours,denoising,segmentation,and\n\nedgedetection.Themultiphaseformulationisdiffer-\n\nentthantheclassicalapproaches,andhastheadvan-\n\ntagesthatthephasescannotproducevacuumorover-\n\nlap,byconstruction(thereisnoadditionalconstraint\n\ntopreventvacuumoroverlap),anditminimizesas\n\nmuchaspossiblethecomputationalcost,considerably\nreducingthenumberoflevelsetfunctions.Weshow\ninparticularthattriplejunctionscanberepresented\n\nanddetectedusingonlytwolevelsetfunctions.Inthe\n\npiecewise-constantcase,weonlyneedtoknowanup-\n\nperboundofthesegments,whileinthefour-phase\n\npiecewise-smoothcase,wedonotneedtoknowa-\n\npriorihowmanysegmentstheimagehas.Thesemodels\n\ncanbeappliedtootherproblems,suchastextureseg-\n\nmentationanddiscrimination.Finally,wevalidatedthe\n\nproposedmodelsbyvariousnumericalresultsinone\n\nandtwodimensions.\n'b'290VeseandChan\nAppendix:TheDescriptionoftheNumerical\nAlgorithmsLethxybethespacesteps,\ntbethe\ntimestep,\nh,(xiyj)(ihjh)bethediscrete\npoints,for1\nijM,and\nu0iju0(xiyj),nij(ntxiyj),with\nn0.Weset:\nH(x)1212arctanx(x)H2(x)12x2A.1.ThePiecewiseConstantCase\nForthepurposeofillustration,wegivethedetailsof\nthenumericalalgorithmforthefour-phasemodelfrom\n\nSection2,bysolvingtheequations:\nc11()u0H(1)H(2)dxdy\nH(1)H(2)dxdy\nc10()u0H(1)(1H(2))dxdy\nH(1)(1H(2))dxdy\nc01()u0(1H(1))H(2)dxdy\n(1H(1))H(2)dxdy\nc00()u0(1H(1))H(2)dxdy\n(1H(1))H(2)dxdy\n1t(1)div\n11[((u0c11)2(u0c01)2)H(2)((u0c10)2(u0c00)2)(1H(2))]2t(2)div\n22[((u0c11)2(u0c10)2)H(1)((u0c01)2(u0c00)2)(1H(1))]Setn0,01ijand02ijgiven(theinitialsetof\ncurves).Foreach\nn0untilsteadystate:\n1.computebytheaboveformulastheaverages\ncn11,cn10,cn01,cn00.2.compute\nn11ij,n12ijasfollows(usingasemi-\nimplicitnitedifferencesscheme):let\nC11n1i1jn1ijh2n1ij1n1ij12h2C21n1ijn1i1jh2n1i1j1n1i1j12h2C31n1i1jn1i1j2h2n1ij1n1ijh2C41n1i1j1n1i1j12h2n1ijn1ij1h2Letm1th2(1ij),C1m1(C1C2C3C4),n11ij1Cn1ijm1C1n1i1jC2n1i1jC3n1ij1C4n1ij1t(1ij)u0ijcn112Hn2iju0ijcn1021Hn2iju0ijcn012Hn2iju0ijcn0021Hn2ijSimilarly,let\nD11n2i1jn2ijh2n2ij1n2ij12h2D21n2ijn2i1jh2n2i1j1n2i1j12h2D31n2i1jn2i1j2h2n2ij1n2ijh2D41n2i1j1n2i1j12h2n2ijn2ij1h2'b'ImageSegmentationUsingtheMumfordandShahModel291\nLetm2th2(2ij),D1m2(D1D2D3D4),n12ij1Dn2ijm2D1n2i1jD2n2i1jD3n2ij1D4n2ij1t2iju0ijcn112Hn1iju0ijcn102Hn1iju0ijcn0121Hn1iju0ijcn0021Hn1ijA.2.ThePiecewiseSmoothCase\nWegiveherethedetailsofthenumericalalgorithmfor\nsolvingthefollowingequationsfromSection3,written\n\nintheform:\nuH()u0H()div(\nH()u)u(1H())u0(1H())div((1\nH())u)t()uu02u2uu02u2Setn0,0ijgiven(theinitialcurve).Foreach\nn0untilsteadystate:\n(1)compute\nunijandunij,(2)computea\nC1extensionof\nunijtonij0andaC1extensionof\nunijtonij0,(3)compute\nn1ij,asfollows:\ncHnijh22HnijHni1jHnij1un1ij1ch2Hnijuni1jHni1juni1jHnijunij1Hnij1unij1Hniju0ijd1Hnijh221Hnij1Hni1j1Hnij1un1ij1dh21Hnijuni1j1Hni1juni1j1Hnijunij11Hnij1unij11Hniju0ijC11ni1jnijh2nij1nij12h2C21nijni1jh2ni1j1ni1j12h2C31ni1jni1j2h2nij1nijh2C41ni1j1ni1j12h2nijnij1h2Letmth2(ij),C1m(C1C2C3C4).gradnijuni1juni1j2h2unij1unij12h2gradnijuni1juni1j2h2unij1unij12h2n1ij1CnijmC1ni1jC2ni1jC3nij1C4nij1t(ij)u0ijunij2u0ijunij2gradnijgradnijWeneedtheextensionfromstep2)above,tocom-\nputethejumps(\nuu0)2(uu0)2,u2\nu2alongthecurve.Forinstance,toextend\nutotheregion\n0,wesolve\nu0on\n0,withgiven\nprescribedvalueson\n0.Thiscanbedoneby\niteratingthescheme:\nuk1ij025(uki1jukij1uki1jukij1),where\nu0un(nisxedfor\nvarying\nk).Otherpossibilitiesfortheextensionstep\n'b'292VeseandChan\ncanbefoundinZhaoetal.(1996),Chenetal.(1997),\nFedkiwetal.(1999),Fedkiw(1999),Jensen(1993),\n\nandCasellesetal.(1997).\nAusualprocedure,whenworkingwithlevelsetfunc-\ntions,isreinitializationtothedistancefunction.We\n\nhaveusedthisprocedureonlyinthelastnumericalre-\n\nsultfromFig.16.Fordetails,werefertoSussmanetal.\n\n(1994).Acknowledgments\nTherstauthorthankstoP.BurchardandR.March\nfortheirusefulremarksandsuggestions,andalsoto\n\nG.P.Leonardi,forpointingouttousinterestingref-\n\nerencesonminimalpartitionproblems.Bothauthors\n\nthanktheunknownrefereesfromIJCVandVLSM,\n\nfortheirveryinterestingremarksandsuggestions,\n\nwhichhelpedenormouslytoimprovethepresenta-\n\ntionofthispaper,andalsotheorganizingcommit-\n\nteeofVLSM,theGuestEditorsO.FaugerasandN.\n\nParagios.Thisworkhasbeensupportedinpartby\n\ngrantsNSF/DMS-9973341,NSF/ITR-0113439,ONR\n\nN00014-96-1-0277,andNIHP20MH65166.\nReferences\nAmadieu,O.,Debreuve,E.,Barlaud,M.,andAubert,G.1999.In-\nwardandoutwardcurveevolutionusinglevelsetmethod.In\nPro-\nceedingsICIP\n,Japan,pp.188\n192.Ambrosio,L.1989.Acompactnesstheoremforaspecialclassof\nfunctionsofboundedvariation.\nBoll.Un.Mat.It\n.,3(B):857\n881.Ambrosio,L.andTortorelli,V.M.1990.Approximationoffunction-\nalsdependingonjumpsbyellipticfunctionalsvia\nconvergence.\nComm.PureAppl.Math\n.,43:999\n1036.Ambrosio,L.andTortorelli,V.M.1992.Ontheapproximationof\nfreediscontinuityproblems.\nBolletinoU.M.I\n.,7(6-B):105\n123.Aubert,G.andKornprobst,P.2001.\nMathematicalProblemsinIm-\nageProcessing.PartialDifferentialEquationsandtheCalculus\n\nofVariations\n.AppliedMathematicalSciences,vol.147,Springer:\nNewYork.\nBarles,G.1994.Solutionsdeviscosit\nedes\nequationsdeHamilton-\nJacobi.Mathematiques&Applications\n,vol.17,Springer-Verlag.\nBarles,G.andSouganidis,P.E.1998.Anewapproachtofrontprop-\nagationproblems:theoryandapplications.\nArch.RationalMech.\nAnalysis,141(3):237\n296.Bourdin,B.1999.Imagesegmentationwitha\nniteelementmethod.\nM2ANMath.Model.Numer.Anal\n.,33(2):229\n244.Bourdin,B.andChambolle,A.2000.Implementationofa\nnite-elementsapproximationoftheMumford-Shahfunctional.\nNumer.\nMath.,85(4):609\n646.Caselles,V.,Morel,J.M.,andSbert,C.1998.Anaxiomaticapproach\ntoimageinterpolation.\nIEEE-IP,7(3):376\n386.Chambolle,A.1992.Unth\neor`\nemede\n-convergencepourlaseg-\nmentationdessignaux.\nC.R.Acad.Sci.Paris\n,314(I):191\n196.Chambolle,A.1995.Imagesegmentationbyvariationalmethods:\nMumfordandShahfunctionalandthediscreteapproximations.\n\nSIAMJ.Appl.Math\n.,55(3):827\n863.Chambolle,A.1999.Finite-differencesdiscretizationsofthe\nMumford-Shahfunctional.\nM2ANMath.Model.Numer.Anal\n.,33(2):261288.Chambolle,A.andDalMaso,G.1999.Discreteapproximationofthe\nMumford-Shahfunctionalindimensiontwo.\nM2ANMath.Model.\nNumer.Anal\n.,33(4):651\n672.Chan,T.andVese,L.1999.Anactivecontourmodelwithoutedges.\nInScale-Space99,M.Nilsenetal.(Eds.),LNCS,vol.1682,\npp.141\n151.Chan,T.andVese,L.2001.Activecontourswithoutedges.\nIEEE-IP,10(2):266277.Chan,T.,Sandberg,B.Y.,andVese,L.2000.Activecontourswithout\nedgesforvector-valuedimages.\nJVCIR,11:130\n141.Chen,Y.G.,Giga,Y.,andGoto,S.1991.Uniquenessandexistenceof\nviscositysolutionsofgeneralizedmeancurvature\nowequations.\nJ.Diff.Geometry\n,33:749\n786.Chen,S.,Merriman,B.,Osher,S.,andSmereka,P.1997.Asimple\nlevelsetmethodforsolvingStefanproblems.\nJCP,135:8\n29.Cohen,L.D.1997.Avoidinglocalminimafordeformablecurves\ninimageanalysis.In\nCurvesandSurfaceswithApplicationsin\nCAGD\n,A.LeM\nehaute,C.Rabut,andL.L.Schumaker(Eds.),\npp.77\n84.Cohen,L.,Bardinet,E.,andAyache,N.1993.Surfacereconstruction\nusingactivecontourmodels.In\nProceedingsSPIE93Conference\nonGeometricMethodsinComputerVision\n,SanDiego,CA,July\n1993.Crandall,M.G.,Ishii,H.,andLions,P.-L.1992.User\nsguideto\nviscositysolutionsofsecondorderpartialdifferentialequations.\n\nAmer.Math.Soc.Bull\n.,27:1\n67.DalMaso,G.,Morel,J.M.,andSolimini,S.1992.Avariational\nmethodinimagesegmentation:existenceandapproximationre-\n\nsults.ActaMatematica\n,168:89\n151.DeGiorgi,E.andAmbrosio,L.1988.Newfunctionalsinthecalculus\nofvariations.\nAtti.Accad.Naz.LinceiRend.Cl.Sci.Fis.Mat.\nNatur.,82(2):199\n210.DeGiorgi,E.,Carriero,M.,andLeaci,A.1989.Existencetheorem\nforaminimumproblemwithfreediscontinuityset.\nArch.Rational\nMech.Anal\n.,108(3):195\n218.Ei,S.-I.,Ikota,R.,andMimura,M.1999.Segregatingpartitionprob-\nlemincompetition-diffusionsystems.\nInterfacesandFreeBound-\naries,1(1):57\n80.Evans,L.C.andGariepy,R.F.1992.\nMeasureTheoryandFineProp-\nertiesofFunctions\n.CRCPress:BocaRaton,FL.\nEvans,L.C.andSpruck,J.1991.Motionoflevelsetsbymeancur-\nvature.\nJ.Diff.Geometry\n,33:635\n681.Fedkiw,R.P.1999.Theghost\nuidmethodfordiscontinuitiesand\ninterfaces.In\nProceedingsofGodunovMethods:TheoryandAp-\nplications,Oxford,UK,October1999.\nFedkiw,R.P.,Aslam,T.,Merriman,B.,andOsher,S.1999.Anon-\noscillatoryeulerianapproachtointerfacesinmultimaterial\nows\n(theghost\nuidmethod).\nJCP,152:457\n492.Guichard,F.andMorel,J.-M.ImageAnalysisandP.D.E.\ns(to\nappear).Jensen,R.1993.UniquenessofLipschitzextensions:Minimizing\nthesupnormofthegradient.\nArch.Rat.Mech.Anal\n.,123:51\n74.Kanizsa,G.1997.Lagrammaireduvoir.Essaissurlaperception.\nDiderotEditeur,ArtsetSciences.\n'b'ImageSegmentationUsingtheMumfordandShahModel293\nKoep\ner,G.,Lopez,C.,andMorel,J.M.1994.Amultiscalealgo-\nrithmforimagesegmentationbyvariationalmethod.\nSIAMJ.of\nNumericalAnalysis\n,31(1):282\n299.Leonardi,G.P.andTamanini,I.1998.Onminimizingpartitionswith\ninnitelymanycomponents.\nAnn.Univ.Ferrara-Sez.VII-Sc.Mat\n.,XLIV:41-57.\nLorigo,L.M.,Faugeras,O.,Grimson,W.E.L.,Keriven,R.,and\nKikinis,R.1999.Co-dimension2geodesicactivecontoursfor\n\nMRAsegmentation.\nInformationProcessinginMedicalImaging,\nProceedings\n,LNCS,vol.1613,pp.126\n139.March,R.1992.VisualReconstructionwithdiscontinuitiesusing\nvariationalmethods.\nIVC,10:30\n38.Massari,U.andTamanini,I.1993.Onthe\nnitenessofopti-\nmalpartitions.\nAnn.Univ.Ferrara-Sez.VII-Sc.Mat\n.,XXXIX:\n167185.Merriman,B.,Bence,J.K.,andOsher,S.1994.Motionofmultiple\njunctions:Alevelsetapproach.\nJCP,112(2):334\n363.Morel,J.M.andSolimini,S.1988.Segmentationofimagesbyvari-\nationalmethods:Aconstructiveapproach.\nRevistaMatematica\nUniversidadComplutensedeMadrid\n,1:169\n182.Morel,J.M.andSolimini,S.1989.Segmentationd\nimagespar\nmethodevariationnelle:Unepreuveconstructived\nexistence.\nCRASSParisS\nerieI,Math\n.,308:465\n470.Morel,J.M.andSolimini,S.1994.\nVariationalMethodsinImage\nSegmentation\n.PNLDE,vol.14,Birkh\nauser:Basel.\nMumford,D.,Nitzberg,M.,andShiota,T.1993.\nFiltering,Segmen-\ntationandDepth\n.LNCS,vol.662,Springer-Verlag:Berlin.\nMumford,D.andShah,J.1989.Optimalapproximationbypiecewise\nsmoothfunctionsandassociatedvariationalproblems.\nComm.PureAppl.Math\n.42:577\n685.Osher,S.andFedkiw,R.P.2001.Levelsetmethods:Anoverview\nandsomerecentresults.\nJCP,169(2):463\n502.Osher,S.J.andFedkiw,R.2002.\nLevelSetMethodsandDynamicIm-\nplicitSurfaces\n.AppliedMathematicalScience,vol.153,Springer.\nOsher,S.andSethian,J.A.1988.Frontspropagatingwithcurvature-\ndependentspeed:AlgorithmsbasedonHamilton-Jacobiformula-\n\ntion.JCP,79:12\n49.Paragios,N.andDeriche,R.2000.CoupledGeodesicactiveregions\nforimagesegmentation:Alevelsetapproach.In\nProceedings\nECCV,Dublin,vol.II,pp.224\n240.Samson,C.,Blanc-F\neraud,L.,Aubert,G.,andZerubia,J.1999.\nAlevelsetmodelforimageclassi\ncation.In\nScale-Space99,M.Nilsenetal.(Eds.),LNCS,vol.1682,Springer-Verlag:Berlin,\n\npp.306\n317.Samson,C.,Blanc-F\neraud,L.,Aubert,G.,andZerubia,J.2000.A\nlevelsetmodelforimageclassi\ncation.IJCV,40(3):187\n197.Sapiro,G.2001.\nGeometricPartialDifferentialEquationsandImage\nAnalysis.CambridgeUniversityPress:Cambridge,UK.\nSethian,J.A.1999.\nFastMarchingMethodsandLevelSetMethods:\nEvolvingInterfacesinComputationalGeometry,FluidMechan-\n\nics,ComputerVisionandMaterialsSciences\n.CambridgeUniver-\nsityPress:Cambridge,UK.\nShah,J.1996.Acommonframeworkforcurveevolution,segmenta-\ntionandanisotropicdiffusion.In\nProceedingsCVPR\n,pp.136\n142.Shah,J.1999.RiemannianDrums,AnisotropicCurveEvolutionand\nSegmentation.In\nScale-Space99,M.Nilsenetal.(Eds.),LNCS,\nvol.1682,Springer-Verlag:Berlin,pp.129\n140.Sharon,E.,Brandt,A.,andBasri,R.2000.Fastmultiscaleimage\nsegmentation.In\nProceedingsCVPR\n,SouthCarolina,pp.70\n77.Shi,J.andMalik,J.2000.Normalizedcutsandimagesegmentation.\nIEEE-PAMI\n,22(8):888\n905.Smith,K.A.,Solis,F.J.,andChopp,D.2002.Aprojectionmethod\nformotionoftriplejunctionsbylevelsets.\nInterfacesandFree\nBoundaries,4(3):263\n276.Sussman,M.,Smereka,P.,andOsher,S.1994.Alevelsetapproach\nforcomputingsolutionstoincompressibletwo-phase\nows.\nJCP,119:146159.Tamanini,I.1996.Optimalapproximationbypiecewiseconstant\nfunctions.ProgressinNonlinearDifferentialEquationsandTheir\nApplications,Birkh\nauserVerlag,25:73\n85.Tamanini,I.andCongedo,G.1996.Optimalsegmentationofun-\nboundedfunctions.\nRend.Sem.Mat.Univ.Padova\n,95:153\n174.Tsai,A.,Yezzi,A.,andWillsky,A.S.2001.Curveevolutionimple-\nmentationoftheMumford-Shahfunctionalforimagesegmenta-\n\ntion,denoising,interpolation,andmagni\ncation.IEEE-IP,10(8):\n11691186.Yezzi,A.,Tsai,A.,andWillsky,A.1999.Astatisticalapproachto\nsnakesforbimodalandtrimodalimagery.In\nProceedingsICCV\n,pp.898\n903.Zhao,H.-K.,Chan,T.,Merriman,B.andOsher,S.1996.Avariational\nlevelsetapproachtomultiphasemotion.\nJCP127:179195.Zhu,S.C.,Lee,T.S.,andYuille,A.L.1995.Regioncompetition:\nUnifyingsnakes,regiongrowing,Energy/Bayes/MDLformulti-\n\nbandimagesegmentation.In\nProceedingsICCV\n,Cambridge,\npp.416\n423.Zhu,S.C.andYuille,A.1996.Regioncompetition:Unifyingsnakes,\nregiongrowing,andBayes/MDLformulti-bandimagesegmen-\n\ntation.IEEE-PAMI\n,18:884\n900.'