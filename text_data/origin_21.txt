b'Vehicle Reidentification and Travel Time Measurement onCongested FreewaysBenjamin CoifmanAssistant Professor,-Civil and Environmental Engineering and Geodetic Science\n-Electrical EngineeringOhio State University\n470 Hitchcock Hall\n2070 Neil Ave\nColumbus, OH 43210-1275Coifman.1@OSU.eduhttp://www-ceg.eng.ohio-state.edu/~coifman\n614 292-4282Michael CassidyAssociate Professor, Civil and Environmental Engineering\nUniversity of California\nBerkeley, CA 94720Accepted for publication in       Transportation Research-A/B   'b"Coifman, B. and Cassidy, M.11/2/01\n1ABSTRACTThe paper presents an algorithm for matching individual vehicles measured at a freeway detectorwith the vehicles' corresponding measurements taken earlier at another detector located upstream.\nAlthough this algorithm is potentially compatible with many vehicle detector technologies, the\npaper illustrates the method using existing dual-loop-detectors to measure vehicle lengths.  This\ndetector technology has seen widespread deployment for velocity measurement.  Since the\ndetectors were not developed to measure vehicle length, these measurements can include significant\nerrors.  To overcome this problem, the algorithm exploits drivers' tendencies to retain their\npositions within dense platoons.  The otherwise complicated task of vehicle reidentification is\ncarried-out by matching these platoons rather than individual vehicles.  Of course once a vehicle\nhas been matched across neighboring detector stations, the difference in its arrival time at each\nstation defines the vehicle's travel time on the intervening segment.Findings from an application of the algorithm over a 1/3 mile long segment are presented hereinand they indicate that a sufficient number of vehicles can be matched for the purpose of traffic\nsurveillance.  As such, the algorithm extracts travel time data without requiring the deployment of\nnew detector technologies.  In addition to the immediate impacts on traffic monitoring, the work\nprovides a means to quantify the potential benefits of emerging detector technologies that promise\nto extract more detailed information from individual vehicles.Keywords: traffic surveillance, loop detectors, travel time measurement, vehicle reidentification"b'Coifman, B. and Cassidy, M.11/2/01\n2INTRODUCTIONThis paper presents a vehicle reidentification algorithm for consecutive detector stations on afreeway, whereby a vehicle measurement made at a downstream detector station is matched with\nthe vehicle\'s corresponding measurement at an upstream station.  The work should be applicable to\nany detector technology capable of extracting a reproducible vehicle measurement, or vehiclesignature.  For the present research, the algorithm uses the effective vehicle lengths measured byconventional dual-loop-detectors.1  As such, the algorithm can be deployed without requiring newdetector hardware.  The length measurements, however, may only be accurate to two feet (or\nworse) due to the resolution limitations of dual-loop-detector data.For a given vehicle measurement at the downstream detector station, the algorithm uses arrivaltimes and number of arrivals at the detector to identify the set of all upstream observations in the\nsame lane that could have come from the same vehicle.  The measurement resolution makes it\ndifficult to identify which one of these measurements, if any of them, correspond to the\ndownstream vehicle.  To address this limitation, the algorithm takes the difference between the\ndownstream measurement and each of the upstream measurements.  It then identifies all pairs\nwhose difference exceeds the measurement accuracy.  These measurements presumably could not\nhave come from the same vehicle, while all remaining pair-wise comparisons are treated as\npossible matches.  Of course, with this simple test, the downstream vehicle will likely have many\npossible matches within the set.  We term the collection of incorrect matches as false positives.\nToward eliminating the false positives, the algorithm uses a remarkably simple yet very effective\ntechnique: it matches platooned vehicles whenever these pass both the upstream and downstream\ndetector stations without altering their relative sequence.  The sequence of a platoon\'s vehicle\nlengths provides more information than do the individual measurements, as is demonstrated herein.For reasons that will be discussed in this paper, the accuracy of a dual-loop-detector\'s vehiclelength measurement improves as vehicle velocity decreases.  Consequently, for the existing\ndetectors, the algorithm is limited to matching vehicles during congested traffic conditions, i.e.,\nwhen the local velocity measured by the detectors is less than 45 mph at one or both of the stations.\nThis limitation is not problematic, since freely flowing traffic is characterized by relatively constant\nvelocities and thus, travel times can be estimated from the local conditions at the detector stations.\nIf warranted, improved measurement accuracy could likely be achieved by deploying the algorithm                                                1 The effective vehicle length is the length as "seen" by the detectors; i.e., the sum of the physical vehicle length and\nthe length of the detection zone. Also note that dual-loop-detectors are quite common, often placed at half mile\nspacings or less on urban freeways.'b'Coifman, B. and Cassidy, M.11/2/01\n3with more sophisticated vehicle detector technologies, such as machine vision.  Alternatively,Coifman (2001b) presents an algorithm for measuring travel time from dual-loop-detectors during\nfree flow traffic conditions.The travel time data recorded from the algorithm have a number of potential applications.  Forexample, these data might improve traffic management tasks such as automatic incident detection,\nadaptive freeway ramp control, and traveler information systems.  The data might also be used for\nrouting vehicles over a network so as to reduce traveler delay, for calibrating traffic planning and\nsimulation models, and for quantifying the potential benefits of emerging detector technologies that\nextract more detailed information from individual vehicles.  Further discussion on potential\napplications can be found in Coifman (1998a).The following section provides a brief review of previous work related to automatic vehiclereidentification and in emerging technologies that might enhance this task.  Next, the vehicle\nreidentification algorithm is presented in detail, using field-measured freeway data to illustrate the\nvarious steps.  The paper closes with a brief discussion regarding possible future work in this area.PREVIOUS RESEARCHAlthough at present, the proposed algorithm is used to match length measurements made byconventional dual-loop-detectors, the algorithm could be applied to vehicle signatures from other\ndetector technologies.  By providing improved measurement accuracy, these technologies might be\nused with our algorithm for improving the reidentification process.  Examples of such signatures\nand their associated technologies include (1) inductive vehicle signatures collected from loop\n\nwayside cameras (e.g., MacCarley, 1998); (3) vehicle dimensions from laser based detectors (e.g.,\nLarson et al., 1998).  Notably, some of the above technologies have been designed to measure\nvehicle dimensions, such as length, with an error less than one inch even when the vehicles are\ntraveling at free flow speeds.These new detector technologies have been expressly developed for vehicle reidentificationapplications.  Likewise, several algorithms have been proposed for measuring travel time directly\n\nImmes, 1993, Huang and Russell, 1997).  The implementation of the aforementioned algorithms,\nhowever, requires the deployment of new detector hardware, even before the benefits of measuring\ntravel time can be quantified.  Consequently, most installations of these systems have been limited\nto small test sites.'b'Coifman, B. and Cassidy, M.11/2/01\n4Of course, automatic vehicle identification (AVI) systems that rely on machine readableidentification tags have also been deployed (e.g., Levine and McCasland, 1994, Balke et al., 1995,\nCui and Huang, 1997).  These systems provide reliable travel time measurements.  However, the\nsystems could potentially compromise personal privacy.  Furthermore, the AVI systems do not\nmonitor local conditions at the detector stations (such as flow, velocity and occupancy), this\nomission can impact traffic surveillance and control.Other surveillance systems have been proposed for estimating vehicle travel time from aggregatetraffic parameters like occupancy (e.g., Dailey, 1993, Petty et al., 1997).  Although promising for\nfree flow and lightly congested conditions, these systems currently perform poorly under heavy\ncongestion.  Another approach for estimating travel time is to match vehicles simply based on the\ncumulative arrivals at successive detector stations, i.e., the n-th vehicle at one station is matched to\nthe n-th vehicle at the next station (e.g., Westerman and Immers, 1992, Westerman et al., 1996).\nTo counter detector drift between stations, these systems use aggregate measurements to recalibrate\nduring free flow conditions.  Unfortunately, congestion can last several hours, leading to\nsignificant measurement drift between recalibrations.  Finally, the vehicle reidentification algorithm\ndiscussed in this paper is an extension of simpler algorithms previously presented in Coifman\n(1998b).THE PROPOSED ALGORITHMThe vehicle reidentification algorithm is described here via its application; i.e., it is applied to trafficdata measured at two neighboring dual-loop-detector stations in a single travel lane along\neastbound Interstate 80 in Berkeley, California.  The site is shown in Figure 1.  Video data were\ncollected at each station and all vehicles that passed during the study period were visually matched\nbetween the two locations.  Thus, the travel times extracted by the algorithm could be verified.\nOver 1,300 vehicles passed both stations in the subject lane during the videotaping, while another\n200 vehicles entered or exited the subject lane between the stations.We begin this section by briefly reviewing how a dual-loop-detector can be used to measurevehicle lengths.  To this end, Figure 2A shows a time-space diagram depicting a vehicle passing\nover a dual-loop-detector.  The controller normally records four transitions, i.e., the turn-on and\nturn-off times at each of the loops, as shown in Figure 2B.  Occasionally a vehicle will change\nlanes over the dual-loop-detector or one of the loops malfunctions.  In the event of such a detection\nerror, only one loop will record the vehicle.  These events are identified and discarded following\nthe method presented in Coifman (1998a).  To the algorithm, any discarded vehicle will simply\nappear to be a vehicle that entered or exited the lane between the stations.  The algorithm addresses'b'Coifman, B. and Cassidy, M.11/2/01\n5these phantom lane change maneuvers in the same fashion that it addresses actual lane changemaneuvers, as presented in a subsequent section.After accounting for detection errors, the following parameters are calculated for each vehicle: dualloop traversal time via the rising edges, TTr, dual loop traversal time via the falling edges, TTf,total on-time at the first loop, OT1, and total on-time at the second loop, OT2, as shown in Figure2A.  Obviously, the loop separation (20 ft in this case) divided by the traversal time yields thevehicle velocity.  It is clear from Figure 2A that two measurements are available for the effective\nvehicle length,length measurement #1:LOTTTr1120ft(1)\nlength measurement #2:LOTTTf2220ftand the algorithm uses the average of the two.  Although the figure shows an example of a vehicleshorter than 20 ft, off1 < on2, Equation 1 also holds for longer vehicles, off1 > on2.Notably, the controller samples the loops at 60 Hz, so at best, the traversal times and on-times inEquation 1 are accurate to 1/60 sec.  To capture this resolution constraint, the measurement\nuncertainty is defined as the range spanned by L1 and L2 after including 1/60 sec in OT1, OT2,TTr and TTf.  By inspection of Equation 1 and Figure 2A, this measurement uncertainty range isinversely proportional both to velocity and to the true vehicle length.  Misdetections will impact the\ncalculation, e.g., if one of the on-times was too short due to a detection error.  Depending on the\nseverity, such errors might not impact the algorithm, but if they do, they will simply appear to be\nphantom lane change maneuvers.  To ensure the accuracy of OT1, OT2, TTr and TTf, any hardwareproblems at each station, such as cross talk between detectors, were identified using Coifman\n(1999) and corrected.Vehicle Arrival Numbers and Possible MatchesFirst, in the subject lane, vehicles are assigned consecutive arrival numbers as they pass eachdetector station and these numbers are assigned independently at each station.  Next, a set offeasible upstream measurements is identified for each vehicle measured downstream.  Assumingthat the downstream vehicle did not change lanes between detector stations, the set should be\nchosen to ensure the true match for the vehicle falls within the set while not being so large as to\npreclude a computer from processing the data.  For this paper, the set was defined as the most'b"Coifman, B. and Cassidy, M.11/2/01\n6recent 100 measurements at the upstream detector prior to the downstream measurements.  The sizewas chosen somewhat arbitrarily but subsequently verified to be adequate.  In practice, a\nconservative set size could be estimated from the subject lane's jam density storage between the\ntwo detector stations.Because a given vehicle length is not unique and because of the aforementioned measurementerrors caused by the detector, it is not possible to match directly upstream and downstream\nmeasurements.  To illustrate this point, Figure 3A shows a sequence of upstream length\nmeasurements with dark rectangles.  The measurements are plotted in the order that the vehicles\nwere observed at the upstream station.  The vehicle lengths corresponding to each data point are\nshown by their positions along the ordinate, including the measurement uncertainty.  For simplicity\nall of the vehicles are shown with the same uncertainty, but in practice, the range depends on the\nmeasurements and it varies from one vehicle to the next.A single measurement made at the downstream station, along with its measurement uncertainty, issuperimposed as a long, lightly shaded rectangle on Figure 3A.  One observes a number of\nmeasurements from the upstream station that might correspond to the vehicle measured\ndownstream; i.e., a number of lengths measured among the former coincide with the latter.  These\npossible matches are indicated with open circles in Figure 3B.  The algorithm eliminates from\nfurther consideration the upstream measurements that do not coincide with the downstream one.Possible Matches and SequencesA sequence of measured vehicle lengths (e.g., from a platoon) rapidly becomes distinct and thesequences measured at an upstream detector station can often be reidentified at a downstream\nstation.  Thus, the algorithm searches for sequences of measured vehicle lengths in the subject lane\nthat exhibit strong correlation across the two detector stations.  Since lane changes and\nmeasurement errors disrupt the sequences, the algorithm is specifically designed to match vehicles\nbetween these disruptions, as described below.For each downstream measurement, the algorithm applies the resolution test illustrated in Figure 3over the set of feasible upstream measurements, as defined above.  The possible matches are storedin matrix format.  Figure 4, for example, shows the possible matches for 100 vehicles measured at\nthe downstream detector; these data were taken from the aforementioned sample of nearly 1,500\nvehicles with corresponding video ground truth.  The dots indicate possible matches and each row\nin Figure 4 represents the outcome from one resolution test.  Note that the columns are indexed by\nthe difference between the arrival numbers assigned to vehicles at the upstream and downstream"b'Coifman, B. and Cassidy, M.11/2/01\n7detector stations.  It is clear that numerous possible matches resulted from each resolution test sinceeach vehicle can only have, at most, one true match.The algorithm then proceeds through this matrix with the ultimate goal of selecting a set of finalmatches.  If the algorithm is successful, the final matches will correspond to the true and correct\nmatches for the downstream vehicles.  In selecting the final match from the often large collection of\npossible matches, the algorithm exploits the fact that consecutive vehicles will often maintain their\nrelative order within a platoon for long distances, (Windover, 1998).  As such, the true but\nunknown matches will often reveal themselves as relatively long sequences of possible matches\nthat appear in neighboring rows along the same column.  To this end, the algorithm identifies all\nsequences of two or more possible matches in the matrix, as exemplified in Figure 5.Empirical EvidenceWe briefly consider all 1,500 vehicles in the sample to provide empirical motivation for thepreceding steps.  Calculating the number of possible matches divided by the number of pair-wise\ncomparisons for each row, Figure 6A shows the cumulative distribution of the percentage of\npossible matches for all 1,500 vehicles.  From this figure, it is clear, for example, that the\nfrequency of false positives is less than 50 percent for seven out of 10 vehicles in this set.  Because\nthe algorithm looks for sequences, even the vehicles with a high frequency of false positives in\nFigure 6A are informative since the unlikely elements (i.e., the non-positive results) can break false\nsequences.Next, using the true matches from the concurrent video, the solid line in Figure 6B shows thedistribution of sequence lengths as measured by the algorithm for the true matches and the dashed\nline shows the distribution for all of the other possible matches, i.e., the false positives.  The true\nsequences are, on average, over seven vehicles long, while the false sequences are, on average,\nabout two vehicles long for this data set.  The few long sequences of false positives are typically\ndue to vehicles with common lengths and these sequences usually occur when there is a longer\nsequence of true matches.Lane Changes and DisruptionsAs previously noted, the algorithm is specifically designed to match vehicles between disruptionscaused by lane changes and missed vehicle detections.  After finding sequences of possible\nmatches, the algorithm then searches for commonplace disruptions between the sequences to\ncontinue matching in the presence of these disturbances.  Figures 7A-C show the specific\ndisturbances searched for.  Figure 7A illustrates the effects of a single vehicle exiting the lane'b"Coifman, B. and Cassidy, M.11/2/01\n8between the two stations or not being detected at the downstream station.  This vehicle would havebeen observed downstream between vehicles m-1 and m.  In Figure 7B, a single vehicle, m-1,\nenters the lane between the two stations or is not detected at the upstream station.  Finally, in\nFigure 7C, either one vehicle enters and another exits the lane between stations or the vehicle\nlength is measured incorrectly at one of the stations for the pair-wise comparison in the center of\nthe matrix.For each new sequence of possible matches, the algorithm checks to see if it can be linked to anearlier sequence (i.e., a sequence starting with a lower vehicle number) via one of these\ndisturbances.  The procedure is demonstrated using the sequence starting with element (m,n) in\nFigure 7D.  The algorithm checks to see if there are any earlier sequences passing through one of\nthe three shaded elements, where each element corresponds to one of the disturbances in Figures\n7A-C.  When a possible disturbance occurs, the algorithm joins the two sequences in a modifiedsequence.  A modified sequence contains at most two distinct sequences and the definition isnecessary because the subject sequence starting at (m,n) may be joined to a later sequence without\nregard for the possible disturbances considered here.  When the algorithm creates a modifiedsequence, it simultaneously subtracts one vehicle from the total number of possible matches in themodified sequence; as described shortly, this penalty influences how the algorithm selects the finalmatches.By following the above logic, situations will arise whereby a particular sequence might be joinedwith more than one earlier sequence.  In Figure 7E, for example, there are two possible\ndisturbances that may have preceded the first possible match in the sequence starting at (m,n).  In\nthis hypothetical instance, the algorithm joins the two adjacent sequences in the manner shown in\nFigure 7F, since this union yields a modified sequence with the largest number of possiblematches.  Note that this union does not include the last two possible matches from the earlier\nsequence.  The exact choice of when the disturbance occurred is based on convenience, since in\nthis case, it is impossible to determine from the matrix whether the disturbance occurred as shown\nor after either of the two excluded matches.At this juncture, a given possible match will be included in a sequence and it may be included inmany modified sequences.  The algorithm will select the longest modified sequence (or sequence)from this set and store the sequence's length in a new matrix with the indices corresponding to the\npair-wise comparison.  The algorithm uses the elements in this new matrix to eliminate many of the\npossible matches previously defined as false positives.  For each row, the algorithm retains the\nelement corresponding to the maximum value and discards all other possible matches in the row.\nThe longest sequence containing the given downstream vehicle is thus retained.  If more than one"b'Coifman, B. and Cassidy, M.11/2/01\n9element contains the maximum, then the algorithm will discard all of the possible matches for thatrow.  The remaining possible matches will henceforth be referred to as matches.  Continuing the\nexample from Figure 5, after applying the preceding steps to the 100 vehicles, the resulting\nmatches are shown in Figure 8.  Note how most matches fall near the same column in this plot.\nThose matches far from column 80 in this plot are likely false positives that still remain.  Extending\nto the entire set of 1,500 vehicles with ground truth, the algorithm found a match for about 90\npercent of the vehicles, which includes false positives that have not been eliminated yet.  The\ncorresponding travel times for the matches are shown in Figure 9.  Clearly, some of the matches\nare due to false positives simply because the very large discontinuities between successive travel\ntime measurements are not feasible.CleanupTo eliminate additional false positives, the algorithm follows three steps to "cleanup" the matches,as follows.  The first step addresses the fact that a vehicle measured at the upstream station might\nbe matched to multiple vehicles measured at the downstream station.  As shown in Figure 10, the\nmatches for an upstream vehicle fall on a diagonal at 45 degrees in the chosen coordinate system.\nIt may take several minutes to observe all of the matches for a given upstream vehicle.  Rather than\nwaiting to observe the outcomes from all of the resolution tests, the algorithm uses as much\ninformation as possible immediately after identifying a match for a downstream vehicle.  For the\nmatch at (m,n) in Figure 10, the match is discarded if its sequence length is less than that of an\nearlier match for the same upstream vehicle.  Since the algorithm runs in real time, it can not\nconsider the outcomes from subsequent downstream vehicles.  So the upstream vehicle may still be\nmatched to multiple downstream vehicles, but the later matches (with respect to downstream\nvehicle number) are stronger than any earlier ones.Next, if several successive downstream vehicle measurements have a high frequency of falsepositives from the resolution test, there is a chance that the algorithm will select an incorrect\nsequence for these vehicles.  In other words, the matrix previously shown in Figure 4 may not be\nvery informative during these periods.  The second step of the cleanup process recognizes that\nwhen the algorithm will select an incorrect sequence, its location will be uniformly distributed\nacross the columns.  Now recall the fact that for a given downstream vehicle the most recent\nupstream vehicle bounds the set of feasible upstream matches on the right hand side of the row.Several vehicles (and potentially a false positive associated with one of these vehicles) can usually\nbe eliminated from the right hand side of this set simply because they would have to travel at\nexcessive speeds to be a true match.  For the current implementation, the algorithm discards any\nmatch that would require a link velocity in excess of 85 mph.'b"Coifman, B. and Cassidy, M.11/2/01\n10In the third step, the assumption that lane change maneuvers and missed vehicle detections arerelatively infrequent is maintained.  As such, a sequence of true but unknown matches in one\ncolumn is presumed to be preceded by other sequences of true matches in nearby columns.  To this\nend, the algorithm identifies consecutive sequences of matches, each consisting of all consecutivedownstream vehicles whose matches have the same upstream offset.  This calculation is necessary\nbecause the first two steps in the cleanup will likely disrupt the earlier sequences.  The algorithm\nthen compares the upstream offset of a given consecutive sequence against that of the precedingeight consecutive sequences.  If at least three of these comparisons are within 5 columns and thecurrent consecutive sequence is more than one vehicle long, the matches in the consecutivesequence are retained as final matches.  In any event, the consecutive sequence is kept for latercomparisons at this step.ResultsAfter applying the cleanup steps to the entire set of 1,500 vehicles, approximately 25 percent of thematches were eliminated.  Table 1 shows the number of matches retained after each step while the\nX's in Figure 11A indicate the travel times from the final matches.  Superimposing the travel times\nfrom the ground truth matches, it is clear that the algorithm performed quite well.  The algorithm\nfollowed the increasing and decreasing travel times as disturbances passed through the link, while\nthe local velocity measured at the detector stations ranged between 0 and 40 mph.  The algorithm\nmatched approximately 65 percent of the vehicles that passed the upstream site.  One false platoon\nof 12 vehicles and four false positives2 remained, yielding an error rate of 1.6 percent for thisexample.  It is important to note that the algorithm recovered after making these errors.  Finally, the\ntime between successive matches was typically on the order of a few seconds, as shown in Figure\n11B, with 1.3 minutes being the longest period without a reidentification.A LARGER EXAMPLENo effort was made in this algorithm to match vehicles that changed lane changes.  One could treateach lane as an independent process and integrate the results from all lanes for a more robust\nindicator.  An obvious extension to this work would be to look across all upstream lanes rather\nthan a single lane.  Nonetheless, as demonstrated in this paper, the algorithm works using data\nfrom a single lane.                                                2 These false positives fell at the start or end of sequences consisting mostly of true matches."b"Coifman, B. and Cassidy, M.11/2/01\n11Figure 12 shows an example of vehicle reidentification over a much larger set.  In this case, thealgorithm was applied to all five lanes over an 1,800 foot segment of westbound Interstate 80 in\nBerkeley, California.  The resulting travel times for matched vehicles are shown with dark points\nand the three hours shown in the figure include the onset of the morning peak.  The algorithm\nmatched between 40 and 55 percent of the passing vehicles in each lane during this period, even\nthough the sample includes many free flow vehicles.  Between 7:00 and 9:00, the most congested\nperiod, the algorithm found a match for 61 percent of the vehicles.  Following Caltrans\nconvention, the lanes are numbered from the inside out, and lane one is a high occupancy vehicle\n(HOV) lane.The process of manually generating ground truth data would be prohibitively labor intensive for the25,000 vehicles in this sample.  Coifman (2001a) presents a methodology to estimate link travel\ntimes using data from a single detector station.  Applying the estimation technique using data from\nthe upstream detector, and then repeating the estimation using data from the downstream detector,\nyields the two lines in each of the plots.  Except for a few transient errors, the pair of estimates\nbound the measured travel times in each of the lanes as disturbances propagate through the link.\nUnlike the measurement algorithm presented in this paper, the estimation technique can not\naccurately capture changes in travel time due to delay causing events within the link.  Using the\ntwo procedures in conjunction, significant deviations between the two methods should be\nindicative of an incident or a recurring bottleneck within the link.CONCLUSIONSThis paper has presented a new algorithm to match a vehicle's length measurement at adownstream detector station with that vehicle's corresponding measurement at an upstream station.\nThe algorithm rules out unlikely matches, looks for sequences of possible matches between\nmeasurements at the two stations and then eliminates unlikely sequences of these matches.The beauty of the approach is in its simplicity.  Matching vehicles between detector stations is adifficult task.  Preceding research efforts emphasized computationally intensive and/or hardware\nintensive strategies.  By creating the solution space of possible matches, the algorithm facilitates\nvehicle reidentification using existing detector hardware and inexpensive computers.  It is left to\nfuture research to determine the optimal parameters for the algorithm, as well as the relationship\nbetween station spacing and algorithm performance.  To this end, work is underway to develop the\nBerkeley Highway Laboratory (BHL), which includes eight dual-loop-detector stations and"b'Coifman, B. and Cassidy, M.11/2/01\n12machine vision vehicle tracking tools to ease the ground truth data collection (Coifman et al.,2000).  The BHL already uses the algorithm presented above to measure travel time in real time.3The contribution of this work to the field of traffic surveillance should prove to be significant since\nthe vehicle reidentification algorithm will allow the study of travel time applications without\ndeploying new hardware and thereby enable cost-benefit analysis before investing in a new\ndetection system.  If travel time measurement proves to be beneficial, the algorithm could be\ndeployed using dual-loop-detectors4, or it could be transferred to new detector technologies thathave better measurement accuracy.  The methodology should prove beneficial for research\npurposes as well; yielding better insight into vehicle dynamics between widely spaced detector\nstations without the host of assumptions necessary with simulation.As illustrated in this paper, the algorithm will not match every vehicle; however, it will extract thetrends exhibited by the majority of vehicles because the methodology matches platoons rather than\nindividual vehicles.  In this context, it is worth discussing the percentage of passing vehicles that\nmust be matched for surveillance.  For example, Origin-Destination studies would likely require\nnear perfect performance from non-AVI vehicle reidentification systems.  But travel time\nmeasurement is not as demanding, Van Aerde et al. (1993) estimated that matching 20 percent of\nthe population is sufficient for such measurements while Holdener and Turner (1996) suggest that\nthe percentage may even be smaller.  Using dual-loop-detector data, the algorithm has already\nsurpassed these guidelines for travel time measurement.ACKNOWLEDGMENTSThis work was performed as part of the California PATH (Partners for Advanced Highways andTransit) Program of the University of California, in cooperation with the State of California\nBusiness, Transportation and Housing Agency, Department of Transportation; and the United\nStates Department of Transportation, Federal Highway Administration.The Contents of this report reflect the views of the authors who are responsible for the facts andaccuracy of the data presented herein.  The contents do not necessarily reflect the official views or\npolicies of the State of California.  This report does not constitute a standard, specification or\nregulation.                                                3 The real time system can be viewed at: http://www.its.berkeley.edu/projects/freewaydata.4 It is worth noting that the additional hardware cost per station to deploy the algorithm across all lanes in the BHLis less than one percent of the cost to install a detector station for conventional traffic surveillance.'b'Coifman, B. and Cassidy, M.11/2/01\n13REFERENCESBalke, K., Ullman, G., McCasland, W., Mountain, C., Dudek, C., (1995) \nBenefits of Real-TimeTravel Information in Houston, Texas, Southwest Region University Transportation Center, TexasTransportation Institute, College Station, TX.Coifman, B., (1998a) Vehicle Reidentification and Travel Time Measurement Using Loop DetectorSpeed Traps, Dissertation, University of California.Coifman, B., (1998b) Vehicle Reidentification and Travel Time Measurement in Real-Time onFreeways Using the Existing Loop Detector Infrastructure, Transportation Research Record 1643,Transportation Research Board, pp 181-191.Coifman, B., (1999) Using Dual Loop Speed Traps to Identify Detector Errors, TransportationResearch Record no. 1683, Transportation Research Board, pp 47-58.Coifman, B., Lyddy, D., and Skabardonis, A. (2000) The Berkeley Highway Laboratory-Building on the I-880 Field Experiment, Proc. IEEE ITS Council Annual Meeting, pp 5-10.Coifman, B. (2001a) Estimating Travel Times and Vehicle Trajectories on Freeways Using DualLoop Detectors, Transportation Research: Part A, [in press].  Draft available at: http://www-ceg.eng.ohio-state.edu/~coifman/documents/estimate.pdfCoifman, B. (2001b) Identifying the Onset of Congestion Rapidly with Existing Traffic Detectors,Transportation Research: Part A, [submitted for publication].  Draft available at: http://www-ceg.eng.ohio-state.edu/~coifman/documents/Truck.pdfCui, Y., Huang, Q., (1997) Character Extraction of License Plates from Video, Proc. 1997 IEEEComputer Society Conference on Computer Vision and Pattern Recognition, IEEE, pp 502-507.Dailey, D., (1993) Travel Time Estimation Using Cross Correlation Techniques, TransportationResearch-Part B, Vol 27, No 2, pp 97-107.Holdener, D., Turner, S., (1996) Probe Vehicle Sample Sizes for Real-Time Information: theHouston Experience, Intelligent Transportation: Realizing the Benefits- Proc. of the 1996 AnnualMeeting of ITS America, Vol 1, ITS America, pp 287-295.Huang, T., Russell, S., (1997) Object Identification in a Bayesian Context, Proceedings of theFifteenth International Joint Conference on Artificial Intelligence (IJCAI-97), Nagoya, Japan.Morgan Kaufmann.'b'Coifman, B. and Cassidy, M.11/2/01\n14Variable Detection, Pacific Rim TransTech Conference Proc., Vol 1, ASCE, pp 56-62.System Performance, paper presented at the 76th annual TRB meeting, Transportation Research\nBoard.Larson, J., Van Katwyk, K., Liu, C., Cheng, H., Shaw, B., Palen, J., (1998) A Real-TimeLaser-Based Prototype Detection System for Measurement of Delineations of Moving Vehicles.UCB-ITS-PWP-98-20, PATH, University of California, Berkeley, CA, 1998.\nLevine, S., McCasland W., (1994) Monitoring Freeway Traffic Conditions with AutomaticVehicle Identification Systems, ITE Journal, Vol 64, No 3, pp 23-28.MacCarley, C. A., (1998) Videobased Vehicle Signature Analysis and Tracking Phase 1:Verification of Concept and Preliminary Testing. UCB-ITS-PWP-98-10, PATH, University ofCalifornia, Berkeley, CA.Petty, K., Bickel, P., Ostland, M., Rice, J., Schoenberg, F., Jiang, J., Ritov, Y., (1997)Accurate Estimation of Travel Times From Single Loop Detectors, Transportation Research-PartA, Vol 32, No 1, pp 1-17.\nPfannerstill, E., (1984) A Pattern Recognition System for the Re-identification of Motor Vehicles,Proc. 7th International Conference on Pattern Recognition, Montreal, IEEE, New Jersey, pp 553-555.Reijmers, J., (1979) On-Line Vehicle Classification, Proceedings of the International Symposiumon Traffic Control Systems, Vol 2B, Institute of Transportation Studies, University of Californiaat Berkeley, pp 87-102.Van Aerde, M., Hellinga, B., Yu, L., Rakha, H., (1993) Vehicle Probes as Real-Time ATMSSources of Dynamic O-D and Travel Time Data, Large Urban Systems- Proc. of the AdvancedTraffic Management Conference, FHWA, pp 207-230.Westerman, M., Immers, L., (1992) A Method for Determining Real-Time Travel Times onMotorways, Road Transport Informatics/Intelligent Vehicle Highways Systems, ISATA, pp 221-228.'b'Coifman, B. and Cassidy, M.11/2/01\n15Westerman, M., Litjens, R., Linnartz, J., (1996) Integration of Probe Vehicle and Induction LoopData- Estimation of Travel Times and Automatic Incident Detection. PATH, University ofCalifornia at Berkeley.Windover, J., (1998) Empirical Studies of the Dynamic Features of Freeway Traffic, Dissertation,University of California.'b'Coifman, B. and Cassidy, M.11/2/01\n16FIGURE CAPTIONSFigure 1,The segment of Interstate-80 in Berkeley, California used for this study.\nFigure 2,One veh\nicle passing over a dual-loop-detector, (A) the two detection zones and thevehicle trajectory as shown in the time space plane. The height of the vehicle\'s\ntrajectory reflects the non-zero vehicle length. (B) The associated turn-on and turn-off\ntransitions at each detector.Figure 3,(A) \n"Resolution test" between one downstream vehicle and a set of upstreamvehicles. If the upstream measurement range does not intersect the downstream\nmeasurement range, the upstream vehicle can be dismissed as being an unlikely match\nfor the downstream vehicle. (B) Everything that can not be eliminated are considered\npossible matches, as indicated with open circles. Note that each outcome is shown\ndirectly below the given comparison from part (A).Figure 4,Consider a set of 100 downstream vehicles, applying the resolution test to each of\nthese vehicles produces a set of possible matches, or one row in this matrix.  Note\nthat the columns are indexed by the upstream offset, so, if there were no lane changes\nin this coordinate system, all of the true matches would fall into a single column.Figure 5,All sequences of two or more possible matches for the on-going example.Figure 6,(A) The cumulative distribution of the percentage of possible matches for all 1495downstream vehicles. (B) Using concurrent video to calculate the true matches, the\nsolid line shows the cumulative distribution of sequence lengths measured by the\nalgorithm for these matches.  While the dashed line shows the cumulative distribution\nof sequence lengths for all other possible matches, i.e., the false positives.Figure 7,A \nsimple example illustrating the possible disruptions recognized by the Algorithm:(A) One vehicle exits the lane between stations or is not detected downstream, (B)\nOne vehicle enters the lane between stations or is not detected upstream, (C) One\nvehicle enters and one vehicle exits the lane between stations or is measured\nincorrectly at one of the stations, (D) The search region for the sequence starting at\nelement (m,n).  (E) Three sample sequences, one in each column n-1 to n+1. (F) In\nthis case, the sequence starting at (m,n) is joined via an entrance (part (B)) to a\nportion of an earlier sequence.'b'Coifman, B. and Cassidy, M.11/2/01\n17Figure 8,The \nresulting matches for the on-going example after allowing for lane changes.Each match corresponds to the longest modified sequence for the given downstream\nvehicle.  Note how most matches fall near column 80 with small column shifts due to\nlane change maneuvers.Figure 9,After applying the algorithm to 1495 vehicles, 1345 vehicles were matched by thealgorithm. This figure shows the resulting travel times for the matches.  Most of the\ntravel times seem plausible; but clearly, there are a significant number of erroneous\nmatches, manifest as random noise.Figure 10,Each match is compared to any earlier matches for the upstream vehicle (i.e., thediagonal line for the match at (m,n)). The match is discarded if its sequence length is\nless than that of an earlier match for the same upstream vehicle. The comparison does\nnot consider matches from later downstream vehicles since the algorithm runs in real\ntime.Figure 11,(A) Compare the travel times for the 1008 final matches against those from theground truth matches. (B) The time between successive final matches.Figure 12,A c\nomparison between measured travel times and estimated travel times for threehours, across five lanes, over an 1,800 ft segment.TABLE CAPTIONSTable 1,Number of matches after each cleanup step for the on-going example.\n'b' University Ave\nAshby Ave.\n1800 ftFigure 1,The segment of Interstate-80 in Berkeley, California used for this study.\nCoifman, B. and Cassidy, M.Upstream DualLoop DetectorDownstream DualLoop Detector'b"  Second Loop's Detection ZoneFirst Loop's Detection ZoneSecond Detector's ResponseFirst Detector's Responsedistancetimetime20 ft(A)(B)on1effective vehicle\nlengthoff\n1on2off\n2Vehicle Trajectory\nonoff\nonoff\nFigure 2,One vehicle passing over a dual-loop-detector, (A) the two detection zones and the vehicle \ntrajectory as shown in the time space plane. The height of the vehicle's trajectory reflects the \n\nnon-zero vehicle length. (B) The associated turn-on and turn-off transitions at each detector.\nCoifman, B. and Cassidy, M.TTrTTfOT1OT2"b' Length=downstream vehicle\'s \nlength + measurement \nuncertainty= possible match=upstream vehicle\'s \nlength + measurement \nuncertaintyupstream vehicle numberupstream vehicle numberFigure 3,(A) "Resolution test" between one downstream vehicle and a set of upstream vehicles. If the \nupstream measurement range does not intersect the downstream measurement range, the \nupstream vehicle can be dismissed as being an unlikely match for the downstream vehicle. \n(B) Everything that can not be eliminated are considered possible matches, as indicated with \nopen circles. Note that each outcome is shown directly below the given comparison from \npart (A).Coifman, B. and Cassidy, M.(A)(B)'b' 0204060801001200102030405060708090100= boundary line indicating the last feasible match for each downstream vehicle= possible matchFigure 4,Consider a set of 100 downstream vehicles, applying the resolution test to each of these \nvehicles produces a set of possible matches, or one row in this matrix.  Note that the \ncolumns are indexed by the upstream offset, so, if there were no lane changes in this \n\ncoordinate system, all of the true matches would fall into a single column.Coifman, B. and Cassidy, M.upstream offset(upstream vehicle number - downstream vehicle number)downstream vehicle number'b' 0204060801001200102030405060708090100upstream offsetdownstream vehicle numberFigure 5,All sequences of two or more possible matches for the on-going example.\nCoifman, B. and Cassidy, M.'b' true matches, mean 7.4 vehicles   false positives, mean 2.2 vehicles02468101214161820sequence length (vehicles)Percent01020304050\n6070809010000.10.20.30.40.50.60.70.80.9percentage of possible matchesPercent01020304050\n60708090100Figure 6,(A) The cumulative distribution of the percentage of possible matches for all 1495 downstream vehicles. (B) Using conc\nurrent video to calculate the true matches, the solid line shows the cumulative distribution of sequence lengths measured by the \nalgorithm for these matches.  While the dashed line shows the cumulative distribution of sequence lengths for all other possible matches, i.e., the false positives.Coifman, B. and Cassidy, M.(A)(B)\n'b' (A)n-2n-1\nn\nn+1m-4m-2m-1mm+2upstreamoffsetdownstreamvehicle #n+2= possible matchm-3m+1(B)n-2n-1\nn\nn+1m-4m-2m-1mm+2upstreamoffsetdownstreamvehicle #n+2m-3m+1(C)n-2n-1\nn\nn+1m-4m-2m-1mm+2upstreamoffsetdownstreamvehicle #n+2m-3m+1= element to check for   an earlier sequence(D)n-2n-1\nn\nn+1m-4m-2m-1mm+2upstreamoffsetdownstreamvehicle #n+2m-3m+1(E)n-2n-1\nn\nn+1m-4m-2m-1mm+2upstreamoffsetdownstreamvehicle #n+2m-3m+1(F)n-2n-1\nn\nn+1m-4m-2m-1mm+2upstreamoffsetdownstreamvehicle #n+2m-3m+1Figure 7,A simple example illustrating the possible disruptions recognized by the Algorithm:  (A) One \nvehicle exits the lane between stations or is not detected downstream, (B) One vehicle \nenters the lane between stations or is not detected upstream, (C) One vehicle enters and \none vehicle exits the lane between stations or is measured incorrectly at one of the stations, \n(D) The search region for the sequence starting at element (m,n).  (E) Three sample \n\nsequences, one in each column n-1 to n+1. (F) In this case, the sequence starting at (m,n) is \njoined via an entrance (part (B)) to a portion of an earlier sequence.Coifman, B. and Cassidy, M.'b' 0204060801001200102030405060708090100Figure 8,The resulting matches for the on-going example after allowing for lane changes.  Each \nmatch corresponds to the longest modified sequence for the given downstream vehicle.  \nNote how most matches fall near column 80 with small column shifts due to lane change \nmaneuvers.Coifman, B. and Cassidy, M.upstream offsetdownstream vehicle number'b' 16.216.416.616.81717.217.417.6050100150200250300350time of day (hours)travel time (seconds)Figure 9,After applying the algorithm to 1495 vehicles, 1345 vehicles were matched by the algorithm. \nThis figure shows the resulting travel times for the matches.  Most of the travel times seem \nplausible; but clearly, there are a significant number of erroneous matches, manifest as \n\nrandom noise.Coifman, B. and Cassidy, M.'b' m-4m-2m-1mm+2downstream vehicle #n-2n-1\nn\nn+1upstream offsetn+2m-3m+1n+3n+4\nn+5\nn+6\nn+7m-7m-5m-6????????????????????= best possible match for given row= search region for longest sequenceFigure 10,Each match is compared to any earlier matches for the upstream vehicle (i.e., the diagonal line for the match at (m,n)). The match is discarded if its sequence length is less than that of \n\nan earlier match for the same upstream vehicle. The comparison does not consider matches \n\nfrom later downstream vehicles since the algorithm runs in real time.Coifman, B. and Cassidy, M.'b' 16.216.416.616.81717.217.400.511.5time since last sample (minutes)time of day (hours)16.216.416.616.81717.217.4405060708090100110120130140time of day (hours)travel time (seconds)measured travel timetrue travel time    Figure 11,(A) Compare the travel times for the 1008 final matches against those from the ground truth \nmatches. (B) The time between successive final matches.\nCoifman, B. and Cassidy, M.(A)(B)'b' 6.577.588.59050100travel time (sec)6.577.588.59050100150travel time (sec)6.577.588.59050100150travel time (sec)6.577.588.59050100travel time (sec)6.577.588.59050100time (h)travel time (sec)lane 1lane 2lane 3\nlane 4lane 5Figure 12,A comparison between measured travel times and estimated travel times for three hours, \nacross five lanes, over an 1,800 ft segment.Coifman, B. and Cassidy, M.'b'Coifman, B. and Cassidy, M.StepNumber of Matches\npre-cleanup1345\n\nstep 11212\n\nstep 21202\n\nstep 3, final matches1008\nTable 1,  Number of matches after each cleanup step for the on-going example.'