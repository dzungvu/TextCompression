b'University of PennsylvaniaScholarlyCommons0;,=?809?,;0=&0;,=?809:8;@?091:=8,?.409.0Normalized Cuts and Image SegmentationJianbo Shi4>@;0990/@Jitendra Malik:77://4?4:9:=6?3I0;:>4?:=D@;09904>+;,;0=>$,=70.?=:8;@?0924900=49:88:9>:;D=4230;=49?0=:8 :>>2@>,20$@-74>30 IC/:4:=H4,?0=4?0==84>=84>9,9/:=>08099(94A0=>4?099>D7A,94,0=A4.0>9?0=9=>:9,?0=4=84I0/:B0A0==84>0;=490;@-74>8,?0=4/A0=?4>49:8:?4:9;:>00,?49:770.?4A:=60>0/4>?=4-@?@>-?,490=DB=4?49=84>>4:900:=40@809?2=0:A4>4:9:;D=423,B:?0.?49"#\'74.,?4,G74,?0,=9020794A0=>4?D@==09!,=.@7?8-00;,=?809:8;@?091:=8,?.409.94A0=>4?099>D7A,94,%0.:8809/04?,?4:94,4?09/=,746":=8,74E08,202809?,?4:92@>'b'Normalized Cuts and Image SegmentationAbstract*:;:>A0;;=:,:7A49=.0:@;49:-704>4:9,?30,@>49,?@=0:9>4>?09.40,2,?,;;=:,?=,.?49-0>>4:9,200,,202809?,?,;,=?4?4:949:-70:;:>A0-,7.=4?0=02809?49,;3.=4?0=,>@=0:?,7/4>>4847,=4??B004F0=09:@07:?7,=4?:@;>,90G.409:8;@?,?4:90,>0090=,74E0209A:-700484E>.=4?0=4:9,A;;740;;=:,02809?49?,?,20070<@09.00>0=9.:@=,249Keywords2=:@;492,202809?,?,;,=?4?4:9492:8;@?04209A,7@02091@9.?4:9,;3?30:=D,20<@09.04>>4847,=4?D209A,7@08,74E0@?=.0:@;4927,=4?DDisciplines70.?=:8;@?0924900=492Comments:;D=4230;=49?0=:8 :7@80>>2@>,20$@-74>30 IC/:4:=H4,?0=4?0==84>=84>9,D48;9/:=>0809994A0=>4?099>D7A,94,0=A4.0>9?0=9=>:9,7@>,?0=4=84I0/:B0A0==84>0;=490;@-74,?0=4/A0=?4>49;=:8:?4:9;:>00,?49:770.?4A:=60>0/4>?=4-@?@>-?,490=:8=4?49=84>>4:900:=40@809?2=07;=:A4>4:9:;D=423,B:?0.?49"#\'74.,?4,G74,?0,=9020794A0=>4?D@==09!,=.@7?8-00;,=?809:8;@?091:=8,?.409.?94A0=>4?099>D7A,94,H4:@=9=?A,47,-.3:7,=7D:88:93I0;:>4?:=D@;09904>+;,;0='b'NormalizedCutsandImageSegmentation\nJianboShiandJitendraMalik,\nMember,IEEE\nAbstractWeproposeanovelapproachforsolvingtheperceptualgroupingprobleminvision.Ratherthanfocusingonlocalfeatures\nandtheirconsistenciesintheimagedata,ourapproachaimsatextractingtheglobalimpressionofanimage.Wetreatimage\nsegmentationasagraphpartitioningproblemandproposeanovelglobalcriterion,the\nnormalizedcut\n,forsegmentingthegraph.The\nnormalizedcut\ncriterionmeasuresboththetotaldissimilaritybetweenthedifferentgroupsaswellasthetotalsimilaritywithinthe\ngroups.Weshowthatanefficientcomputationaltechniquebasedonageneralizedeigenvalueproblemcanbeusedtooptimizethis\ncriterion.Wehaveappliedthisapproachtosegmentingstaticimages,aswellasmotionsequences,andfoundtheresultstobevery\nencouraging.\nIndexTerms\nGrouping,imagesegmentation,graphpartitioning.\n1INTRODUCTIONNEARLY75yearsago,Wertheimer[24]pointedoutthe\nimportanceofperceptualgroupingandorganization\ninvisionandlistedseveralkeyfactors,suchassimilarity,\n\nproximity,andgoodcontinuation,whichleadtovisual\n\ngrouping.However,eventothisday,manyofthe\ncomputationalissuesofperceptualgroupinghavere-\nmainedunresolved.Inthispaper,wepresentageneral\n\nframeworkforthisproblem,focusingspecificallyonthe\n\ncaseofimagesegmentation.\nSincetherearemanypossiblepartitionsofthedomain\nIofanimageintosubsets,howdowepicktherightone?\n\nTherearetwoaspectstobeconsideredhere.Thefirstisthat\n\ntheremaynotbeasinglecorrectanswer.ABayesianviewis\n\nappropriatethereareseveralpossibleinterpretationsin\n\nthecontextofpriorworldknowledge.Thedifficulty,of\n\ncourse,isinspecifyingthepriorworldknowledge.Someof\n\nitislowlevel,suchascoherenceofbrightness,color,\n\ntexture,ormotion,butequallyimportantismid-orhigh-\n\nlevelknowledgeaboutsymmetriesofobjectsorobject\n\nmodels.Thesecondaspectisthatthepartitioningis\n\ninherentlyhierarchical.Therefore,itismoreappropriate\n\ntothinkofreturningatreestructurecorrespondingtoa\n\nhierarchicalpartitioninsteadofasingleflatpartition.\nThissuggeststhatimagesegmentationbasedonlow-\nlevelcuescannotandshouldnotaimtoproduceacomplete\n\nfinalcorrectsegmentation.Theobjectiveshouldinstead\n\nbeto\nusethelow-levelcoherenceofbrightness,color,texture,or\nmotionattributestosequentiallycomeupwithhierarchical\n\npartitions.Mid-andhigh-levelknowledgecanbeusedto\neitherconfirmthesegroupsorselectsomeforfurther\n\nattention.Thisattentioncouldresultinfurtherrepartition-\n\ningorgrouping.Thekeypointisthatimagepartitioningis\ntobedonefromthebigpicturedownward,ratherlikea\npainterfirstmarkingoutthemajorareasandthenfillingin\nthedetails.\nPriorliteratureontherelatedproblemsofclustering,\ngroupingandimagesegmentationishuge.Theclustering\ncommunity[12]hasofferedusagglomerativeanddivisive\nalgorithms;inimagesegmentation,wehaveregion-based\nmergeandsplitalgorithms.Thehierarchicaldivisive\napproachthatweadvocateproducesatree,the\ndendrogram.Whilemostoftheseideasgobacktothe1970s(andearlier),\nthe1980sbroughtintheuseofMarkovRandomFields[10]\nandvariationalformulations[17],[2],[14].TheMRFand\nvariationalformulationsalsoexposedtwobasicquestions:\n1.Whatisthecriterionthatonewantstooptimize?\n2.Isthereanefficientalgorithmforcarryingoutthe\noptimization?Manyanattractivecriterionhasbeendoomedbythe\ninabilitytofindaneffectivealgorithmtofinditsmini-\nmumgreedyorgradientdescenttypeapproachesfailto\n\nfindglobaloptimaforthesehigh-dimensional,nonlinear\nproblems.Ourapproachismostrelatedtothegraphtheoretic\nformulationofgrouping.Thesetofpointsinanarbitrary\nfeaturespacearerepresentedasaweightedundirected\ngraphGGVV;E\nE,wherethenodesofthegrapharethe\npointsinthefeaturespace,andanedgeisformedbetween\neverypairofnodes.Theweightoneachedge,\nwii;j\nj,isa\nfunctionofthesimilaritybetweennodes\niiandjj.Ingrouping,weseektopartitionthesetofverticesinto\ndisjointsets\nV1;V2;...;Vm,wherebysomemeasurethe\nsimilarityamongtheverticesinaset\nViishighand,across\ndifferentsets\nVi,Vjislow.\nTopartitionagraph,weneedtoalsoaskthefollowing\nquestions:1.Whatistheprecisecriterionforagoodpartition?\n2.Howcansuchapartitionbecomputedefficiently?\nIntheimagesegmentationanddataclusteringcommu-\nnity,therehasbeenmuchpreviousworkusingvariationsof\ntheminimalspanningtreeorlimitedneighborhoodset\napproaches.Althoughthoseuseefficientcomputational\n888IEEETRANSACTIONSONPATTERNANALYSISANDMACHINEINTELLIGENCE,VOL.22,NO.8,AUGUST2000\n.J.ShiiswiththeRoboticsInstitute,CarnegieMellonUniversity,5000\nForbesAve.,Pittsburgh,PA15213.E-mail:jshi@cs.cmu.edu\n.J.MalikiswiththeElectricalEngineeringandComputerScienceDivision,\nUniversityofCaliforniaatBerkeley,Berkeley,CA94720.\n\nE-mail:malik@cs.berkeley.edu.\nManuscriptreceived4Feb.1998;accepted16Nov.1999.\nRecommendedforacceptancebyM.Shah.\n\nForinformationonobtainingreprintsofthisarticle,pleasesende-mailto:\n\ntpami@computer.org,andreferenceIEEECSLogNumber107618.\n0162-8828/00/$10.00\n2000IEEE\n'b"methods,thesegmentationcriteriausedinmostofthemare\nbasedonlocalpropertiesofthegraph.Becauseperceptual\ngroupingisaboutextractingtheglobalimpressionsofa\n\nscene,aswesawearlier,thispartitioningcriterionoften\nfallsshortofthismaingoal.\nInthispaper,weproposeanewgraph-theoreticcriterion\nformeasuringthegoodnessofanimagepartitionthe\nnormalizedcut\n.Weintroduceandjustifythiscriterionin\nSection2.Theminimizationofthiscriterioncanbe\nformulatedasageneralizedeigenvalueproblem.The\neigenvectorscanbeusedtoconstructgoodpartitionsof\n\ntheimageandtheprocesscanbecontinuedrecursivelyas\ndesired(Section2.1).Section3givesadetailedexplanation\nofthestepsofourgroupingalgorithm.InSection4,we\nshowexperimentalresults.Theformulationandminimiza-\ntionofthenormalizedcutcriteriondrawsonabodyof\n\nresultsfromthefieldofspectralgraphtheory(Section5).\nRelationshiptoworkincomputervisionisdiscussedin\nSection6andcomparisonwithrelatedeigenvectorbased\n\nsegmentationmethodsisrepresentedinSection6.1.We\nconcludeinSection7.\nThemainresultsinthispaperwerefirstpresentedin[20].\n2GROUPINGAS\nGRAPHPARTITIONINGAgraph\nGV;Ecanbepartitionedintotwodisjoint\nsets,A;B\n,A[BV,A\\B;,bysimplyremovingedges\nconnectingthetwoparts.Thedegreeofdissimilarity\nbetweenthesetwopiecescanbecomputedastotalweight\n\noftheedgesthathavebeenremoved.Ingraphtheoretic\nlanguage,itiscalledthe\ncut:cutA;B\nXu2A;v2Bwu;v\n:1Theoptimalbipartitioningofagraphistheonethat\nminimizesthis\ncutvalue.Althoughthereareanexponential\nnumberofsuchpartitions,findingthe\nminimumcut\nofa\ngraphisawell-studiedproblemandthereexistefficient\n\nalgorithmsforsolvingit.\nWuandLeahy[25]proposedaclusteringmethodbased\nonthisminimumcutcriterion.Inparticular,theyseekto\npartitionagraphintok-subgraphssuchthatthemaximum\n\ncutacrossthesubgroupsisminimized.Thisproblemcanbe\nefficientlysolvedbyrecursivelyfindingtheminimumcuts\nthatbisecttheexistingsegments.AsshowninWuand\n\nLeahy'swork,thisgloballyoptimalcriterioncanbeusedto\nproducegoodsegmentationonsomeoftheimages.\nHowever,asWuandLeahyalsonoticedintheirwork,\ntheminimumcutcriteriafavorscuttingsmallsetsof\nisolatednodesinthegraph.Thisisnotsurprisingsince\n\nthecutdefinedin(1)increaseswiththenumberofedges\ngoingacrossthetwopartitionedparts.Fig.1illustratesone\nsuchcase.Assumingtheedgeweightsareinversely\n\nproportionaltothedistancebetweenthetwonodes,we\nseethecutthatpartitionsoutnode\nn1orn2willhaveavery\nsmallvalue.Infact,anycutthatpartitionsoutindividual\n\nnodesontherighthalfwillhavesmallercutvaluethanthe\ncutthatpartitionsthenodesintotheleftandrighthalves.\nToavoidthisunnaturalbiasforpartitioningoutsmall\nsetsofpoints,weproposeanewmeasureofdisassociation\nbetweentwogroups.Insteadoflookingatthevalueoftotal\nedgeweightconnectingthetwopartitions,ourmeasure\ncomputesthecutcostasafractionofthetotaledge\nconnectionstoallthenodesinthegraph.Wecallthis\ndisassociationmeasurethe\nnormalizedcut\n(Ncut):Ncut\nA;B\ncutA;B\nassocA;V\ncutA;B\nassocB;V\n;2whereassocA;V\nPu2A;t2Vwu;t\nisthetotalconnection\nfromnodesinAtoallnodesinthegraphand\nassocB;V\nissimilarlydefined.Withthisdefinitionofthedisassociation\nbetweenthegroups,thecutthatpartitionsoutsmall\n\nisolatedpointswillnolongerhavesmall\nNcutvalue,since\nthecutvaluewillalmostcertainlybealargepercentageof\nthetotalconnectionfromthatsmallsettoallothernodes.In\nthecaseillustratedinFig.1,weseethatthe\ncut1valueacrossnode\nn1willbe100percentofthetotalconnection\nfromthatnode.\nInthesamespirit,wecandefineameasurefortotal\nnormalizedassociationwithingroupsforagivenpartition:\nNassoc\nA;B\nassocA;A\nassocA;V\nassocB;B\nassocB;V\n;3whereassocA;A\nandassocB;B\naretotalweightsof\nedgesconnectingnodeswithin\nAandB,respectively.We\nseeagainthisisanunbiasedmeasure,whichreflectshow\ntightlyonaveragenodeswithinthegroupareconnectedto\neachother.\nAnotherimportantpropertyofthisdefinitionofassocia-\ntionanddisassociationofapartitionisthattheyare\n\nnaturallyrelated:\nNcut\nA;B\ncutA;B\nassocA;V\ncutA;B\nassocB;V\nassocA;V\nassocA;A\nassocA;V\nassocB;V\nassocB;B\nassocB;V\n2assocA;A\nassocA;V\nassocB;B\nassocB;V\n2Nassoc\nA;B\n:Hence,thetwopartitioncriteriathatweseekinour\ngroupingalgorithm,minimizingthedisassociationbetween\nthegroupsandmaximizingtheassociationwithinthe\nSHIANDMALIK:NORMALIZEDCUTSANDIMAGESEGMENTATION\n889Fig.1.Acasewhereminimumcutgivesabadpartition.\n"b'groups,areinfactidenticalandcanbesatisfiedsimulta-\nneously.Inouralgorithm,wewillusethisnormalizedcut\nasthepartitioncriterion.\nUnfortunately,minimizingnormalizedcutexactlyisNP-\ncomplete,evenforthespecialcaseofgraphsongrids.The\nproof,duetoPapadimitriou,canbefoundinAppendixA.\nHowever,wewillshowthat,whenweembedthenormal-\nizedcutproblemintherealvaluedomain,anapproximate\ndiscretesolutioncanbefoundefficiently.\n2.1ComputingtheOptimalPartition\nGivenapartitionofnodesofagraph,V,intotwosetsAand\nB,let\nxxbean\nNjVVjdimensionalindicatorvector,\nxi1ifnodeiisinAand\n1,otherwise.Let\nddiPjwi;j\nbethe\ntotalconnectionfromnode\niitoallothernodes.Withthe\ndefinitionsxxanddd,wecanrewrite\nNcut\nA;B\nas:Ncut\nA;B\ncutA;B\nassocA;V\ncutB;A\nassocB;V\nPxxi>0;xxj<0wijxxixxjPxxi>0ddiPxxi<0;xxj>0wijxxixxjPxxi<0ddi:LetDbean\nNNdiagonalmatrixwith\nddonitsdiagonal,\nWbean\nNNsymmetricalmatrixwith\nWi;jwij,kPxi>0ddiPiddi;and1bean\nN1vectorofallones.Usingthefact\n11xx2and11xx2areindicatorvectorsfor\nxi>0andxi<0,respectively,\nwecanrewrite\n4Ncut\nxxas:1xxTDW1xxk1TD11xxTDW1xx1k1TD1xxTDWxx1TDW1k1k1TD1212k1TDWxxk1k1TD1:LetxxxxTDWxx;xx1TDWxx;1TDW1;andM1TD1;wecanthenfurtherexpandtheaboveequationas:\nxx212kxxk1kMxx212kxxk1kM2xxM2xxM2M:Droppingthelastconstantterm,whichinthiscaseequals0,\nweget\n12k2k2xx212kxxk1kM2xxM12k2k21k2xx212k1k2xxk1kM2xxM:Lettingbk1k,andsince\n0,itbecomes\n1b2xx21b2xxbM2xxbM1b2xxbM21b2xxbM2xxbM2bM1b2xxTDWxx1TDW1b1TD121b21TDWxxb1TD12bxxTDWxxb1TD12b1TDW1b1TD11xxTDW1xxb1TD1b21xxTDW1xxb1TD12b1xxTDW1xxb1TD11xxb1xxTDW1xxb1xxb1TD1:Settingyy1xxb1xx,itiseasytoseethat\nyyTD1Xxi>0ddibXxi<0ddi04sincebk1kPxi>0ddiPxi<0ddiandyyTDyyXxi>0ddib2Xxi<0ddibXxi<0ddib2Xxi<0ddibXxi<0ddibXxi<0ddib1TD1:Puttingeverythingtogetherwehave,\nminxxNcut\nxxminyyyyTDWyyyyTDyy;5withthecondition\nyyi2f\n1;bgandyyTD10.NotethattheaboveexpressionistheRayleighquotient\n[11].If\nyyisrelaxedtotakeonrealvalues,wecanminimize\n(5)bysolvingthegeneralizedeigenvaluesystem,\nDWyyDyy:6However,wehavetwoconstraintson\nyywhichcomefrom\ntheconditiononthecorrespondingindicatorvector\nxx.First,\nconsidertheconstraint\nyyTD10.Wecanshowthis\nconstrainton\nyyisautomaticallysatisfiedbythesolutionof\nthegeneralizedeigensystem.Wewilldosobyfirst\n890IEEETRANSACTIONSONPATTERNANALYSISANDMACHINEINTELLIGENCE,VOL.22,NO.8,AUGUST2000\n'b'transforming(6)intoastandardeigensystemandshowing\nthecorrespondingconditionissatisfiedthere.Rewrite(6)as\nD12DWD12zzz;7wherezzD12yy.Onecaneasilyverifythat\nzz0D121isan\neigenvectorof(7)witheigenvalueof0.Furthermore,\n\nD12DWD12issymmetricpositivesemidefinitesince\nDW,alsocalledthe\nLaplacianmatrix,isknowntobe\npositivesemidefinite[18].Hence,\nzz0is,infact,thesmallest\neigenvectorof(7)andalleigenvectorsof(7)areperpendi-\n\nculartoeachother.Inparticular,\nzz1,thesecondsmallest\neigenvector,isperpendicularto\nzz0.Translatingthisstate-\nmentbackintothegeneraleigensystem(6),wehave:\n\n1)yy01isthesmallesteigenvectorwitheigenvalueof\n0and2)\n0zzT1zz0yyT1D1,where\nyy1isthesecondsmallest\neigenvectorof(6).\nNow,recallasimplefactaboutthe\nRayleighquotient\n[11]:LetAbearealsymmetricmatrix.Undertheconstraintthat\nxxisorthogonaltothej-1smallesteigenvectors\nxx1;...\n;xxj1,thequotient\nxxTAxxxxTxxisminimizedbythenextsmallest\neigenvectorxxjanditsminimumvalueisthecorresponding\neigenvaluej.Asaresult,weobtain:\nzz1arg:minzzTzz00zzTD12DWD12zzzzTzz8and,consequently,\nyy1arg:minyyTD10yyTDWyyyyTDyy:9Thus,thesecondsmallesteigenvectorofthegeneralized\neigensystem(6)istherealvaluedsolutiontoournormal-\nizedcutproblem.Theonlyreasonthatitisnotnecessarily\n\nthesolutiontoouroriginalproblemisthatthesecond\n\nconstrainton\nyythatyyitakesontwodiscretevaluesisnot\nautomaticallysatisfied.Infact,relaxingthisconstraintis\nwhatmakesthisoptimizationproblemtractableinthefirst\n\nplace.WewillshowinSection3howthisrealvalued\n\nsolutioncanbetransformedintoadiscreteform.\nAsimilarargumentcanalsobemadetoshowthatthe\neigenvectorwiththethirdsmallesteigenvalueisthereal\nvaluedsolutionthatoptimallysubpartitionsthefirsttwo\n\nparts.Infact,thislineofargumentcanbeextendedtoshow\n\nthatonecansubdividetheexistinggraphs,eachtimeusing\ntheeigenvectorwiththenextsmallesteigenvalue.How-\never,inpractice,becausetheapproximationerrorfromthe\n\nrealvaluedsolutiontothediscretevaluedsolution\n\naccumulateswitheveryeigenvectortakenandalleigen-\n\nvectorshavetosatisfyaglobalmutualorthogonality\nconstraint,solutionsbasedonhighereigenvectorsbecome\nunreliable.Itisbesttorestartsolvingthepartitioning\n\nproblemoneachsubgraphindividually.\nItisinterestingtonotethat,whilethesecondsmallest\neigenvectoryyof(6)onlyapproximatestheoptimalnormal-\nizedcutsolution,itexactlyminimizesthefollowing\nproblem:infyyTD10PiPjyyiyyj2wijPiyyi2di;10inreal-valueddomain,where\ndiDi;i\n.Roughly\nspeaking,thisforcestheindicatorvector\nyytotakesimilar\nvaluesfornodes\niandjthataretightlycoupled(large\nwij).Insummary,weproposeusingthenormalizedcut\ncriterionforgraphpartitioningandwehaveshownhow\nthiscriterioncanbecomputedefficientlybysolvinga\ngeneralizedeigenvalueproblem.\n3THEGROUPINGALGORITHMOurgroupingalgorithmconsistsofthefollowingsteps:\n1.Givenanimageorimagesequence,setupa\nweightedgraph\nGV;Eandsettheweighton\ntheedgeconnectingtwonodestobeameasureof\n\nthesimilaritybetweenthetwonodes.\n2.SolveDWxxDxxforeigenvectorswiththe\nsmallesteigenvalues.\n3.Usetheeigenvectorwiththesecondsmallest\neigenvaluetobipartitionthegraph.\n4.Decideifthecurrentpartitionshouldbesubdivided\nandrecursivelyrepartitionthesegmentedpartsif\n\nnecessary.Thegroupingalgorithm,aswellasitscomputational\ncomplexity,canbebestillustratedbyusingthefollowing\n\nexample.3.1Example:BrightnessImages\nFig.2showsanimagethatwewouldliketosegment.The\n\nstepsare:\n1.Constructaweightedgraph\nGV;Ebytaking\neachpixelasanodeandconnectingeachpairof\npixelsbyanedge.Theweightonthatedgeshould\n\nreflectthelikelihoodthatthetwopixelsbelongto\n\noneobject.Usingjustthebrightnessvalueofthe\n\npixelsandtheirspatiallocation,wecandefinethe\n\ngraphedgeweightconnectingthetwonodes\niandjas:wijekFFiFFjk222IekXXiXXjk222XifkXXiXXjk2<r0otherwise\n:8<:112.Solvefortheeigenvectorswiththesmallesteigen-\nvaluesofthesystem\nDWyyDyy:12Aswesawabove,thegeneralizedeigensystemin\n(12)canbetransformedintoastandardeigenvalue\n\nproblemof\nD12DWD12xxx:13Solvingastandardeigenvalueproblemforall\neigenvectorstakes\nOn3operations,where\nnisthe\nnumberofnodesinthegraph.Thisbecomes\nimpracticalforimagesegmentationapplications\n\nwherenisthenumberofpixelsinanimage.\nSHIANDMALIK:NORMALIZEDCUTSANDIMAGESEGMENTATION\n891'b'Fortunately,ourgraphpartitioninghasthefollow-\ningproperties:1)Thegraphsareoftenonlylocally\n\nconnectedandtheresultingeigensystemsarevery\n\nsparse,2)onlythetopfeweigenvectorsareneeded\n\nforgraphpartitioning,and3)theprecisionrequire-\n\nmentfortheeigenvectorsislow,oftenonlytheright\n\nsignbitisrequired.Thesespecialpropertiesofour\nproblemcanbefullyexploitedbyaneigensolver\ncalledtheLanczosmethod.Therunningtimeofa\n\nLanczosalgorithmis\nOmnOmMn[11],wheremisthemaximumnumberofmatrix-vector\ncomputationsrequiredand\nMnisthecostofa\nmatrix-vectorcomputationof\nAxx,where\nAD12DWD12.Notethatthesparsitystruc-\ntureof\nAisidenticaltothatoftheweightmatrix\nW.SinceWissparse,sois\nAandthematrix-vector\ncomputationisonly\nOn.Toseewhythisisthecase,wewilllookatthecost\noftheinnerproductofonerowof\nAAwithavector\nx.LetyiAAixPjAAijxj.Forafixed\ni,AAijisonly\nnonzeroifnode\njisinaspatialneighborhoodof\ni.Hence,thereareonlyafixednumberofoperations\n\nrequiredforeach\nAAixandthetotalcostof\ncomputingAAxisOn.Theconstantfactorisdeterminedbythesizeof\nthespatialneighborhoodofanode.Itturnsoutthat\n\nwecansubstantiallycutdownadditionalconnec-\n\ntionsfromeachnodetoitsneighborsbyrandomly\n\nselectingtheconnectionswithintheneighborhood\n\nfortheweightedgraph.Empirically,wehavefound\n\nthatonecanremoveupto90percentofthetotal\nconnectionswitheachoftheneighborhoodswhen\ntheneighborhoodsarelargewithoutaffectingthe\n\neigenvectorsolutiontothesystem.\nPuttingeverythingtogether,eachofthematrix-\nvectorcomputationscost\nOnoperationswitha\nsmallconstantfactor.Thenumber\nmdependson\nmanyfactors[11].Inourexperimentsonimage\n\nsegmentation,weobservedthat\nmistypicallyless\nthanOn12.Fig.3showsthesmallesteigenvectorscomputed\nforthegeneralizedeigensystemwiththeweight\n\nmatrixdefinedabove.\n3.Oncetheeigenvectorsarecomputed,wecanparti-\ntionthegraphintotwopiecesusingthesecond\n\nsmallesteigenvector.Intheidealcase,theeigenvec-\n\ntorshouldonlytakeontwodiscretevaluesandthe\n\nsignsofthevaluescantellusexactlyhowto\n\npartitionthegraph.However,oureigenvectorscan\n\ntakeoncontinuousvaluesandweneedtochoosea\n\nsplittingpointtopartitionitintotwoparts.Thereare\n\nmanydifferentwaysofchoosingsuchasplitting\npoint.Onecantake0orthemedianvalueasthe\nsplittingpointoronecansearchforthesplitting\n\npointsuchthattheresultingpartitionhasthebest\n\nNcut\nA;B\nvalue.Wetakethelatterapproachinour\nwork.Currently,thesearchisdonebychecking\nlevenlyspacedpossiblesplittingpoints,andcomput-\n\ningthebest\nNcutamongthem.Inourexperiments,\nthevaluesintheeigenvectorsareusuallywell\n\nseparatedandthismethodofchoosingasplitting\n\npointisveryreliableevenwithasmall\nl.4.Afterthegraphisbrokenintotwopieces,wecan\nrecursivelyrunouralgorithmonthetwopartitioned\nparts.Or,equivalently,wecouldtakeadvantageof\n\nthespecialpropertiesoftheothertopeigenvectorsas\n\nexplainedintheprevioussectiontosubdividethe\n\ngraphbasedonthoseeigenvectors.Therecursion\n\nstopsoncethe\nNcutvalueexceedscertainlimit.\nWealsoimposeastabilitycriteriononthe\npartition.Aswesawearlier,andasweseeinthe\n\neigenvectorswiththeseventhtoninthsmallest\neigenvalues(Fig.3g-h),sometimesaneigenvector\ncantakeontheshapeofacontinuousfunction,\n\nratherthatthediscreteindicatorfunctionthatwe\n\nseek.Fromtheviewofsegmentation,suchan\n\neigenvectorisattemptingtosubdivideanimage\n\nregionwherethereisnosurewayofbreakingit.In\n\nfact,ifweareforcedtopartitiontheimagebasedon\nthiseigenvector,wewillseetherearemanydifferent\nsplittingpointswhichhavesimilar\nNcut\nvalues.Hence,thepartitionwillbehighlyuncertainand\n\nunstable.Inourcurrentsegmentationscheme,we\n\nsimplychoosetoignoreallthoseeigenvectorswhich\n\nhavesmoothlyvaryingeigenvectorvalues.We\nachievethisbyimposingastabilitycriterionwhich\nmeasuresthedegreeofsmoothnessintheeigenvec-\n\ntorvalues.Thesimplestmeasureisbasedonfirst\n\ncomputingthehistogramoftheeigenvectorvalues\n\nandthencomputingtheratiobetweentheminimum\n\nandmaximumvaluesinthebins.Whenthe\neigenvectorvaluesarecontinuouslyvarying,the\nvaluesinthehistogrambinswillstayrelativelythe\n\nsameandtheratiowillberelativelyhigh.Inour\n\nexperiments,wefindthatsimplethresholdingonthe\n\nratiodescribedabovecanbeusedtoexclude\n\nunstableeigenvectors.Wehavesetthatvaluetobe\n\n0.06inallourexperiments.\nFig.4showsthefinalsegmentationfortheimage\nshowninFig.2.\n3.2RecursiveTwo-WayNcut\nInsummary,ourgroupingalgorithmconsistsofthe\n\nfollowingsteps:\n892IEEETRANSACTIONSONPATTERNANALYSISANDMACHINEINTELLIGENCE,VOL.22,NO.8,AUGUST2000\nFig.2.Agraylevelimageofabaseballgame.\n'b'1.Givenasetoffeatures,setupaweightedgraph\nGV;E,computetheweightoneachedge,and\nsummarizetheinformationinto\nWandD.2.SolveDWxxDxxforeigenvectorswiththe\nsmallesteigenvalues.\n3.Usetheeigenvectorwiththesecondsmallest\neigenvaluetobipartitionthegraphbyfindingthe\n\nsplittingpointsuchthat\nNcut\nisminimized.\n4.Decideifthecurrentpartitionshouldbesubdivided\nbycheckingthestabilityofthecut,andmakesure\n\nNcut\nisbelowtheprespecifiedvalue.\n5.Recursivelyrepartitionthesegmentedpartsif\nnecessary.Thenumberofgroupssegmentedbythismethodis\ncontrolleddirectlybythemaximumallowed\nNcut\n.3.3SimultanousK-WayCutwithMultiple\nEigenvectors\nOnedrawbackoftherecursive2-waycutisitstreatmentof\ntheoscillatoryeigenvectors.Thestabilitycriteriakeepsus\nfromcuttingoscillatoryeigenvectors,butitalsopreventsus\n\ncuttingthesubsequenteigenvectorswhichmightbeperfect\npartitioningvectors.Also,theapproachiscomputationally\nwasteful;onlythesecondeigenvectorisused,whereasthe\nnextfewsmalleigenvectorsalsocontainusefulpartitioning\ninformation.Insteadoffindingthepartitionusingrecursive2-waycut\nasdescribedabove,onecanuseallofthetopeigenvectors\n\ntosimultanouslyobtainaK-waypartition.Inthismethod,\nthentopeigenvectorsareusedas\nndimensionalindicator\nvectorsforeachpixel.Inthefirststep,asimpleclustering\n\nalgorithm,suchasthek-meansalgorithm,isusedtoobtain\nanoversegmentationoftheimageinto\nk0groups.No\nattemptismadetoidentifyandexcludeoscillatory\neigenvectorstheyexacerbatetheoversegmentation,but\nthatwillbedealtwithsubsequently.\nInthesecondstep,onecanproceedinthefollowingtwo\nways:1.Greedypruning:Iterativelymergetwosegmentsata\ntimeuntilonly\nksegmentsareleft.Ateachmerge\nstep,thosetwosegmentsaremergedthatminimize\n\nthek-wayNcut\ncriteriondefinedas:\nNcut\nkcutA1;VA1assocA1;VcutA2;VA2assocA2;V...cutAk;AAkassocAk;V;14SHIANDMALIK:NORMALIZEDCUTSANDIMAGESEGMENTATION\n893Fig.3.Subplot(a)plotsthesmallesteigenvectorsofthegeneralizedeigenvaluesystem(11).Subplots(b)-(i)showtheeigenvectorscorrespondin\ngthesecondsmallesttotheninthsmallesteigenvaluesofthesystem.Theeigenvectorsarereshapedtobethesizeoftheimage.\n'b'whereAiisthe\nithsubsetofwholeset\nV.Thiscomputationcanbeefficientlycarriedoutby\niterativelyupdatingthecompactedweightmatrix\nWc,with\nWci;j\nassocAi;Aj.2.Globalrecursivecut.Fromtheinitial\nk0segments,we\ncanbuildacondensedgraph\nGcVc;Ec,where\neachsegment\nAicorrespondstoanode\nVciofthe\ngraph.Theweightoneachgraphedge\nWci;j\nisdefinedtobe\nassocAi;Aj,thetotaledgeweights\nfromelementsin\nAitoelementsin\nAj.Fromthis\ncondensedgraph,wethenrecursivelybipartitionthe\ngraphaccordingthe\nNcut\ncriterion.Thiscanbe\ncarriedouteitherwiththegeneralizedeigenvalue\n\nsystem,asinSection3.2,orwithexhaustivesearch\n\ninthediscretedomain.Exhaustivesearchispossible\n\ninthiscasesince\nk0issmall,typically\nk0100.Wehaveexperimentedwiththissimultanous\nk-waycut\nmethodonourrecenttestimages.However,theresults\npresentedinthispaperareallbasedontherecursive2-way\npartitioningalgorithmoutlinedinSection3.2.\n4EXPERIMENTSWehaveappliedourgroupingalgorithmtoimage\nsegmentationbasedonbrightness,color,texture,ormotion\ninformation.Inthemonocularcase,weconstructthegraph\n\nGV;Ebytakingeachpixelasanodeanddefinethe\nedgeweight\nwijbetweennode\niandjastheproductofa\nfeaturesimilaritytermandspatialproximityterm:\nwijekFFiFFjk22IekXXiXXjk22XifkXXiXXjk2<r0otherwise\n;(whereXXiisthespatiallocationofnode\ni,and\nFFiisa\nfeaturevectorbasedonintensity,color,ortextureinforma-\n\ntionatthatnodedefinedas:\n.FFi1,inthecaseofsegmentingpointsets,\n.FFiIIi,theintensityvalue,forsegmenting\nbrightnessimages,\n.FFiv;v\nssinh;vscosh\ni,where\nh;s;v\naretheHSVvalues,forcolorsegmentation,\n.FFij\nIIf1j;...;jIIfnj\ni,wherethe\nfiareDOOGfiltersatvariousscalesandorientationsas\nusedin[16],inthecaseoftexturesegmentation.\nNotethattheweight\nwij0foranypairofnodes\niandjthataremorethan\nrpixelsapart.\nWefirsttestedourgroupingalgorithmonspatialpoint\nsets.Fig.5showsapointsetandthesegmentationresult.\nThenormalizedcutcriterionisindeedabletopartitionthe\n\npointsetinadesirableway.\nFigs.4,6,7,and8showtheresultofoursegmentation\nalgorithmonvariousbrightnessimages.Figs.6and7are\nsyntheticimageswithaddednoise.Figs.4and8arenatural\nimages.NotethattheobjectsinFig.8haveratherill-\n\ndefinedboundaries,whichwouldmakeedgedetection\nperformpoorly.Fig.9showsthesegmentationonacolor\nimage,reproducedingrayscaleinthesetransactions.The\n\noriginalimageandmanyotherexamplescanbefoundat\nwebsitehttp://www.cs.berkeley.edu/~jshi/Grouping.\nNotethat,inalltheseexamples,thealgorithmisableto\nextractthemajorcomponentsofscenewhileignoringsmall\n\nintracomponentvariations.Asdesired,recursivepartition-\n\ningcanbeusedtofurtherdecomposeeachpiece.\nFig.10showspreliminaryresultsontexturesegmenta-\ntionforanaturalimageofazebraagainstabackground.\nNotethatthemeasurewehaveusedisorientation-variant\n\nand,therefore,partsofthezebraskinwithdifferentstripe\norientationshouldbemarkedasseparateregions.\nInthemotioncase,wewilltreattheimagesequenceasa\nspatiotemporaldataset.Givenanimagesequence,a\nweightedgraphisconstructedbytakingeachpixelinthe\n\nimagesequenceasanodeandconnectingpixelsthatarein\nthespatiotemporalneighborhoodofeachother.Theweight\noneachgraphedgeisdefinedas:\n894IEEETRANSACTIONSONPATTERNANALYSISANDMACHINEINTELLIGENCE,VOL.22,NO.8,AUGUST2000\nFig.4.(a)showstheoriginalimageofsize\n80100.Imageintensityisnormalizedtoliewithin0and1.Subplots(b)-(h)showthecomponentsofthe\npartitionwith\nNcut\nvaluelessthan0.04.Parametersetting:\nI0:1,X4:0,r5.'b'wijedmi;j22mifkXXiXXjk2<r0otherwise\n;(wheredi;j\nisthemotiondistancebetweentwopixels\niandj.Notethat\nXXiinthiscaserepresentsthespatial-\ntemporalpositionofpixel\ni.Tocomputethismotiondistance,wewilluseamotion\nfeaturecalled\nmotionprofile\n.By\nmotionprofile\nweseekto\nestimatetheprobabilitydistributionofimagevelocityat\neachpixel.Let\nIItXdenoteaimagewindowcenteredat\nthepixelatlocation\nX2R2attime\nt.Wedenoteby\nPidxthemotionprofile\nofanimagepatchatnode\ni,IItXi,attime\ntcorrespondingtoanotherimagepatch\nIIt1Xidxattimet1.Pidxcanbeestimatedbyfirstcomputingthe\nsimilaritySidxbetweenIItXiandIIt1Xidxandnormalizingittogetaprobabilitydistribution:\nPidxSidxPdxSidx:15Therearemanywaysonecancomputesimilaritybetween\ntwoimagepatches;wewilluseameasurethatisbasedon\nthesumofsquareddifferences(SSD):\nSidxexpXwIItXiwIIt1Xidxw2=2ssd;16wherew2R2iswithinalocalneighborhoodofimage\npatchIItXi.Themotiondistancebetweentwoimage\npixelsisthendefinedasoneminusthecross-correlationof\nthemotionprofiles:\ndi;j\n1XdxPidxPjdx:17InFig.11,weshowresultsofthenormalizedcutalgorithm\nonasyntheticrandomdotmotionsequenceandaindoor\nmotionsequence,respectively.Formoreelaboratediscussion\nonmotionsegmentationusingnormalizedcut,aswellashow\ntosegmentandtrackoverlongimagesequences,readers\nmightwanttorefertoourpaper[21].\n4.1ComputationTime\nAswesawfromSection3.1,therunningtimeofthe\nnormalizedcutalgorithmis\nOmn,where\nnisthenumber\nSHIANDMALIK:NORMALIZEDCUTSANDIMAGESEGMENTATION\n895Fig.5.(a)PointsetgeneratedbytwoPoissonprocesses,withdensitiesof2.5and1.0ontheleftandrightclustersrespectively,(b)\n4andindicatethepartitionofpointsetin(a).Parametersettings:\nX5,r3.Fig.6.(a)Asyntheticimageshowinganoisystepimage.Intensityvariesfrom0to1,andGaussiannoisewith\n0:2isadded.Subplot(b)shows\ntheeigenvectorwiththesecondsmallesteigenvalueandsubplot(c)showstheresultingpartition.\nFig.7.(a)Asyntheticimageshowingthreeimagepatchesformingajunction.Imageintensityvariesfrom0to1andGaussiannoisewith\n0:1isadded.(b)-(d)showthetopthreecomponentsofthepartition.\n'b'ofpixelsand\nmisthenumberofstepsLanczostakesto\nconverge.Onthe\n100120testimagesshownhere,the\nnormalizedcutalgorithmtakesabout2minutesonIntel\n\nPentium200MHzmachines.\nAmultiresolutionimplementationcanbeusedtoreduce\nthisrunningtimefurtheronlargerimages.Inourcurrent\nexperiments,withthisimplementation,therunningtimeon\n\na300400imagecanbereducedtoabout20secondson\nIntelPentium300MHzmachines.Furthermore,thebottle-\nneckofthecomputation,asparsematrix-vector\nmultiplicationstep,canbeeasilyparallelizedtaking\nadvantageoffuturecomputerchipdesigns.\nInourcurrentimplementation,thesparseeigenvalue\ndecompositioniscomputedusingtheLASO2numerical\n\npackagedevelopedbyScott.\n4.2ChoiceofGraphEdgeWeight\nIntheexamplesshownhere,weusedanexponential\n\nfunctionoftheformof\nwxedx=2ontheweighted\ngraphedgewithfeaturesimilarityof\ndx.Thevalueof\nis896IEEETRANSACTIONSONPATTERNANALYSISANDMACHINEINTELLIGENCE,VOL.22,NO.8,AUGUST2000\nFig.8.(a)showsa\n126106weatherradarimage.(b)-(g)showthecomponentsofthepartitionwith\nNcut\nvaluelessthan0.08.Parametersetting:\nI0:007,x15:0,r10.Fig.9.(a)showsa\n77107colorimage.(b)-(e)showthecomponentsofthepartitionwith\nNcut\nvaluelessthan0.04.Parametersettings:\nI0:01,X4:0,r5.Fig.10.(a)showsanimageofazebra.Theremainingimagesshowthemajorcomponentsofthepartition.Thetexturefeaturesusedcorrespondto\nconvolutionswithDOOGfilters[16]atsixorientationsandfivescales.\n'b'typicallysetto10to20percentofthetotalrangeofthe\nfeaturedistancefunction\ndx.Theexponentialweighting\nfunctionischosenhereforitsrelativesimplicity,aswellas\n\nneutrality,sincethefocusofthispaperisondevelopinga\ngeneralsegmentationprocedure,givenafeaturesimilarity\nmeasure.Wefoundthischoiceofweightfunctionisquite\nadequatefortypicalimageandfeaturespaces.Section6.1\nshowstheeffectofusingdifferentweightingfunctionsand\n\nparametersontheoutputofthenormalizedcutalgorithm.\nHowever,thegeneralproblemofdefiningfeature\nsimilarityincorporatingavarietyofcuesisnotatrivial\none.Thegroupingcuescouldbeofdifferentabstraction\n\nlevelsandtypesandtheycouldbeinconflictwitheach\nother.Furthermore,theweightingfunctioncouldvaryfrom\nimageregiontoimageregion,particularlyinatextured\nimage.Someoftheseissuesareaddressedin[15].\n5RELATIONSHIPTO\nSPECTRALGRAPHTHEORYThecomputationalapproachthatwehavedevelopedfor\n\nimagesegmentationisbasedonconceptsfromspectral\ngraphtheory.Thecoreideaistousematrixtheoryand\n\nlinearalgebratostudypropertiesoftheincidencematrix,\nW,andtheLaplacianmatrix,\nDW,ofthegraphand\nrelatethembacktovariouspropertiesoftheoriginalgraph.\n\nThisisarichareaofmathematicsandtheideaofusing\neigenvectorsoftheLaplacianforfindingpartitionsof\ngraphscanbetracedbacktoCheeger[4],Donathand\nHoffman[7],andFiedler[9].Thisareahasalsoseen\ncontributionsbytheoreticalcomputerscientists[1],[3],\n\n[22],[23].Itcanbeshownthatournotionof\nnormalizedcutisrelatedbyaconstantfactortotheconceptof\nconductancein[22].\nForatutorialintroductiontospectralgraphtheory,we\nrecommendtherecentmonographbyChung[5].Inthis\n\nmonograph,Chungproposesanormalizeddefinitionof\ntheLaplacian,as\nD12DWD12.Theeigenvectorsforthis\nnormalizedLaplacian,whenmultipliedby\nD12,are\nexactlythegeneralizedeigenvectorsweusedtocompute\nnormalizedcut.Chungpointsoutthattheeigenvaluesof\nthisnormalizedLaplacianrelatewelltographinvariants\n\nforgeneralgraphinwaysthateigenvaluesofthestandard\n\nLaplacianhavefailedtodo.\nSpectralgraphtheoryprovidesussomeguidanceonthe\ngoodnessoftheapproximationtothenormalizedcut\n\nprovidedbythesecondeigenvalueofthenormalized\n\nLaplacian.Onewayisthroughboundsonthenormalized\n\nCheegerconstant[5]which,inourterminology,canbe\n\ndefinedas\nhGinfcutA;B\nminassocA;V\n;assoc\nB;V\n:18Theeigenvaluesof(6)arerelatedtotheCheegerconstantby\ntheinequality[5]:\n2hG1>h2G2:19Earlierworkonspectralpartitioningusedthesecond\neigenvectorsoftheLaplacianofthegraphdefinedas\nDWtopartitionagraph.Thesecondsmallesteigenvalueof\n\nDWissometimesknownastheFiedlervalue.Several\nresultshavebeenderivedrelatingthe\nratiocut\nandthe\nFiedlervalue.A\nratiocut\nofapartitionof\nV,PA;V\nA,which,infact,isthestandarddefinitionoftheCheeger\n\nconstant,isdefinedas\ncutA;VAminjAj;jVAj.Itwasshownthatifthe\nFiedlervalueissmall,partitioningthegraphbasedonthe\n\nFiedlervectorwillleadtogood\nratiocut\n[1],[23].Our\nderivationinSection2.1canbeadapted(byreplacingthe\n\nmatrixDinthedenominatorsbytheidentitymatrix\nI)to\nshowthattheFiedlervectorisarealvaluedsolutiontothe\nproblemof\nminAVcutA;VAjAjcutVA;AjVAj,whichwecancall\ntheaveragecut\n.Althoughaveragecut\nlookssimilartothe\nnormalizedcut\n,averagecut\ndoesnothavetheimportantpropertyofhavinga\nSHIANDMALIK:NORMALIZEDCUTSANDIMAGESEGMENTATION\n897Fig.11.Subimages(a)and(b)showtwoframesofanimagesequence.Segmentationresultsonthistwoframeimagesequenceareshownin\nsubimages(c)to(g).Segmentsin(c)and(d)correspondtothepersonintheforegroundandsegmentsin(e)to(g)correspondtothebackground.\nThereasonthattheheadofthepersonissegmentedawayfromthebodyisthat,althoughtheyhavesimilarmotion,theirmotionprofilesare\ndifferent.Theheadregioncontains2Dtexturesandthemotionprofilesaremorepeaked,while,inthebodyregion,themotionprofilesaremore\n\nspreadout.Segment(e)isbrokenawayfrom(f)and(g)forthesamereason.\n'b"simplerelationshiptothe\naverageassociation\n,whichcanbe\nanalogouslydefinedas\nassocA;AjAjassocVA;VAjVAj.Conse-\nquently,onecannotsimultaneouslyminimizethedisasso-\nciationacrossthepartitionswhilemaximizingthe\nassociationwithinthegroups.Whenweappliedboth\n\ntechniquestotheimagesegmentationproblem,wefound\nthatthe\nnormalizedcut\nproducesbetterresultsinpractice.\nTherearealsootherexplanationswhythe\nnormalizedcut\nhasbetterbehaviorfromgraphtheoreticalpointofview,as\n\npointedoutbyChung[5].\nOurwork,originallypresentedin[20],representsthe\nfirstapplicationofspectralpartitioningtocomputervision\norimageanalysis.Thereis,however,oneapplicationarea\n\nthathasseensubstantialapplicationofspectralpartitio-\n\nningtheareaofparallelscientificcomputing.Thepro-\n\nblemthereistobalancetheworkloadovermultiple\n\nprocessorstakingintoaccountcommunicationneeds.One\n\noftheearlypapersis[18].Thegeneralizedeigenvalue\napproachwasfirstappliedtographpartitioningby[8]for\ndynamicallybalancingcomputationalloadinaparallel\n\ncomputer.Theiralgorithmismotivatedby[13]'spaperon\n\nrepresentingahypergraphinaEuclideanspace.\nThenormalizedcutcriteriaisalsocloselyrelatedtokey\npropertiesofaMarkovRandomWalk.Thesimilaritymatrix\n\nWcanbenormalizedtodefineaprobabilitytransition\nmatrixPofarandomwalkonthepixels.Itcanbeshown\nthattheconductance[22]ofthisrandomwalkisthe\nnormalizedcutvalueandthenormalizedcutvectorsof(12)\n\nareexactlytherighteigenvectorsof\nP.5.1APhysicalInterpretation\nAsonemightexpect,aphysicalanalogycanbesetupfor\nthegeneralizedeigenvaluesystem(6)thatweusedto\n\napproximatethesolutionofnormalizedcut.Wecan\n\nconstructaspring-masssystemfromtheweightedgraph\n\nbytakinggraphnodesasphysicalnodesandgraphedges\nasspringsconnectingeachpairofnodes.Furthermore,we\nwilldefinethegraphedgeweightasthespringstiffnessand\n\nthetotaledgeweightsconnectingtoanodeasitsmass.\nImaginewhatwouldhappenifweweretogiveahard\nshaketothisspring-masssystem,forcingthenodesto\n\noscillateinthedirectionperpendiculartotheimageplane.\n\nNodesthathavestrongerspringconnectionsamongthem\n\nwilllikelyoscillatetogether.Astheshakingbecomesmore\nviolent,weakerspringsconnectingtothisgroupofnode\nwillbeoverstretched.Eventually,thegroupwillpopoff\n\nfromtheimageplane.Theoverallsteadystatebehaviorof\n\nthenodescanbedescribedbyitsfundamentalmodeof\n\noscillation.Infact,itcanbeshownthatthefundamental\n\nmodesofoscillationofthisspringmasssystemareexactly\n\nthegeneralizedeigenvectorsof(6).\nLetkijbethespringstiffnessconnectingnodes\niandj.DefineKtobethe\nnnstiffnessmatrix,with\nKi;i\nPikijandKi;j\nkij.Definethediagonal\nnnmassmatrixMasMi;i\nPikij.Let\nxtbethe\nn1vectordescribingthemotionofeachnode.Thisspring-mass\n\ndynamicsystemcanbedescribedby:\nKxtMxt:20Assumingthesolutiontakestheformof\nxtvkcos!kt,thesteadystatesolutionsofthis\nspring-masssystemsatisfy:\nKvk!2kMvk;21analogousto(6)for\nnormalizedcut\n.Eachsolutionpair\n!k;vkof(21)describesa\nfundamentalmodeofthespring-masssystem.Theeigenvectors\nvkgivethesteadystatedisplacementoftheoscillationineach\n\nmodeandtheeigenvalues\n!2kgivetheenergyrequiredto\nsustaineachmodeofoscillation.Therefore,findinggraph\npartitionsthathavesmallnormalizedcutvaluesis,ineffect,\nthesameasfindingawaytopopoffimageregionswith\nminimaleffort.\n6RELATIONSHIPTO\nOTHERGRAPHTHEORETICAPPROACHESTO\nIMAGESEGMENTATIONInthecomputervisioncommunity,therehasbeensome\nbeenpreviousworkonimagesegmentationformulatedasa\n\ngraphpartitionproblem.WuandLeahy[25]usethe\nminimumcut\ncriterionfortheirsegmentation.Asmentioned\nearlier,ourcriticismofthiscriterionisthatittendstofavor\n\ncuttingoffsmallregions,whichisundesirableinthecontext\n\nofimagesegmentation.Inanattempttogetmorebalanced\npartitions,Coxetal.[6]seektominimizetheratio\ncutA;VAweightA;AV,where\nweightAissomefunctionofthe\nsetA.When\nweightAistakentobethesumofthe\nelementsin\nA,weseethatthiscriterionbecomesoneofthe\ntermsinthedefinitionof\naveragecut\nabove.Coxetal.usean\nefficientdiscretealgorithmtosolvetheiroptimization\nproblemassumingthegraphisplanar.\nSarkarandBoyer[19]usetheeigenvectorwiththe\nlargesteigenvalueofthesystem\nWxxxforfindingthe\nmostcoherentregioninanedgemap.Usingasimilar\n\nderivationasinSection2.1,wecanseethatthefirstlargest\neigenvectoroftheirsystemapproximates\nminAVassocA;AjAjandthesecondlargesteigenvectorapproximates\nminAV;B\nVassocA;AjAjassocB;BjBj.However,theapproxima-\ntionisnottightandthereisnoguaranteethat\nABV.Aswewillseelaterinthesection,thissituationcanhappen\nquiteofteninpractice.Sincethisalgorithmisessentially\nlookingforclustersthathavetightwithin-grouping\n\nsimilarity,wewillcallthiscriteria\naverageassociation\n.6.1ComparisonwithRelatedEigenvector-Based\nMethods\nThenormalizedcut\nformulationhasacertainresemblanceto\ntheaveragecut\n,thestandardspectralgraphpartitioning,as\nwellas\naverageassociation\nformulation.Allthreeofthese\nalgorithmscanbereducedtosolvingcertaineigenvalue\nsystems.Howaretheyrelatedtoeachother?\nFig.12summarizestherelationshipbetweenthesethree\nalgorithms.Ononehand,boththe\nnormalizedcut\nandthe\naveragecut\nalgorithmaretryingtofindabalanced\npartitionofaweightedgraph,while,ontheotherhand,\n898IEEETRANSACTIONSONPATTERNANALYSISANDMACHINEINTELLIGENCE,VOL.22,NO.8,AUGUST2000\n"b'thenormalizedassociation\nandthe\naverageassociation\naretryingtofindtightclustersinthegraph.Sincethe\n\nnormalizedassociation\nisexactly\n2ncut,the\nnormalizedcut\nvalue,the\nnormalizedcut\nformulationseeksabalance\nbetweenthegoalofclusteringandsegmentation.Itis,\ntherefore,nottoosurprisingtoseethatthenormalizedcut\n\nvectorcanbeapproximatedwiththegeneralizedeigenvec-\n\ntorof\nDWxDx,aswellasthatof\nWxDx.Judgingfromthediscreteformulationsofthesethree\ngroupingcriteria,itcanbeseenthatthe\naverageassociation\n,assocA;AjAjassocB;BjBj,hasabiasforfindingtightclusters.\nTherefore,itrunstheriskofbecomingtoogreedyinfinding\nsmall,buttight,clustersinthedata.Thismightbeperfect\n\nfordatathatareGaussiandistributed.However,fortypical\n\ndataintherealworldthataremorelikelytobemadeupof\n\namixtureofvariousdifferenttypesofdistributions,this\n\nbiasingroupingwillhaveundesiredconsequences,aswe\n\nshallillustrateintheexamplesbelow.\nForaveragecut\n,cutA;BjAjcutA;BjBj,theoppositeproblem\narisesonecannotensurethetwopartitionscomputedwill\nhavetightwithin-groupsimilarity.Thisbecomesparticu-\nlarlyproblematicifthedissimilarityamongthedifferent\ngroupsvariesfromonetoanother,orifthereareseveral\npossiblepartitionsallwithsimilar\naveragecut\nvalues.Toillustratethesepoints,letusfirstconsiderasetof\nrandomlydistributeddatain1DshowninFig.13.The1D\n\ndataismadeupbytwosubsetsofpoints,onerandomly\n\ndistributedfrom0to0.5andtheotherfrom0.65to1.0.Each\n\ndatapointistakenasanodeinthegraphandtheweighted\n\ngraphedgeconnectingtwopointsisdefinedtobeinversely\n\nproportionaltothedistancebetweentwonodes.Wewill\nusethreemonotonicallydecreasingweightingfunctions,\nwxfdx,definedonthedistancefunction,\ndx,with\ndifferentrateoffall-off.Thethreeweightingfunctionsare\n\nplottedinFigs.14a,15a,and16a.\nThefirstfunction,\nwxedx0:12,plottedinFig.14a,has\nthefastestdecreasingrateamongthethree.Withthis\nweightingfunction,onlyclose-bypointsareconnected,as\nshowninthegraphweightmatrix\nWplottedinFig.14b.In\nthiscase,\naverageassociation\nfailstofindtherightpartition.\nInstead,itfocusesonfindingsmallclustersineachofthe\ntwomainsubgroups.\nThesecondfunction,\nwx1dx,plottedinFig.15a,\nhastheslowestdecreasingrateamongthethree.Withthis\n\nweightingfunction,mostpointshavesomenontrivial\n\nconnectionstotherest.Tofindacutofthegraph,anumber\n\nofedgeswithheavyweightshavetoberemoved.In\n\naddition,theclusterontherighthaslesswithin-group\n\nsimilaritycomparingwiththeclusterontheleft.Inthis\n\ncase,averagecut\nhastroubledecidingonwheretocut.\nThethirdfunction,\nwxedx0:2,plottedinFig.16a,hasa\nmoderatedecreasingrate.Withthisweightingfunction,the\n\nnearbypointconnectionsarebalancedagainstfar-away\n\npointconnections.Inthiscase,allthreealgorithmsperform\n\nwellwith\nnormalizedcut\n,producingaclearersolutionthan\nthetwoothermethods.\nTheseproblems,illustratedinFigs.14,15,and16,infact\narequitetypicalinsegmentingrealnaturalimages.Thisis\n\nparticularlytrueinthecaseoftexturesegmentation.\n\nDifferenttextureregionsoftenhaveverydifferentwithin-\n\ngroupsimilarityorcoherence.Itisverydifficultto\n\npredeterminetherightweightingfunctiononeachimage\n\nregion.Therefore,itisimportanttodesignagrouping\n\nalgorithmthatismoretoleranttoawiderangeofweighting\n\nfunctions.Theadvantageofusing\nnormalizedcut\nbecomesmoreevidentinthiscase.Fig.17illustratesthispointona\n\nnaturaltextureimageshownpreviouslyinFig.10.\nSHIANDMALIK:NORMALIZEDCUTSANDIMAGESEGMENTATION\n899Fig.12.Relationshipbetween\nnormalizedcut\nandothereigenvector-basedpartitioningtechniques.Comparedtothe\naveragecut\nandaverageassociationformulation,\nnormalizedcut\nseeksabalancebetweenthegoaloffindingclumpsandfindingsplits.\nFig.13.Asetofrandomlydistributedpointsin1D.Thefirst20pointsare\nrandomlydistributedfrom0.0to0.5andtheremaining12pointsare\n\nrandomlydistributedfrom0.65to1.0.Segmentationresultofthese\npointswithdifferentweightingfunctionsareshowninFigs.14,15,and\n16.'b'7CONCLUSIONInthispaper,wedevelopedagroupingalgorithmbasedon\ntheviewthatperceptualgroupingshouldbeaprocessthat\n\naimstoextractglobalimpressionsofasceneandprovidesa\n\nhierarchicaldescriptionofit.Bytreatingthegrouping\nproblemasagraphpartitioningproblem,weproposedthe\nnormalizedcutcriteriaforsegmentingthegraph.Normal-\n\nizedcutisanunbiasedmeasureofdisassociationbetween\n\nsubgroupsofagraphandithasthenicepropertythat\n\nminimizingnormalizedcutleadsdirectlytomaximizingthe\nnormalizedassociation,whichisanunbiasedmeasurefor\ntotalassociationwithinthesubgroups.Infindingan\n\nefficientalgorithmforcomputingtheminimumnormalized\n\ncut,weshowedthatageneralizedeigenvaluesystem\n\nprovidesarealvaluedsolutiontoourproblem.\nAcomputationalmethodbasedonthisideahasbeen\ndevelopedandappliedtosegmentationofbrightness,color,\n\nandtextureimages.Resultsofexperimentsonrealand\n\nsyntheticimagesareveryencouragingandillustratethat\n\nthenormalizedcutcriteriondoesindeedsatisfyourinitial\n\ngoalofextractingthebigpictureofascene.\n900IEEETRANSACTIONSONPATTERNANALYSISANDMACHINEINTELLIGENCE,VOL.22,NO.8,AUGUST2000\nFig.14.Aweightingfunctionwithfastrateoffall-off:\nwxedx0:12,showninsubplot(a)insolidline.Thedottedlinesshowthetwoalternative\nweightingfunctionsusedinFigs.15and16.Subplot(b)showsthecorrespondinggraphweightmatrix\nWW.Thetwocolumns(c)and(d)belowshow\nthefirst,andsecondextremeeigenvectorsfortheNormalizedcut(row1),Averagecut(row2),andAverageassociation(row3).Forboth\nnormalizedcut\nandaveragecut\n,thesmallesteigenvectorisaconstantvectoraspredicted.Inthiscase,both\nnormalizedcut\nandaveragecut\nperformwell,whilethe\naverageassociation\nfailstodotherightthing.Instead,ittriestopickoutisolatedsmallclusters.\n'b'APPENDIXNP-C\nOMPLETENESSPROOFFOR\nNORMALIZEDCUTProposition1[Papadimitrou97].\nNormalizedCut(NCUT)\nforagraphonregulargridsisNP-complete.\nProof.\nWeshallreduceNCUTonregulargridsfrom\nPARTITION:.Givenintegers\nx1;x2;...;xnaddingto\n2k,isthere\nasubsetaddingto\nk?Weconstructaweightedgraphonaregulargridthat\nhasthepropertythatitwillhaveasmallenough\nnormalizedcutifandonlyifwecanfindasubsetfrom\n\nx1;x2;...;xnaddingto\nk.Fig.18ashowsthegraphand\nFig.18bshowstheformthatapartitionthatminimizes\n\nthenormalizedcutmusttake.\nIncomparisontotheintegers\nx1;x2;...;xn,Mismuch\nlarger,M>2k2,and\naismuchsmaller,\n0<a<1=n.We\naskthequestion\nSHIANDMALIK:NORMALIZEDCUTSANDIMAGESEGMENTATION\n901Fig.15.Aweightingfunctionwithslowrateoffall-off:\nwx1dx,showninsubplot(a)insolidline.Thedottedlinesshowthetwoalternative\nweightingfunctionsusedinFigs.14and16.Subplot(b)showsthecorrespondinggraphweightmatrix\nWW.Thetwocolumns(c)and(d)belowshow\nthefirst,andsecondextremeeigenvectorsfortheNormalizedcut(row1),Averagecut(row2),andAverageassociation(row3).Inthiscase,both\nnormalizedcut\nandaverageassociation\ngivetherightpartition,whilethe\naveragecut\nhastroubledecidingonwheretocut.\n'b'.Isthereapartitionwith\nNcut\nvaluelessthan\n4anc1=c,wherecishalfthesumofedgeweightsinthe\ngraph,c2Mn1k3an.Weshallseethatagood\nNcut\npartitionofthegraphmust\nseparatetheleftandrightcolumns.Inparticular,ifand\nonlyifthereisasubset\nS1fx1;...;xmgaddingto\nk,by\ntakingthecorrespondingedgesinthemiddlecolumnto\n\nbeinonesideofthepartition,asillustratedinFig.18b,\nweachievean\nNcut\nvaluelessthan\n4anc1=c.Forallother\npartitions,the\nNcut\nvaluewillbeboundedbelowby\n4anc1=c.First,letusshowthatthecutillustratedinFig.18b,\nwhereeachsidehasasubsetofmiddlecolumnedges\nx1;x2;...;xnthataddupto\nk,doeshave\nNcut\nvalueless\nthan4anc1=c.Letthe\nncutbethe\nNcut\nvalueforthiscut.By\nusingtheformulafor\nNcut\n(2.2),wecanseethat\n902IEEETRANSACTIONSONPATTERNANALYSISANDMACHINEINTELLIGENCE,VOL.22,NO.8,AUGUST2000\nFig.16.Aweightingfunctionwithmediumrateoffall-off:\nwxedx0:2,showninsubplot(a)insolidline.Thedottedlinesshowthetwoalternative\nweightingfunctionsusedinFigs.14and15.Subplot(b)showsthecorrespondinggraphweightmatrix\nWW.Thetwocolumns(c)and(d)belowshow\nthefirstandsecondextremeeigenvectorsfortheNormalizedcut(row1),Averagecut(row2),andaverageassociation(row3).Allthreeofthese\nalgorithmsperformsatisfactorilyinthiscase,with\nnormalizedcut\nproducingaclearersolutionthantheothertwocuts.\n'b'ncut4an2c2an2k114an2c2an2k11;wherecishalfthetotaledgeweightsinthegraph,\nc2Mn1k3an,and\nk1nand1k1narethe\nnumberofedgesfromthemiddlecolumnonthetwo\nsidesofthegraphpartition,\n0<k1<1.Theterm\nan2k11canbeinterpretedastheamountof\nimbalancebetweenthedenominatorsinthetwoterms\ninthe\nNcut\nformulaandliesbetween\n1and1(since0<an<\n1).Simplifying,weseethat\nncut4ancc2an2k112<4ancc214anc1=c:aswastobeshown.\nTocompletetheproofwemustshowthatallother\npartitionsresultina\nNcut\ngreaterthanorequalto\n4anc1=c.Informallyspeaking,whatwillhappenisthateitherthe\nnumeratorsofthetermsinthe\nNcut\nformulathecutbecometoolarge,orthedenominatorsbecomesignifi-\n\ncantlyimbalanced,againincreasingthe\nNcut\nvalue.We\nneedtoconsiderthreecases:\n1.Acutthatdeviatesfromthecutin1(b)slightlyby\nreshufflingsomeofthe\nxiedgessothatthesums\nofthe\nxiineachsubsetofthegraphpartitionare\nnolongerequal.Forsuchcuts,theresulting\nNcut\nvaluesare,atbest,\nncut12ancx2ancx4anc\nc2x2.But,\nsincex1,wehave\nncut14ancc214anc1=c.2.Acutthatgoesthroughanyoftheedgeswith\nweightM.Evenwiththedenominatorsonboth\nsidescompletelybalanced,the\nNcut\nvalue\nncut22Mcisgoingtobelargerthan\n4anc1=c.This\nisensuredbyourchoiceintheconstructionthat\nM>2k2.Wehavetoshowthat\n2Mc4anc1=c;orM2anc2c21:Thisisdirect,since\nan<1byconstruction,\nc2c218180(usingk1,M2,c9).3.Acutthatpartitionsoutsomeofthenodesinthe\nmiddleasonegroup.Weseethatanycutthat\ngoesthroughoneofthe\nxiscanimproveits\nNcut\nvaluebygoingthroughtheedgeswithweight\nainstead.So,wewillfocusonthecasewherethe\n\ncutonlygoesthroughtheweight\naedges.\nSupposethat\nmedgesof\nxisaregroupedinto\noneset,withtotalweightaddingto\nx,where\n1<x<2k.Thecorrespondingncutvalue,\nncut3m4am4am2x4am8Mn14k12an4am2x2amcdm2amcdm;whereSHIANDMALIK:NORMALIZEDCUTSANDIMAGESEGMENTATION\n903Fig.17.NormalizedcutandaverageassociationresultonthezebraimageinFig.10.Subplot(a)showsthesecondlargesteigenvectorof\nWxx,approximatingthenormalizedcutvector.Subplots(b)-(e)showthefirsttofourthlargesteigenvectorsof\nWxx,approximatingthe\naverageassociationvector,usingthesamegraphweightmatrix.Inthisimage,pixelsonthezebrabodyhave,onaverage,lowerdegreeof\n\ncoherencethanthepixelsinthebackground.Theaverageassociation,withitstendencytofindtightclusters,partitionsoutonlysmallclustersin\nthebackground.Thenormalizedcutalgorithm,havingtobalancethegoalofclusteringandsegmentation,findsthebetterpartitioninthiscase.\n'b"dm2Mn1k3an2amx>2Mn1k3an2amxl:Thelowerboundon\nncut3m4amcc2d2misthen\nncutlm4amcc2x2l.Furtherexpansionofthe\nncutlmyieldsncutlm4amcc2x2l4amcc2B2am2;whereB2Mn1k3an4acc2B2m4a2m4aB:Onecanchecktoseethat\nncutlmisanon-\ndecreasingfunctionandhasitsminimumat\n4acc2B24aB4a2whenm1.Inordertoprovethat\nncutlm>4anc1=c,we\nneedtoestablishtheinequality\n4acc2B24aB4a24ancc21or1c2B24aB4a2nc21orc2B24aB4a2nc21or\n4ck4k2n4anc2ka1c2;usingthefactthat\ncB2k.Tocontinue,note\nthat,since\nan<\n1,thiswillbetrueif\n4ck4k2n4c2k4a1c2orif\n4ck24c4k38k4a1c2;sincen<k.Since\n4k38k4a1>0,weonly\nneedtoshowthat\n4ck24c<c2orthat\nc>4k21.Thisissobecause\nc2Mn1k3anandM>2k2.t\nuACKNOWLEDGMENTSThisresearchwassupportedby(ARO)DAAH04-96-1-0341,\nandaNationalScienceFoundationGraduateFellowshipto\nJ.Shi.WethankChristosPapadimitriouforsupplyingthe\nproofofNP-completenessfor\nnormalizedcuts\nonagrid.In\naddition,wewishtoacknowledgeUmeshVaziraniand\n\nAlistairSinclairfordiscussionsongraphtheoreticalgo-\nrithmsandInderjitDhillonandMarkAdamsforuseful\npointerstonumericalpackages.ThomasLeung,Serge\n\nBelongie,YeirWeiss,andothermembersofthecomputer\nvisiongroupatUCBerkeleyprovidedmuchusefulfeed-\nbackonouralgorithm.\nREFERENCES[1]N.Alon,EigenvaluesandExpanders,\nCombinatorica,\nvol.6,no.2,\npp.83-96,1986.\n[2]A.BlakeandA.Zisserman,\nVisualReconstruction.\nMITPress,1987.\n[3]R.B.Boppana,EigenvaluesandGraphBisection:AnAverage-\nCaseAnalysis,\nProc.28thSymp.FoundationsofComputerScience,\npp.280-285,1987.\n[4]J.Cheeger,ALowerBoundfortheSmallestEigenvalueofthe\nLaplacian,\nProblemsinAnalysis,\nR.C.Gunning,ed.,pp.195-199,\nPrincetonUniv.Press,1970.\n[5]F.R.K.Chung,\nSpectralGraphTheory.\nAm.Math.Soc.,1997.\n[6]I.J.Cox,S.B.Rao,andY.Zhong,RatioRegions:ATechniquefor\nImageSegmentation,\nProc.13thInt'lConf.PatternRecognition,\n1996.904IEEETRANSACTIONSONPATTERNANALYSISANDMACHINEINTELLIGENCE,VOL.22,NO.8,AUGUST2000\nFig.18.(a)showsaweightedgraphonaregulargrid.Themissing\nedgesonthegridshaveweightsof0.Incomparisontotheintegers\nx1;x2;...;xn,Misalargenumber(\nM>2k2),and\naisverysmall\nnumber(\n0<a<1=n).(b)showsacutthathasa\nNcut\nvalueless\nthan4anc1=c.Thiscut,whichonlygoesthroughedgeswithweight\nequalto\naorna,hasthepropertythatthe\nxisoneachsideofthe\npartitionsumupto\nk."b"[7]W.E.DonathandA.J.Hoffman,LowerBoundsforthePartition-\ningofGraphs,\nIBMJ.ResearchandDevelopment,\npp.420-425,1973.\n[8]R.VanDriesscheandD.Roose,AnImprovedSpectralBisection\nAlgorithmandItsApplicationtoDynamicLoadBalancing,\n\nParallelComputing,\nvol.21,pp.29-48,1995.\n[9]M.Fiedler,APropertyofEigenvectorsofNonnegativeSym-\nmetricMatricesandItsApplicationstoGraphTheory,\nCzech.Math.J.,\nvol.25,no.100,pp.619-633,1975.\n[10]S.GemanandD.Geman,StochasticRelaxation,GibbsDistribu-\ntions,andtheBayesianRestorationofImages,\nIEEETrans.Pattern\nAnalysisandMachineIntelligence,\nvol.6,pp.721-741,Nov.1984.\n[11]G.H.GolubandC.F.VanLoan,\nMatrixComputations.\nJohn\nHopkinsPress,1989.\n[12]A.K.JainandR.C.Dubes,\nAlgorithmsforClusteringData.\nPrenticeHall,1988.\n[13]K.Fukunaga,S.Yamada,H.S.Stone,andT.Kasai,ARepresenta-\ntionofHypergraphsintheEuclideanSpace,\nIEEETrans.\nComputers,vol.33,no.4,pp.364-367,Apr.1984.\n[14]Y.G.Leclerc,ConstructingSimpleStableDescriptionsforImage\nPartitioning,\nInt'lJ.ComputerVision,\nvol.3,pp.73-102,1989.\n[15]J.Malik,S.Belongie,J.Shi,andT.Leung,Textons,Contoursand\nRegions:CueIntegrationinImageSegmentation,\nProc.Int'lConf.\nComputerVision,\npp.918-925,1999.\n[16]J.MalikandP.Perona,PreattentiveTextureDiscriminationwith\nEarlyVisionMechanisms,\nJ.OpticalSoc.Am.,\nvol.7,no.2,pp.923-\n932,May1990.\n[17]D.MumfordandJ.Shah,OptimalApproximationsbyPiecewise\nSmoothFunctions,andAssociatedVariationalProblems,\nComm.PureMath.,\npp.577-684,1989.\n[18]A.Pothen,H.D.Simon,andK.P.Liou,PartitioningSparse\nMatriceswithEigenvectorsofGraphs,\nSIAMJ.MatrixAnalytical\nApplications,\nvol.11,pp.430-452,1990.\n[19]S.SarkarandK.L.Boyer,QuantitativeMeasuresofChange\nBasedonFeatureOrganization:EigenvaluesandEigenvectors,\n\nProc.IEEEConf.ComputerVisionandPatternRecognition,\n1996.[20]J.ShiandJ.Malik,NormalizedCutsandImageSegmentation,\nProc.IEEEConf.ComputerVisionandPatternRecognition,\npp.731-\n737,1997.\n[21]J.ShiandJ.Malik,MotionSegmentationandTrackingUsing\nNormalizedCuts,\nProc.Int'lConf.ComputerVision,\npp.1,154-\n1,160,1998.\n[22]A.J.SinclairandM.R.Jerrum,ApproximativeCounting,Uniform\nGenerationandRapidlyMixingMarkovChains,\nInformationand\nComputation,\nvol.82,pp.93-133,1989.\n[23]D.A.SpielmanandS.H.Teng,DiskPackingsandPlanar\nSeparators,\nProc.12thACMSymp.ComputationalGeometry,\nMay1996.[24]M.Wertheimer,LawsofOrganizationinPerceptualForms\n(partialtranslation),\nASourcebookofGestaltPsycychology,\nW.B.Ellis,ed.,pp.71-88,Harcourt,Brace,1938.\n[25]Z.WuandR.Leahy,AnOptimalGraphTheoreticApproachto\nDataClustering:TheoryandItsApplicationtoImageSegmenta-\n\ntion,IEEETrans.PatternAnalysisandMachineIntelligence,\nvol.15,\nno.11,pp.1,101-1,113,Nov.1993.\nJianboShi\nstudiedcomputerscienceand\nmathematicsasanundergraduateatCornell\n\nUniversitywhereherecievedhisBAdegreein\n\n1994.HereceivedhisPhDdegreeincomputer\n\nsciencefromtheUniversityofCaliforniaat\nBerkeleyin1998.Since1999,hehasbeena\nmemberofthefacultyoftheRoboticsInstituteat\n\nCarnegieMellonUniversity,wherehisprimary\n\nresearchinterestsincludeimagesegmentation,\n\ngrouping,objectrecognition,motionandshape\nanalysis,andmachinelearning.\nJitendraMalik\nreceivedtheBTechdegreein\nelectricalengineeringfromtheIndianInstituteof\nTechnology,Kanpur,in1980andthePhD\ndegreeincomputersciencefromStanford\n\nUniversityin1986.InJanuary1986,hejoined\n\nthefacultyoftheComputerScienceDivision,\n\nDepartmentofElectricalEngineeringandCom-\n\nputerScienceattheUniversityofCaliforniaat\nBerkeley,whereheiscurrentlyaprofessor.\nDuring1995-1998,healsoservedasvice-chair\nforgraduatematters.HeisamemberoftheCognitiveScienceand\n\nVisionSciencegroupsatUCBerkeley.Hisresearchinterestsarein\n\ncomputervisionandcomputationalmodelingofhumanvision.Hiswork\n\nspansarangeoftopicsinvisionincludingimagesegmentationand\n\ngrouping,texture,image-basedmodelingandrendering,content-based\nimagequerying,andintelligentvehiclehighwaysystems.Hehas\nauthoredorcoauthoredmorethan80researchpapersonthesetopics.\nHereceivedthegoldmedalforthebestgraduatingstudentin\nElectricalEngineeringfromIITKanpurin1980,aPresidentialYoung\n\nInvestigatorAwardin1989,andtheRosenbaumfellowshipforthe\n\nComputerVisionProgrammeattheNewtonInstituteofMathema-\nticalSciences,UniversityofCambridge,in1993.Heisaneditor-in-\nchiefofthe\nInternationalJournalofComputerVision\n.Heisa\nmemberoftheIEEE.\nSHIANDMALIK:NORMALIZEDCUTSANDIMAGESEGMENTATION\n905"