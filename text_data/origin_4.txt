b'P1:***\nInternationalJournalofComputerVisionKL2213-05/5263672January10,200420:17\nUNCORRECTEDPROOF\nInternationalJournalofComputerVision57(2),137154,2004\nc2004KluwerAcademicPublishers.ManufacturedinTheNetherlands.\nRobustReal-TimeFaceDetection\n1PAULVIOLA\n2MicrosoftResearch,OneMicrosoftWay,Redmond,WA98052,USA\n3viola@microsoft.com4MICHAELJ.JONES\n5MitsubishiElectricResearchLaboratory,201Broadway,Cambridge,MA02139,USA\n6mjones@merl.com7ReceivedSeptember10,2001;RevisedJuly10,2003;AcceptedJuly11,2003\n8Abstract.Thispaperdescribesafacedetectionframeworkthatiscapableofprocessingimagesextremelyrapidly\nwhileachievinghighdetectionrates.Therearethreekeycontributions.Therstistheintroductionofanew\n\nimagerepresentationcalledtheIntegralImagewhichallowsthefeaturesusedbyourdetectortobecomputed\n\nveryquickly.ThesecondisasimpleandefcientclassierwhichisbuiltusingtheAdaBoostlearningalgo-\nrithm(FreundandSchapire,1995)toselectasmallnumberofcriticalvisualfeaturesfromaverylargesetof\n\npotentialfeatures.Thethirdcontributionisamethodforcombiningclassiersinacascadewhichallowsback-\n\ngroundregionsoftheimagetobequicklydiscardedwhilespendingmorecomputationonpromisingface-like\n\nregions.Asetofexperimentsinthedomainoffacedetectionispresented.Thesystemyieldsfacedetectionperfor-\n\nmancecomparabletothebestprevioussystems(SungandPoggio,1998;Rowleyetal.,1998;Schneidermanand\n\nKanade,2000;Rothetal.,2000).Implementedonaconventionaldesktop,facedetectionproceedsat15framesper\n\nsecond.910\n11\n12\n13\n14\n15\n16\n17\n18\n19Keywords:\nfacedetection,boosting,humansensing\n201.Introduction\n21Thispaperbringstogethernewalgorithmsandinsights\n22toconstructaframeworkforrobustandextremelyrapid\n23visualdetection.Towardthisendwehaveconstructed\n24afrontalfacedetectionsystemwhichachievesdetec-\n25tionandfalsepositiverateswhichareequivalentto\n26thebestpublishedresults(SungandPoggio,1998;\n27Rowleyetal.,1998;Osunaetal.,1997a;Schneiderman\n28andKanade,2000;Rothetal.,2000).Thisfacedetec-\n29tionsystemismostclearlydistinguishedfromprevi-\n30ousapproachesinitsabilitytodetectfacesextremely\n31rapidly.Operatingon384by288pixelimages,faces\n32aredetectedat15framespersecondonaconventional\n33700MHzIntelPentiumIII.Inotherfacedetection\n34systems,auxiliaryinformation,suchasimagediffer-\n35encesinvideosequences,orpixelcolorincolorim-\n36ages,havebeenusedtoachievehighframerates.Our\n37systemachieveshighframeratesworkingonlywith\n38theinformationpresentinasinglegreyscaleimage.\n39Thesealternativesourcesofinformationcanalsobein-\n40tegratedwithoursystemtoachieveevenhigherframe\n41rates.42Therearethreemaincontributionsofourfacedetec-\n43tionframework.Wewillintroduceeachoftheseideas\n44brieybelowandthendescribethemindetailinsub-\n45sequentsections.\n46Therstcontributionofthispaperisanewimage\n47representationcalledan\nintegralimage\nthatallowsfor\n48veryfastfeatureevaluation.Motivatedinpartbythe\n49workofPapageorgiouetal.(1998)ourdetectionsys-\n50temdoesnotworkdirectlywithimageintensities.Like\n51'b'P1:***\nInternationalJournalofComputerVisionKL2213-05/5263672January10,200420:17\nUNCORRECTEDPROOF\n138ViolaandJones\ntheseauthorsweuseasetoffeatureswhicharerem-\n52iniscentofHaarBasisfunctions(thoughwewillalso\n53userelatedlterswhicharemorecomplexthanHaar\n54lters).Inordertocomputethesefeaturesveryrapidly\n55atmanyscalesweintroducetheintegralimagerepre-\n56sentationforimages(theintegralimageisverysimilar\n57tothesummedareatableusedincomputergraphics\n58(Crow,1984)fortexturemapping).Theintegralim-\n59agecanbecomputedfromanimageusingafewop-\n60erationsperpixel.Oncecomputed,anyoneofthese\n61Haar-likefeaturescanbecomputedatanyscaleorlo-\n62cationin\nconstanttime.63Thesecondcontributionofthispaperisasimple\n64andefcientclassierthatisbuiltbyselectingasmall\n65numberofimportantfeaturesfromahugelibraryofpo-\n66tentialfeaturesusingAdaBoost(FreundandSchapire,\n671995).Withinanyimagesub-windowthetotalnum-\n68berofHaar-likefeaturesisverylarge,farlargerthan\n69thenumberofpixels.Inordertoensurefastclassi-\n70cation,thelearningprocessmustexcludealargema-\n71jorityoftheavailablefeatures,andfocusonasmall\n72setofcriticalfeatures.MotivatedbytheworkofTieu\n73andViola(2000)featureselectionisachievedusing\n74theAdaBoostlearningalgorithmbyconstrainingeach\n75weakclassiertodependononlyasinglefeature.Asa\n76resulteachstageoftheboostingprocess,whichselects\n77anewweakclassier,canbeviewedasafeatureselec-\n78tionprocess.AdaBoostprovidesaneffectivelearning\n79algorithmandstrongboundsongeneralizationperfor-\n80mance(Schapireetal.,1998).\n81Thethirdmajorcontributionofthispaperisamethod\n82forcombiningsuccessivelymorecomplexclassiers\n83inacascadestructurewhichdramaticallyincreasesthe\n84speedofthedetectorbyfocusingattentiononpromis-\n85ingregionsoftheimage.Thenotionbehindfocus\n86ofattentionapproachesisthatitisoftenpossibleto\n87rapidlydeterminewhereinanimageafacemightoc-\n88cur(Tsotsosetal.,1995;Ittietal.,1998;Amitand\n89Geman,1999;FleuretandGeman,2001).Morecom-\n90plexprocessingisreservedonlyforthesepromising\n91regions.Thekeymeasureofsuchanapproachisthe\n92falsenegativerateoftheattentionalprocess.Itmust\n93bethecasethatall,oralmostall,faceinstancesare\n94selectedbytheattentionallter.\n95Wewilldescribeaprocessfortraininganextremely\n96simpleandefcientclassierwhichcanbeusedasa\n97supervisedfocusofattentionoperator.\n1Afacede-\n98tectionattentionaloperatorcanbelearnedwhichwill\n99lteroutover50%oftheimagewhilepreserving99%\n100ofthefaces(asevaluatedoveralargedataset).This\n101lterisexceedinglyefcient;itcanbeevaluatedin20\n102simpleoperationsperlocation/scale(approximately60\n103microprocessorinstructions).\n104Thosesub-windowswhicharenotrejectedbythe\n105initialclassierareprocessedbyasequenceofclassi-\n106ers,eachslightlymorecomplexthanthelast.Ifany\n107classierrejectsthesub-window,nofurtherprocessing\n108isperformed.Thestructureofthecascadeddetection\n109processisessentiallythatofadegeneratedecisiontree,\n110andassuchisrelatedtotheworkofFleuretandGeman\n111(2001)andAmitandGeman(1999).\n112Thecompletefacedetectioncascadehas38classi-\n113ers,whichtotalover80,000operations.Nevertheless\n114thecascadestructureresultsinextremelyrapidaverage\n115detectiontimes.Onadifcultdataset,containing507\n116facesand75millionsub-windows,facesaredetected\n117usinganaverageof270microprocessorinstructions\n118persub-window.Incomparison,thissystemisabout\n11915timesfasterthananimplementationofthedetection\n120systemconstructedbyRowleyetal.(1998).\n2121Anextremelyfastfacedetectorwillhavebroadprac-\n122ticalapplications.Theseincludeuserinterfaces,im-\n123agedatabases,andteleconferencing.Thisincreasein\n124speedwillenablereal-timefacedetectionapplications\n125onsystemswheretheywerepreviouslyinfeasible.In\n126applicationswhererapidframe-ratesarenotnecessary,\n127oursystemwillallowforsignicantadditionalpost-\n128processingandanalysis.Inadditionoursystemcanbe\n129implementedonawiderangeofsmalllowpowerde-\n130vices,includinghand-heldsandembeddedprocessors.\n131Inourlabwehaveimplementedthisfacedetectorona\n132lowpower200mips\nStrongArm\nprocessorwhichlacks\n133oatingpointhardwareandhaveachieveddetectionat\n134twoframespersecond.\n1351.1.Overview\n136Theremainingsectionsofthepaperwilldiscussthe\n137implementationofthedetector,relatedtheory,andex-\n138periments.Section2willdetailtheformofthefeatures\n139aswellasanewschemeforcomputingthemrapidly.\n140Section3willdiscussthemethodinwhichthesefea-\n141turesarecombinedtoformaclassier.Themachine\n142learningmethodused,aapplicationofAdaBoost,also\n143actsasafeatureselectionmechanism.Whiletheclassi-\n144ersthatareconstructedinthiswayhavegoodcompu-\n145tationalandclassicationperformance,theyarefartoo\n146slowforareal-timeclassier.Section4willdescribea\n147methodforconstructingacascadeofclassierswhich\n148'b'P1:***\nInternationalJournalofComputerVisionKL2213-05/5263672January10,200420:17\nUNCORRECTEDPROOF\nRobustReal-TimeFaceDetection139\ntogetheryieldanextremelyreliableandefcientface\n149detector.Section5willdescribeanumberofexperi-\n150mentalresults,includingadetaileddescriptionofour\n151experimentalmethodology.FinallySection6contains\n152adiscussionofthissystemanditsrelationshiptore-\n153latedsystems.\n1542.Features\n155Ourfacedetectionprocedureclassiesimagesbased\n156onthevalueofsimplefeatures.Therearemanymoti-\n157vationsforusingfeaturesratherthanthepixelsdirectly.\n158Themostcommonreasonisthatfeaturescanacttoen-\n159codead-hocdomainknowledgethatisdifculttolearn\n160usinganitequantityoftrainingdata.Forthissystem\n161thereisalsoasecondcriticalmotivationforfeatures:\n162thefeature-basedsystemoperatesmuchfasterthana\n163pixel-basedsystem.\n164ThesimplefeaturesusedarereminiscentofHaar\n165basisfunctionswhichhavebeenusedbyPapageorgiou\n166etal.(1998).Morespecically,weusethreekindsof\n167features.Thevalueofa\ntwo-rectanglefeature\nisthe\n168differencebetweenthesumofthepixelswithintwo\n169rectangularregions.Theregionshavethesamesize\n170andshapeandarehorizontallyorverticallyadjacent\n171(seeFig.1).A\nthree-rectanglefeature\ncomputesthe\n172sumwithintwooutsiderectanglessubtractedfromthe\n173suminacenterrectangle.Finallya\nfour-rectanglefea-\n174ture\ncomputesthedifferencebetweendiagonalpairsof\n175rectangles.176Giventhatthebaseresolutionofthedetectoris\n1772424,theexhaustivesetofrectanglefeaturesis\n178Figure1\n.Examplerectanglefeaturesshownrelativetotheenclos-\ningdetectionwindow.Thesumofthepixelswhichliewithinthe\n\nwhiterectanglesaresubtractedfromthesumofpixelsinthegrey\n\nrectangles.Two-rectanglefeaturesareshownin(A)and(B).Figure\n\n(C)showsathree-rectanglefeature,and(D)afour-rectanglefeature.\nquitelarge,160,000.NotethatunliketheHaarbasis,\n179thesetofrectanglefeaturesisovercomplete.\n31802.1.IntegralImage\n181Rectanglefeaturescanbecomputedveryrapidlyusing\n182anintermediaterepresentationfortheimagewhichwe\n183calltheintegralimage.\n4Theintegralimageatlocation\n184x,ycontainsthesumofthepixelsaboveandtotheleft\n185ofx,y,inclusive:\n186ii(x,y)=xx,yyi(x,y),whereii(x,y)istheintegralimageand\ni(x,y)is\nthe187originalimage(seeFig.2).Usingthefollowingpairof\n188recurrences:189s(x,y)=s(x,y1)+i(x,y)(1)ii(x,y)=ii(x1,y)+s(x,y)(2)(wheres(x,y)isthecumulativerowsum,\ns(x,1)=1900,and\nii(1,y)=0)theintegralimagecanbecom-\n191putedinonepassovertheoriginalimage.\n192Usingtheintegralimageanyrectangularsumcanbe\n193computedinfourarrayreferences(seeFig.3).Clearly\n194thedifferencebetweentworectangularsumscanbe\n195computedineightreferences.Sincethetwo-rectangle\n196featuresdenedaboveinvolveadjacentrectangular\n197sumstheycanbecomputedinsixarrayreferences,\n198eightinthecaseofthethree-rectanglefeatures,and\n199nineforfour-rectanglefeatures.\n200Onealternativemotivationfortheintegralim-\n201agecomesfromtheboxletsworkofSimardetal.\n202Figure2\n.Thevalueoftheintegralimageatpoint(\nx,y)is\nthesum\nofallthepixelsaboveandtotheleft.\n'b'P1:***\nInternationalJournalofComputerVisionKL2213-05/5263672January10,200420:17\nUNCORRECTEDPROOF\n140ViolaandJones\nFigure3\n.Thesumofthepixelswithinrectangle\nDcanbecomputed\nwithfourarrayreferences.Thevalueoftheintegralimageatlocation\n\n1isthesumofthepixelsinrectangle\nA.Thevalueatlocation2is\nA+B,atlocation3is\nA+C,andatlocation4is\nA+B+C+D.Thesumwithin\nDcanbecomputedas4\n+1(2+3).(1999).Theauthorspointoutthatinthecaseoflinear\n203operations(e.g.\nfg),anyinvertiblelinearoperation\n204canbeappliedto\nforgifitsinverseisappliedtothe\n205result.Forexampleinthecaseofconvolution,ifthe\n206derivativeoperatorisappliedbothtotheimageandthe\n207kerneltheresultmustthenbedoubleintegrated:\n208fg=(fg).Theauthorsgoontoshowthatconvolutioncanbe\n209signicantlyacceleratedifthederivativesof\nfandg210aresparse(orcanbemadeso).Asimilarinsightisthat\n211aninvertiblelinearoperationcanbeappliedto\nfifits\n212inverseisappliedto\ng:213(f)g=fg.Viewedinthisframeworkcomputationoftherect-\n214anglesumcanbeexpressedasadotproduct,\nir,where215iistheimageand\nristheboxcarimage(withvalue\n2161withintherectangleofinterestand0outside).This\n217operationcanberewritten\n218ir=ir.Theintegralimageisinfactthedoubleintegralofthe\n219image(rstalongrowsandthenalongcolumns).The\n220secondderivativeoftherectangle(rstinrowandthen\n221incolumn)yieldsfourdeltafunctionsatthecornersof\n222therectangle.Evaluationoftheseconddotproductis\n223accomplishedwithfourarrayaccesses.\n2242.2.FeatureDiscussion\n225Rectanglefeaturesaresomewhatprimitivewhen\n226comparedwithalternativessuchassteerablelters\n227(FreemanandAdelson,1991;Greenspanetal.,1994).\n228Steerablelters,andtheirrelatives,areexcellentforthe\n229detailedanalysisofboundaries,imagecompression,\n230andtextureanalysis.Whilerectanglefeaturesarealso\n231sensitivetothepresenceofedges,bars,andothersim-\n232pleimagestructure,theyarequitecoarse.Unlikesteer-\n233ablelters,theonlyorientationsavailablearevertical,\n234horizontalanddiagonal.Sinceorthogonalityisnotcen-\n235traltothisfeatureset,wechoosetogenerateavery\n236largeandvariedsetofrectanglefeatures.Typicallythe\n237representationisabout400timesovercomplete.This\n238overcompletesetprovidesfeaturesofarbitraryaspect\n239ratioandofnelysampledlocation.Empiricallyitap-\n240pearsasthoughthesetofrectanglefeaturesprovide\n241arichimagerepresentationwhichsupportseffective\n242learning.Theextremecomputationalefciencyofrect-\n243anglefeaturesprovidesamplecompensationfortheir\n244limitations.245Inordertoappreciatethecomputationaladvantage\n246oftheintegralimagetechnique,consideramorecon-\n247ventionalapproachinwhichapyramidofimagesis\n248computed.Likemostfacedetectionsystems,ourde-\n249tectorscanstheinputatmanyscales;startingatthe\n250basescaleinwhichfacesaredetectedatasizeof\n2512424pixels,a384by288pixelimageisscanned\n252at12scaleseachafactorof1.25largerthanthelast.\n253Theconventionalapproachistocomputeapyramidof\n25412images,each1.25timessmallerthantheprevious\n255image.Axedscaledetectoristhenscannedacross\n256eachoftheseimages.Computationofthepyramid,\n257whilestraightforward,requiressignicanttime.Imple-\n258mentedefcientlyonconventionalhardware(usingbi-\n259linearinterpolationtoscaleeachlevelofthepyramid)it\n260takesaround.05secondstocomputea12levelpyramid\n261ofthissize(onanIntelPIII700MHzprocessor).\n5262Incontrastwehavedenedameaningfulsetofrect-\n263anglefeatures,whichhavethepropertythatasingle\n264featurecanbeevaluatedatanyscaleandlocationina\n265fewoperations.WewillshowinSection4thateffec-\n266tivefacedetectorscanbeconstructedwithasfewas\ntwo267rectanglefeatures.Giventhecomputationalefciency\n268ofthesefeatures,thefacedetectionprocesscanbecom-\n269pletedforanentireimageateveryscaleat15framesper\n270'b'P1:***\nInternationalJournalofComputerVisionKL2213-05/5263672January10,200420:17\nUNCORRECTEDPROOF\nRobustReal-TimeFaceDetection141\nsecond,aboutthesametimerequiredtoevaluatethe12\n271levelimagepyramidalone.Anyprocedurewhichre-\n272quiresapyramidofthistypewillnecessarilyrunslower\n273thanourdetector.\n2743.LearningClassicationFunctions\n275Givenafeaturesetandatrainingsetofpositiveand\n276negativeimages,anynumberofmachinelearningap-\n277proachescouldbeusedtolearnaclassicationfunc-\n278tion.SungandPoggiouseamixtureofGaussianmodel\n279(SungandPoggio,1998).Rowleyetal.(1998)usea\n280smallsetofsimpleimagefeaturesandaneuralnet-\n281work.Osunaetal.(1997b)usedasupportvectorma-\n282chine.MorerecentlyRothetal.(2000)haveproposed\n283anewandunusualimagerepresentationandhaveused\n284theWinnowlearningprocedure.\n285Recallthatthereare160,000rectanglefeaturesas-\n286sociatedwitheachimagesub-window,anumberfar\n287largerthanthenumberofpixels.Eventhougheach\n288featurecanbecomputedveryefciently,computing\n289thecompletesetisprohibitivelyexpensive.Ourhy-\n290pothesis,whichisborneoutbyexperiment,isthata\n291verysmallnumberofthesefeaturescanbecombined\n292toformaneffectiveclassier.Themainchallengeisto\n293ndthesefeatures.\n294InoursystemavariantofAdaBoostisusedboth\n295toselectthefeaturesandtotraintheclassier(Freund\n296andSchapire,1995).Initsoriginalform,theAdaBoost\n297learningalgorithmisusedtoboosttheclassication\n298performanceofasimplelearningalgorithm(e.g.,it\n299mightbeusedtoboosttheperformanceofasimpleper-\n300ceptron).Itdoesthisbycombiningacollectionofweak\n301classicationfunctionstoformastrongerclassier.In\n302thelanguageofboostingthesimplelearningalgorithm\n303iscalledaweaklearner.So,forexamplethepercep-\n304tronlearningalgorithmsearchesoverthesetofpossible\n305perceptronsandreturnstheperceptronwiththelowest\n306classicationerror.Thelearneriscalledweakbecause\n307wedonotexpecteventhebestclassicationfunctionto\n308classifythetrainingdatawell(i.e.foragivenproblem\n309thebestperceptronmayonlyclassifythetrainingdata\n310correctly51%ofthetime).Inorderfortheweaklearner\n311tobeboosted,itiscalledupontosolveasequenceof\n312learningproblems.Aftertherstroundoflearning,the\n313examplesarere-weightedinordertoemphasizethose\n314whichwereincorrectlyclassiedbythepreviousweak\n315classier.Thenalstrongclassiertakestheformofa\n316perceptron,aweightedcombinationofweakclassiers\n317followedbyathreshold.\n6318TheformalguaranteesprovidedbytheAdaBoost\n319learningprocedurearequitestrong.Freundand\n320Schapireprovedthatthetrainingerrorofthestrong\n321classierapproacheszeroexponentiallyinthenumber\n322ofrounds.Moreimportantlyanumberofresults\n323werelaterprovedaboutgeneralizationperformance\n324(Schapireetal.,1997).Thekeyinsightisthatgen-\n325eralizationperformanceisrelatedtothemarginofthe\n326examples,andthatAdaBoostachieveslargemargins\n327rapidly.\n328TheconventionalAdaBoostprocedurecanbeeas-\n329ilyinterpretedasagreedyfeatureselectionprocess.\n330Considerthegeneralproblemofboosting,inwhicha\n331largesetofclassicationfunctionsarecombinedusing\n332aweightedmajorityvote.Thechallengeistoassociate\n333alargeweightwitheachgoodclassicationfunction\n334andasmallerweightwithpoorfunctions.AdaBoostis\n335anaggressivemechanismforselectingasmallsetof\n336goodclassicationfunctionswhichneverthelesshave\n337signicantvariety.Drawingananalogybetweenweak\n338classiersandfeatures,AdaBoostisaneffectivepro-\n339cedureforsearchingoutasmallnumberofgoodfea-\n340tureswhichneverthelesshavesignicantvariety.\n341Onepracticalmethodforcompletingthisanalogyis\n342torestricttheweaklearnertothesetofclassication\n343functionseachofwhichdependonasinglefeature.\n344Insupportofthisgoal,theweaklearningalgorithmis\n345designedtoselectthesinglerectanglefeaturewhich\n346bestseparatesthepositiveandnegativeexamples(this\n347issimilartotheapproachofTieuandViola(2000)in\n348thedomainofimagedatabaseretrieval).Foreachfea-\n349ture,theweaklearnerdeterminestheoptimalthreshold\n350classicationfunction,suchthattheminimumnum-\n351berofexamplesaremisclassied.Aweakclassier\n352(h(x,f,p))thusconsistsofafeature(\nf),athresh-\n353old(\n)andapolarity(\np)indicatingthedirectionofthe\n354inequality:355h(x,f,p)=1if\npf(x)<p0otherwiseHerexisa24\n24pixelsub-windowofanimage.\n356Inpracticenosinglefeaturecanperformtheclassi-\n357cationtaskwithlowerror.Featureswhichareselected\n358earlyintheprocessyielderrorratesbetween0.1and\n3590.3.Featuresselectedinlaterrounds,asthetaskbe-\n360comesmoredifcult,yielderrorratesbetween0.4and\n3610.5.Table1showsthelearningalgorithm.\n362Theweakclassiersthatweuse(thresholdedsingle\n363features)canbeviewedassinglenodedecisiontrees.\n364'b'P1:***\nInternationalJournalofComputerVisionKL2213-05/5263672January10,200420:17\nUNCORRECTEDPROOF\n142ViolaandJones\nTable1\n.Theboostingalgorithmforlearningaqueryonline.\nThypothesesareconstructedeachusingasinglefeature.The\nnalhypothesisisaweightedlinearcombinationofthe\nThy-potheseswheretheweightsareinverselyproportionaltothe\n\ntrainingerrors.\nGivenexampleimages(\nx1,y1),...,(xn,yn)whereyi=0,1fornegativeandpositiveexamplesrespectively.\nInitializeweights\nw1,i=12m,12lforyi=0,1respectively,\nwheremandlarethenumberofnegativesandpositives\nrespectively.\nFor\nt=1,...,T:1.Normalizetheweights,\nwt,iwt,inj=1wt,j2.Selectthebestweakclassierwithrespecttothe\nweightederror\nt=minf,piwi|h(xi,f,p)yi|.SeeSection3.1foradiscussionofanefcient\nimplementation.3.Dene\nht(x)=h(x,ft,ptt)whereft,pt,andtaretheminimizersof\nt.4.Updatetheweights:\nwt+1,i=wt,i1eitwhereei=0ifexamplexiisclassiedcorrectly,\nei=1otherwise,and\nt=t1t.Thenalstrongclassieris:\nC(x)=1Tt=1tht(x)12Tt=1t0otherwisewheret=log1tSuchstructureshavebeencalleddecisionstumpsin\n365themachinelearningliterature.Theoriginalworkof\n366FreundandSchapire(1995)alsoexperimentedwith\n367boostingdecisionstumps.\n3683.1.LearningDiscussion\n369ThealgorithmdescribedinTable1isusedtoselectkey\n370weakclassiersfromthesetofpossibleweakclassi-\n371ers.WhiletheAdaBoostprocessisquiteefcient,the\n372setofweakclassierisextraodinarilylarge.Sincethere\n373isoneweakclassierforeachdistinctfeature/threshold\n374combination,thereareeffectively\nKNweakclassiers,\n375whereKisthenumberoffeaturesand\nNisthenum-\n376berofexamples.Inordertoappreciatethedependency\n377onN,supposethattheexamplesaresortedbyagiven\n378featurevalue.Withrespecttothetrainingprocessany\n379twothresholdsthatliebetweenthesamepairofsorted\n380examplesisequivalent.Thereforethetotalnumberof\n381distinctthresholdsis\nN.Givenataskwith\nN=20000382andK=160000thereare3.2billiondistinctbinary\n383weakclassiers.\n384Thewrappermethodcanalsobeusedtolearnaper-\n385ceptronwhichutilizes\nMweakclassiers(Johnetal.,\n3861994)Thewrappermethodalsoproceedsincremen-\n387tallybyaddingoneweakclassiertotheperceptronin\n388eachround.Theweakclassieraddedistheonewhich\n389whenaddedtothecurrentsetyieldsaperceptronwith\n390lowesterror.Eachroundtakesatleast\nO(NKN)(or60\n391Trillionoperations);thetimetoenumerateallbinary\n392featuresandevaluateeachexampleusingthatfeature.\n393Thisneglectsthetimetolearntheperceptronweights.\n394Evenso,thenalworktolearna200featureclassi-\n395erwouldbesomethinglike\nO(MNKN)whichis10\n16396operations.397ThekeyadvantageofAdaBoostasafeatureselec-\n398tionmechanism,overcompetitorssuchasthewrapper\n399method,isthespeedoflearning.UsingAdaBoosta\n400200featureclassiercanbelearnedin\nO(MNK)or\n401about10\n11operations.Onekeyadvantageisthatin\n402eachroundtheentiredependenceonpreviouslyse-\n403lectedfeaturesisefcientlyandcompactlyencoded\n404usingtheexampleweights.Theseweightscanthenbe\n405usedtoevaluateagivenweakclassierinconstanttime.\n406Theweakclassierselectionalgorithmproceedsas\n407follows.Foreachfeature,theexamplesaresortedbased\n408onfeaturevalue.TheAdaBoostoptimalthresholdfor\n409thatfeaturecanthenbecomputedinasinglepassover\n410thissortedlist.Foreachelementinthesortedlist,four\n411sumsaremaintainedandevaluated:thetotalsumof\n412positiveexampleweights\nT+,thetotalsumofnegative\n413exampleweights\nT,thesumofpositiveweightsbelow\n414thecurrentexample\nS+andthesumofnegativeweights\n415belowthecurrentexample\nS.Theerrorforathreshold\n416whichsplitstherangebetweenthecurrentandprevious\n417exampleinthesortedlistis:\n418e=minS++(TS),S+(T+S+,ortheminimumoftheerroroflabelingallexamples\n419belowthecurrentexamplenegativeandlabelingtheex-\n420amplesabovepositiveversustheerroroftheconverse.\n421Thesesumsareeasilyupdatedasthesearchproceeds.\n422Manygeneralfeatureselectionprocedureshavebeen\n423proposed(seechapter8ofWebb(1999)forareview).\n424Ournalapplicationdemandedaveryaggressivepro-\n425cesswhichwoulddiscardthevastmajorityoffeatures.\n426ForasimilarrecognitionproblemPapageorgiouetal.\n427(1998)proposedaschemeforfeatureselectionbased\n428'b'P1:***\nInternationalJournalofComputerVisionKL2213-05/5263672January10,200420:17\nUNCORRECTEDPROOF\nRobustReal-TimeFaceDetection143\nonfeaturevariance.Theydemonstratedgoodresultsse-\n429lecting37featuresoutofatotal1734features.While\n430thisisasignicantreduction,thenumberoffeatures\n431evaluatedforeveryimagesub-windowisstillreason-\n432ablylarge.\n433Rothetal.(2000)proposeafeatureselectionprocess\n434basedontheWinnowexponentialperceptronlearning\n435rule.Theseauthorsuseaverylargeandunusualfeature\n436set,where\neachpixel\nismappedintoabinaryvectorof\nd437dimensions(whenaparticularpixeltakesonthevalue\n438x,intherange[0\n,d1],the\nx-thdimensionissetto\n4391andtheotherdimensionsto0).Thebinaryvectors\n440foreachpixelareconcatenatedtoformasinglebinary\n441vectorwith\nnddimensions(\nnisthenumberofpixels).\n442Theclassicationruleisaperceptron,whichassigns\n443oneweighttoeachdimensionoftheinputvector.The\n444Winnowlearningprocessconvergestoasolutionwhere\n445manyoftheseweightsarezero.Neverthelessavery\n446largenumberoffeaturesareretained(perhapsafew\n447hundredorthousand).\n4483.2.LearningResults\n449Whiledetailsonthetrainingandperformanceofthe\n450nalsystemarepresentedinSection5,severalsim-\n451pleresultsmeritdiscussion.Initialexperimentsdemon-\nFigure4\n.Receiveroperatingcharacteristic(ROC)curveforthe200featureclassier.\nstratedthataclassierconstructedfrom200features\n452wouldyieldreasonableresults(seeFig.4).Givena\n453detectionrateof95%theclassieryieldedafalsepos-\n454itiverateof1in14084onatestingdataset.Thisis\n455promising,butforafacedetectortobepracticalfor\n456realapplications,thefalsepositiveratemustbecloser\n457to1in1,000,000.\n458Forthetaskoffacedetection,theinitialrectangle\n459featuresselectedbyAdaBoostaremeaningfulandeas-\n460ilyinterpreted.Therstfeatureselectedseemstofocus\n461onthepropertythattheregionoftheeyesisoftendarker\n462thantheregionofthenoseandcheeks(seeFig.5).This\n463featureisrelativelylargeincomparisonwiththedetec-\n464tionsub-window,andshouldbesomewhatinsensitive\n465tosizeandlocationoftheface.Thesecondfeaturese-\n466lectedreliesonthepropertythattheeyesaredarker\n467thanthebridgeofthenose.\n468Insummarythe200-featureclassierprovidesini-\n469tialevidencethataboostedclassierconstructedfrom\n470rectanglefeaturesisaneffectivetechniqueforfacede-\n471tection.Intermsofdetection,theseresultsarecom-\n472pellingbutnotsufcientformanyreal-worldtasks.In\n473termsofcomputation,thisclassierisveryfast,re-\n474quiring0.7secondstoscanan384by288pixelim-\n475age.Unfortunately,themoststraightforwardtech-\n476niqueforimprovingdetectionperformance,adding\n'b'P1:***\nInternationalJournalofComputerVisionKL2213-05/5263672January10,200420:17\nUNCORRECTEDPROOF\n144ViolaandJones\nFigure5\n.TherstandsecondfeaturesselectedbyAdaBoost.The\ntwofeaturesareshowninthetoprowandthenoverlayedonatyp-\n\nicaltrainingfaceinthebottomrow.Therstfeaturemeasuresthe\n\ndifferenceinintensitybetweentheregionoftheeyesandaregion\n\nacrosstheuppercheeks.Thefeaturecapitalizesontheobservation\n\nthattheeyeregionisoftendarkerthanthecheeks.Thesecondfeature\n\ncomparestheintensitiesintheeyeregionstotheintensityacrossthe\n\nbridgeofthenose.\nfeaturestotheclassier,directlyincreasescomputation\n477time.4784.TheAttentionalCascade\n479Thissectiondescribesanalgorithmforconstructinga\n480cascadeofclassierswhichachievesincreaseddetec-\n481tionperformancewhileradicallyreducingcomputation\n482time.Thekeyinsightisthatsmaller,andthereforemore\n483efcient,boostedclassierscanbeconstructedwhich\n484rejectmanyofthenegativesub-windowswhiledetect-\n485ingalmostallpositiveinstances.Simplerclassiersare\n486usedtorejectthemajorityofsub-windowsbeforemore\n487complexclassiersarecalledupontoachievelowfalse\n488positiverates.\n489Stagesinthecascadeareconstructedbytraining\n490classiersusingAdaBoost.Startingwithatwo-feature\n491strongclassier,aneffectivefaceltercanbeobtained\n492byadjustingthestrongclassierthresholdtomini-\n493mizefalsenegatives.TheinitialAdaBoostthreshold,\n49412Tt=1t,isdesignedtoyieldalowerrorrateonthe\n495trainingdata.Alowerthresholdyieldshigherdetec-\n496tionratesandhigherfalsepositiverates.Basedonper-\n497formancemeasuredusingavalidationtrainingset,the\n498two-featureclassiercanbeadjustedtodetect100%of\n499thefaceswithafalsepositiverateof50%.SeeFig.5for\n500adescriptionofthetwofeaturesusedinthisclassier.\n501Thedetectionperformanceofthetwo-featureclas-\n502sierisfarfromacceptableasafacedetectionsystem.\n503Neverthelesstheclassiercansignicantlyreducethe\n504numberofsub-windowsthatneedfurtherprocessing\n505withveryfewoperations:\n5061.Evaluatetherectanglefeatures(requiresbetween6\n507and9arrayreferencesperfeature).\n5082.Computetheweakclassierforeachfeature(re-\n509quiresonethresholdoperationperfeature).\n5103.Combinetheweakclassiers(requiresonemultiply\n511perfeature,anaddition,andnallyathreshold).\n512Atwofeatureclassieramountstoabout60mi-\n513croprocessorinstructions.Itseemshardtoimagine\n514thatanysimplerltercouldachievehigherrejection\n515rates.Bycomparison,scanningasimpleimagetem-\n516platewouldrequireatleast20timesasmanyoperations\n517persub-window.\n518Theoverallformofthedetectionprocessisthatof\n519adegeneratedecisiontree,whatwecallacascade\n520(Quinlan,1986)(seeFig.6).Apositiveresultfrom\n521therstclassiertriggerstheevaluationofasecond\n522classierwhichhasalsobeenadjustedtoachievevery\n523highdetectionrates.Apositiveresultfromthesecond\n524classiertriggersathirdclassier,andsoon.Anegative\n525outcomeatanypointleadstotheimmediaterejection\n526ofthesub-window.\n527Thestructureofthecascadereectsthefactthat\n528withinanysingleimageanoverwhelmingmajorityof\n529sub-windowsarenegative.Assuch,thecascadeat-\n530temptstorejectasmanynegativesaspossibleatthe\n531earlieststagepossible.Whileapositiveinstancewill\n532Figure6\n.Schematicdepictionofathedetectioncascade.Aseries\nofclassiersareappliedtoeverysub-window.Theinitialclassier\n\neliminatesalargenumberofnegativeexampleswithverylittlepro-\n\ncessing.Subsequentlayerseliminateadditionalnegativesbutrequire\n\nadditionalcomputation.Afterseveralstagesofprocessingthenum-\n\nberofsub-windowshavebeenreducedradically.Furtherprocessing\n\ncantakeanyformsuchasadditionalstagesofthecascade(asinour\n\ndetectionsystem)oranalternativedetectionsystem.\n'b'P1:***\nInternationalJournalofComputerVisionKL2213-05/5263672January10,200420:17\nUNCORRECTEDPROOF\nRobustReal-TimeFaceDetection145\ntriggertheevaluationofeveryclassierinthecascade,\n533thisisanexceedinglyrareevent.\n534Muchlikeadecisiontree,subsequentclassiersare\n535trainedusingthoseexampleswhichpassthroughall\n536thepreviousstages.Asaresult,thesecondclassier\n537facesamoredifculttaskthantherst.Theexamples\n538whichmakeitthroughtherststageareharderthan\n539typicalexamples.Themoredifcultexamplesfaced\n540bydeeperclassierspushtheentirereceiveroperat-\n541ingcharacteristic(ROC)curvedownward.Atagiven\n542detectionrate,deeperclassiershavecorrespondingly\n543higherfalsepositiverates.\n5444.1.TrainingaCascadeofClassiers\n545Thecascadedesignprocessisdrivenfromasetofde-\n546tectionandperformancegoals.Forthefacedetection\n547task,pastsystemshaveachievedgooddetectionrates\n548(between85and95percent)andextremelylowfalse\n549positiverates(ontheorderof10\n5or10\n6).Thenum-\n550berofcascadestagesandthesizeofeachstagemust\n551besufcienttoachievesimilardetectionperformance\n552whileminimizingcomputation.\n553Givenatrainedcascadeofclassiers,thefalsepos-\n554itiverateofthecascadeis\n555F=Ki=1fi,whereFisthefalsepositiverateofthecascadedclas-\n556sier,\nKisthenumberofclassiers,and\nfiisthefalse\n557positiverateofthe\nithclassierontheexamplesthat\n558getthroughtoit.Thedetectionrateis\n559D=Ki=1di,whereDisthedetectionrateofthecascadedclassier,\n560Kisthenumberofclassiers,and\ndiisthedetection\n561rateofthe\nithclassierontheexamplesthatgetthrough\n562toit.\n563Givenconcretegoalsforoverallfalsepositiveand\n564detectionrates,targetratescanbedeterminedforeach\n565stageinthecascadeprocess.Forexampleadetection\n566rateof0\n.9canbeachievedbya10stageclassierif\n567eachstagehasadetectionrateof0.99(since0\n.95680.9910).Whileachievingthisdetectionratemaysound\n569likeadauntingtask,itismadesignicantlyeasierbythe\n570factthateachstageneedonlyachieveafalsepositive\n571rateofabout30%(0\n.30106106).572Thenumberoffeaturesevaluatedwhenscanning\n573realimagesisnecessarilyaprobabilisticprocess.Any\n574givensub-windowwillprogressdownthroughthecas-\n575cade,oneclassieratatime,untilitisdecidedthat\n576thewindowisnegativeor,inrarecircumstances,the\n577windowsucceedsineachtestandislabelledpositive.\n578Theexpectedbehaviorofthisprocessisdetermined\n579bythedistributionofimagewindowsinatypicaltest\n580set.Thekeymeasureofeachclassierisitspositive\n581rate,theproportionofwindowswhicharelabelledas\n582potentiallycontainingaface.Theexpectednumberof\n583featureswhichareevaluatedis:\n584N=n0+Ki=1nij<ipjwhereNistheexpectednumberoffeaturesevaluated,\n585Kisthenumberofclassiers,\npiisthepositiverateof\n586theithclassier,and\nniarethenumberoffeaturesinthe\n587ithclassier.Interestingly,sincefacesareextremely\n588rare,thepositiverateiseffectivelyequaltothefalse\n589positiverate.\n590Theprocessbywhicheachelementofthecascade\n591istrainedrequiressomecare.TheAdaBoostlearning\n592procedurepresentedinSection3attemptsonlytomin-\n593imizeerrors,andisnotspecicallydesignedtoachieve\n594highdetectionratesattheexpenseoflargefalsepositive\n595rates.Onesimple,andveryconventional,schemefor\n596tradingofftheseerrorsistoadjustthethresholdofthe\n597perceptronproducedbyAdaBoost.Higherthresholds\n598yieldclassierswithfewerfalsepositivesandalower\n599detectionrate.Lowerthresholdsyieldclassierswith\n600morefalsepositivesandahigherdetectionrate.Itis\n601notclear,atthispoint,whetheradjustingthethreshold\n602inthiswaypreservesthetrainingandgeneralization\n603guaranteesprovidedbyAdaBoost.\n604Theoveralltrainingprocessinvolvestwotypesof\n605tradeoffs.Inmostcasesclassierswithmorefeatures\n606willachievehigherdetectionratesandlowerfalsepos-\n607itiverates.Atthesametimeclassierswithmorefea-\n608turesrequiremoretimetocompute.Inprincipleone\n609coulddeneanoptimizationframeworkinwhich\n610thenumberofclassierstages,\n611thenumberoffeatures,\nni,ofeachstage,\n612thethresholdofeachstage\n613aretradedoffinordertominimizetheexpectednum-\n614beroffeatures\nNgivenatargetfor\nFandD.Unfortu-615natelyndingthisoptimumisatremendouslydifcult\n616problem.617'b'P1:***\nInternationalJournalofComputerVisionKL2213-05/5263672January10,200420:17\nUNCORRECTEDPROOF\n146ViolaandJones\nTable2\n.Thetrainingalgorithmforbuildingacascadeddetector.\nUserselectsvaluesfor\nf,themaximumacceptablefalse\npositiverateperlayerand\nd,theminimumacceptabledetection\nrateperlayer.\nUserselectstargetoverallfalsepositiverate,\nFtarget\n.P=setofpositiveexamples\nN=setofnegativeexamples\nF0=1.0;D0=1.0i=0whileFi>Ftarget\nii+1ni=0;Fi=Fi1whileFi>fFi1nini+1UsePandNtotrainaclassierwith\nnifeaturesusing\nAdaBoostEvaluatecurrentcascadedclassieronvalidationsetto\ndetermineFiandDi.Decreasethresholdforthe\nithclassieruntilthecurrent\ncascadedclassierhasadetectionrateofatleast\n\ndDi1(thisalsoaffects\nFi)NIf\nFi>Ftarget\nthenevaluatethecurrentcascadeddetectoron\nthesetofnon-faceimagesandputanyfalsedetectionsinto\n\nthesetN\nInpracticeaverysimpleframeworkisusedtopro-\n618duceaneffectiveclassierwhichishighlyefcient.\n619Theuserselectsthemaximumacceptableratefor\nfi620andtheminimumacceptableratefor\ndi.Eachlayerof\n621thecascadeistrainedbyAdaBoost(asdescribedin\n622Table1)withthenumberoffeaturesusedbeingin-\n623creaseduntilthetargetdetectionandfalsepositiverates\n624aremetforthislevel.Theratesaredeterminedbytest-\n625ingthecurrentdetectoronavalidationset.Iftheoverall\n626targetfalsepositiverateisnotyetmetthenanotherlayer\n627isaddedtothecascade.Thenegativesetfortraining\n628subsequentlayersisobtainedbycollectingallfalsede-\n629tectionsfoundbyrunningthecurrentdetectoronaset\n630ofimageswhichdonotcontainanyinstancesoffaces.\n631ThisalgorithmisgivenmorepreciselyinTable2.\n6324.2.SimpleExperiment\n633Inordertoexplorethefeasibilityofthecascadeap-\n634proachtwosimpledetectorsweretrained:amono-\n635lithic200-featureclassierandacascadeoften\n63620-featureclassiers.Therststageclassierinthe\n637cascadewastrainedusing5000facesand10000non-\n638facesub-windowsrandomlychosenfromnon-faceim-\n639ages.Thesecondstageclassierwastrainedonthe\n640same5000facesplus5000falsepositivesoftherst\n641classier.Thisprocesscontinuedsothatsubsequent\n642stagesweretrainedusingthefalsepositivesofthepre-\n643viousstage.\n644Themonolithic200-featureclassierwastrainedon\n645theunionofallexamplesusedtotrainallthestages\n646ofthecascadedclassier.Notethatwithoutreference\n647tothecascadedclassier,itmightbedifculttose-\n648lectasetofnon-facetrainingexamplestotrainthe\n649monolithicclassier.Wecouldofcourseuseallpossi-\n650blesub-windowsfromallofournon-faceimages,but\n651thiswouldmakethetrainingtimeimpracticallylong.\n652Thesequentialwayinwhichthecascadedclassieris\n653trainedeffectivelyreducesthenon-facetrainingsetby\n654throwingouteasyexamplesandfocusingonthehard\n655ones.656Figure7givestheROCcurvescomparingtheper-\n657formanceofthetwoclassiers.Itshowsthatthereis\n658littledifferencebetweenthetwointermsofaccuracy.\n659However,thereisabigdifferenceintermsofspeed.\n660Thecascadedclassierisnearly10timesfastersince\n661itsrststagethrowsoutmostnon-facessothattheyare\n662neverevaluatedbysubsequentstages.\n6634.3.DetectorCascadeDiscussion\n664Thereisahiddenbenetoftrainingadetectorasase-\n665quenceofclassierswhichisthattheeffectivenumber\n666ofnegativeexamplesthatthenaldetectorseescanbe\n667verylarge.Onecanimaginetrainingasinglelargeclas-\n668sierwithmanyfeaturesandthentryingtospeedup\n669itsrunningtimebylookingatpartialsumsoffeatures\n670andstoppingthecomputationearlyifapartialsumis\n671belowtheappropriatethreshold.Onedrawbackofsuch\n672anapproachisthatthetrainingsetofnegativeexam-\n673pleswouldhavetoberelativelysmall(ontheorderof\n67410,000tomaybe100,000examples)tomaketraining\n675feasible.Withthecascadeddetector,thenallayersof\n676thecascademayeffectivelylookthroughhundredsof\n677millionsofnegativeexamplesinordertondasetof\n67810,000negativeexamplesthattheearlierlayersofthe\n679cascadefailon.Sothenegativetrainingsetismuch\n680largerandmorefocusedonthehardexamplesfora\n681cascadeddetector.\n682Anotionsimilartothecascadeappearsintheface\n683detectionsystemdescribedbyRowleyetal.(1998).\n684Rowleyetal.trainedtwoneuralnetworks.Onenetwork\n685wasmoderatelycomplex,focusedonasmallregionof\n686theimage,anddetectedfaceswithalowfalsepositive\n687rate.Theyalsotrainedasecondneuralnetworkwhich\n688'b'P1:***\nInternationalJournalofComputerVisionKL2213-05/5263672January10,200420:17\nUNCORRECTEDPROOF\nRobustReal-TimeFaceDetection147\nFigure7\n.ROCcurvescomparinga200-featureclassierwithacascadedclassiercontainingten20-featureclassiers.Accuracyisnot\nsignicantlydifferent,butthespeedofthecascadedclassierisalmost10timesfaster.\nwasmuchfaster,focusedonalargerregionsofthe\n689image,anddetectedfaceswithahigherfalsepositive\n690rate.Rowleyetal.usedthefastersecondnetworkto\n691prescreentheimageinordertondcandidateregions\n692fortheslowermoreaccuratenetwork.Thoughitis\n693difculttodetermineexactly,itappearsthatRowley\n694etal.stwonetworkfacesystemisthefastestexisting\n695facedetector.\n7Oursystemusesasimilarapproach,but\n696itextendsthistwostagecascadetoinclude38stages.\n697Thestructureofthecascadeddetectionprocessis\n698essentiallythatofadegeneratedecisiontree,andas\n699suchisrelatedtotheworkofAmitandGeman(1999).\n700Unliketechniqueswhichuseaxeddetector,Amitand\n701Gemanproposeanalternativepointofviewwhereun-\n702usualco-occurrencesofsimpleimagefeaturesareused\n703totriggertheevaluationofamorecomplexdetection\n704process.Inthiswaythefulldetectionprocessneednot\n705beevaluatedatmanyofthepotentialimagelocations\n706andscales.Whilethisbasicinsightisveryvaluable,\n707intheirimplementationitisnecessarytorstevaluate\n708somefeaturedetectorateverylocation.Thesefeatures\n709arethengroupedtondunusualco-occurrences.In\n710practice,sincetheformofourdetectorandthefea-\n711turesthatitusesareextremelyefcient,theamortized\n712costofevaluatingourdetectorat\neveryscaleandlo-\n713cationismuchfasterthanndingandgroupingedges\n714throughouttheimage.\n715InrecentworkFleuretandGeman(2001)havepre-\n716sentedafacedetectiontechniquewhichreliesona\n717chainoftestsinordertosignifythepresenceofa\n718faceataparticularscaleandlocation.Theimageprop-\n719ertiesmeasuredbyFleuretandGeman,disjunctions\n720ofnescaleedges,arequitedifferentthanrectangle\n721featureswhicharesimple,existatallscales,andare\n722somewhatinterpretable.Thetwoapproachesalsodiffer\n723radicallyintheirlearningphilosophy.BecauseFleuret\n724andGemanslearningprocessdoesnotusenegative\n725examplestheirapproachisbasedmoreondensityes-\n726timation,whileourdetectorispurelydiscriminative.\n727FinallythefalsepositiverateofFleuretandGemans\n728approachappearstobehigherthanthatofpreviousap-\n729proacheslikeRowleyetal.andthisapproach.Inthe\n730publishedpapertheincludedexampleimageseachhad\n731between2and10falsepositives.Formanypractical\n732tasks,itisimportantthattheexpectednumberoffalse\n733positivesinanyimagebelessthanone(sinceinmany\n734taskstheexpectednumberoftruepositivesislessthan\n735oneaswell).Unfortunatelythepaperdoesnotreport\n736quantitativedetectionandfalsepositiveresultsonstan-\n737darddatasets.\n738'b'P1:***\nInternationalJournalofComputerVisionKL2213-05/5263672January10,200420:17\nUNCORRECTEDPROOF\n148ViolaandJones\n5.Results\n739Thissectiondescribesthenalfacedetectionsystem.\n740Thediscussionincludesdetailsonthestructureand\n741trainingofthecascadeddetectoraswellasresultson\n742alargereal-worldtestingset.\n7435.1.TrainingDataset\n744Thefacetrainingsetconsistedof4916handlabeled\n745facesscaledandalignedtoabaseresolutionof24by\n74624pixels.Thefaceswereextractedfromimagesdown-\n747loadedduringarandomcrawloftheworldwideweb.\n748SometypicalfaceexamplesareshowninFig.8.The\n749trainingfacesareonlyroughlyaligned.Thiswasdone\n750byhavingapersonplaceaboundingboxaroundeach\n751facejustabovetheeyebrowsandabouthalf-waybe-\n752tweenthemouthandthechin.Thisboundingboxwas\n753thenenlargedby50%andthencroppedandscaledto\n75424by24pixels.Nofurtheralignmentwasdone(i.e.\n755theeyesarenotaligned).Noticethattheseexamples\n756containmoreoftheheadthantheexamplesusedby\n757Figure8\n.Exampleoffrontaluprightfaceimagesusedfortraining.\nRowleyetal.(1998)orSungandPoggio(1998).Ini-\n758tialexperimentsalsoused16by16pixeltrainingim-\n759agesinwhichthefacesweremoretightlycropped,\n760butgotslightlyworseresults.Presumablythe24by\n76124examplesincludeextravisualinformationsuchas\n762thecontoursofthechinandcheeksandthehairline\n763whichhelptoimproveaccuracy.Becauseofthenature\n764ofthefeaturesused,thelargersizedsub-windowsdo\n765notslowperformance.Infact,theadditionalinforma-\n766tioncontainedinthelargersub-windowscanbeused\n767torejectnon-facesearlierinthedetectioncascade.\n7685.2.StructureoftheDetectorCascade\n769Thenaldetectorisa38layercascadeofclassiers\n770whichincludedatotalof6060features.\n771Therstclassierinthecascadeisconstructedus-\n772ingtwofeaturesandrejectsabout50%ofnon-faces\n773whilecorrectlydetectingcloseto100%offaces.The\n774nextclassierhastenfeaturesandrejects80%ofnon-\n775faceswhiledetectingalmost100%offaces.Thenext\n776twolayersare25-featureclassiersfollowedbythree\n77750-featureclassiersfollowedbyclassierswitha\n'b'P1:***\nInternationalJournalofComputerVisionKL2213-05/5263672January10,200420:17\nUNCORRECTEDPROOF\nRobustReal-TimeFaceDetection149\nvarietyofdifferentnumbersoffeatureschosenaccord-\n778ingtothealgorithminTable2.Theparticularchoices\n779ofnumberoffeaturesperlayerwasdriventhrough\n780atrialanderrorprocessinwhichthenumberoffea-\n781tureswereincreaseduntilasignicantreductioninthe\n782falsepositiveratecouldbeachieved.Morelevelswere\n783addeduntilthefalsepositiverateonthevalidationset\n784wasnearlyzerowhilestillmaintainingahighcorrect\n785detectionrate.Thenalnumberoflayers,andthesize\n786ofeachlayer,arenotcriticaltothenalsystemperfor-\n787mance.Theprocedureweusedtochoosethenumber\n788offeaturesperlayerwasguidedbyhumanintervention\n789(fortherst7layers)inordertoreducethetrainingtime\n790forthedetector.ThealgorithmdescribedinTable2was\n791modiedslightlytoeasethecomputationalburdenby\n792specifyingaminimumnumberoffeaturesperlayerby\n793handandbyaddingmorethan1featureatatime.In\n794laterlayers,25featureswereaddedatatimebefore\n795testingonthevalidationset.Thisavoidedhavingto\n796testthedetectoronthevalidationsetforeverysingle\n797featureaddedtoaclassier.\n798Thenon-facesub-windowsusedtotraintherst\n799levelofthecascadewerecollectedbyselectingran-\n800domsub-windowsfromasetof9500imageswhich\n801didnotcontainfaces.Thenon-faceexamplesusedto\n802trainsubsequentlayerswereobtainedbyscanningthe\n803partialcascadeacrosslargenon-faceimagesandcol-\n804lectingfalsepositives.Amaximumof6000suchnon-\n805facesub-windowswerecollectedforeachlayer.There\n806areapproximately350millionnon-facesub-windows\n807containedinthe9500non-faceimages.\n808Trainingtimefortheentire38layerdetectorwason\n809theorderofweeksonasingle466MHzAlphaStation\n810XP900.Wehavesinceparallelizedthealgorithmto\n811makeitpossibletotrainacompletecascadeinabouta\n812day.\n8135.3.SpeedoftheFinalDetector\n814Thespeedofthecascadeddetectorisdirectlyrelated\n815tothenumberoffeaturesevaluatedperscannedsub-\n816window.AsdiscussedinSection4.1,thenumberoffea-\n817turesevaluateddependsontheimagesbeingscanned.\n818Sincealargemajorityofthesub-windowsaredis-\n819cardedbythersttwostagesofthecascade,anav-\n820erageof8featuresoutofatotalof6060areeval-\n821uatedpersub-window(asevaluatedontheMIT\n+822CMU(Rowleyetal.,1998).Ona700MhzPentium\n823IIIprocessor,thefacedetectorcanprocessa384by\n824288pixelimageinabout.067seconds(usingastarting\n825scaleof1.25andastepsizeof1.5describedbelow).\n826Thisisroughly15timesfasterthantheRowley-Baluja-\n827Kanadedetector(Rowleyetal.,1998)andabout600\n828timesfasterthantheSchneiderman-Kanadedetector\n829(SchneidermanandKanade,2000).\n8305.4.ImageProcessing\n831Allexamplesub-windowsusedfortrainingwerevari-\n832ancenormalizedtominimizetheeffectofdifferent\n833lightingconditions.Normalizationisthereforeneces-\n834saryduringdetectionaswell.Thevarianceofanimage\n835sub-windowcanbecomputedquicklyusingapairof\n836integralimages.Recallthat\n2=m21Nx2,where837isthestandarddeviation,\nmisthemean,and\nxis838thepixelvaluewithinthesub-window.Themeanofa\n839sub-windowcanbecomputedusingtheintegralimage.\n840Thesumofsquaredpixelsiscomputedusinganintegral\n841imageoftheimagesquared(i.e.twointegralimages\n842areusedinthescanningprocess).Duringscanningthe\n843effectofimagenormalizationcanbeachievedbypost\n844multiplyingthefeaturevaluesratherthanoperatingon\n845thepixels.\n8465.5.ScanningtheDetector\n847Thenaldetectorisscannedacrosstheimageatmulti-\n848plescalesandlocations.Scalingisachievedbyscaling\n849thedetectoritself,ratherthanscalingtheimage.This\n850processmakessensebecausethefeaturescanbeeval-\n851uatedatanyscalewiththesamecost.Gooddetection\n852resultswereobtainedusingscaleswhichareafactorof\n8531.25apart.\n854Thedetectorisalsoscannedacrosslocation.Sub-\n855sequentlocationsareobtainedbyshiftingthewindow\n856somenumberofpixels\n.Thisshiftingprocessisaf-\n857fectedbythescaleofthedetector:ifthecurrentscaleis\n858sthewindowisshiftedby[\ns],where[]istheround-\n859ingoperation.\n860Thechoiceof\naffectsboththespeedofthede-\n861tectoraswellasaccuracy.Sincethetrainingimages\n862havesometranslationalvariabilitythelearneddetector\n863achievesgooddetectionperformanceinspiteofsmall\n864shiftsintheimage.Asaresultthedetectorsub-window\n865canbeshiftedmorethanonepixelatatime.However,\n866astepsizeofmorethanonepixeltendstodecreasethe\n867detectionrateslightlywhilealsodecreasingthenumber\n868offalsepositives.Wepresentresultsfortwodifferent\n869stepsizes.\n870'b'P1:***\nInternationalJournalofComputerVisionKL2213-05/5263672January10,200420:17\nUNCORRECTEDPROOF\n150ViolaandJones\n5.6.IntegrationofMultipleDetections\n871Sincethenaldetectorisinsensitivetosmallchanges\n872intranslationandscale,multipledetectionswillusually\n873occuraroundeachfaceinascannedimage.Thesame\n874isoftentrueofsometypesoffalsepositives.Inpractice\n875itoftenmakessensetoreturnonenaldetectionper\n876face.Towardthisenditisusefultopostprocessthe\n877detectedsub-windowsinordertocombineoverlapping\n878detectionsintoasingledetection.\n879Intheseexperimentsdetectionsarecombinedina\n880verysimplefashion.Thesetofdetectionsarerstpar-\n881titionedintodisjointsubsets.Twodetectionsareinthe\n882samesubsetiftheirboundingregionsoverlap.Each\n883partitionyieldsasinglenaldetection.Thecornersof\n884thenalboundingregionaretheaverageofthecorners\n885ofalldetectionsintheset.\n886Insomecasesthispostprocessingdecreasesthenum-\n887beroffalsepositivessinceanoverlappingsubsetof\n888falsepositivesisreducedtoasingledetection.\n8895.7.ExperimentsonaReal-WorldTestSet\n890WetestedoursystemontheMIT\n+CMUfrontalface\n891testset(Rowleyetal.,1998).Thissetconsistsof130\n892Figure9\n.ROCcurvesforourfacedetectorontheMIT\n+CMUtestset.Thedetectorwasrunonceusingastepsizeof1.0andstartingscale\nof1.0(75,081,800sub-windowsscanned)andthenagainusingastepsizeof1.5andstartingscaleof1.25(18,901,947sub-windowsscanned).\n\nInbothcasesascalefactorof1.25wasused.\nimageswith507labeledfrontalfaces.AROCcurve\n893showingtheperformanceofourdetectoronthistest\n894setisshowninFig.9.TocreatetheROCcurvethe\n895thresholdoftheperceptrononthenallayerclassier\n896isadjustedfrom\nto.Adjustingthethresholdto\n897willyieldadetectionrateof0.0andafalsepositive\n898rateof0.0.Adjustingthethresholdto\n,how\never\n,899increasesboththedetectionrateandfalsepositiverate,\n900butonlytoacertainpoint.Neitherratecanbehigher\n901thantherateofthedetectioncascademinusthenal\n902layer.Ineffect,athresholdof\nisequivalenttore-\n903movingthatlayer.Furtherincreasingthedetectionand\n904falsepositiveratesrequiresdecreasingthethreshold\n905ofthenextclassierinthecascade.Thus,inorderto\n906constructacompleteROCcurve,classierlayersare\n907removed.Weusethe\nnumberoffalsepositivesasop-\n908posedtothe\nrateoffalsepositivesforthe\nx-axisof\n909theROCcurvetofacilitatecomparisonwithothersys-\n910tems.Tocomputethefalsepositiverate,simplydivide\n911bythetotalnumberofsub-windowsscanned.Forthe\n912caseof\n=1.0andstartingscale=1.0,thenumber\n913ofsub-windowsscannedis75,081,800.For\n=1.5914andstartingscale=1.25,thenumberofsub-windows\n915scannedis18,901,947.\n916Unfortunately,mostpreviouspublishedresultson\n917facedetectionhaveonlyincludedasingleoperating\n'b'P1:***\nInternationalJournalofComputerVisionKL2213-05/5263672January10,200420:17\nUNCORRECTEDPROOF\nRobustReal-TimeFaceDetection151\nTable3\n.DetectionratesforvariousnumbersoffalsepositivesontheMIT\n+CMUtestsetcontaining130\nimagesand507faces.\nFalsedetections\nDetector103150657895167422\nViola-Jones76.1%88.4%91.4%92.0%92.1%92.9%93.9%94.1%\nViola-Jones(voting)81.1%89.7%92.1%93.1%93.1%93.2%93.7%\nRowley-Baluja-Kanade83.2%86.0%89.2%90.1%89.9%\n\nSchneiderman-Kanade94.4%\n\nRoth-Yang-Ahuja\n(94.8%)\nregime(i.e.singlepointontheROCcurve).Tomake\n918comparisonwithourdetectoreasierwehavelistedour\n919detectionrateforthesamefalsepositiveratereported\n920bytheothersystems.Table3liststhedetectionrate\n921forvariousnumbersoffalsedetectionsforoursystem\n922aswellasotherpublishedsystems.FortheRowley-\n923Baluja-Kanaderesults(Rowleyetal.,1998),anumber\n924ofdifferentversionsoftheirdetectorweretestedyield-\n925inganumberofdifferentresults.Whilethesevarious\n926resultsarenotactuallypointsonaROCcurvefora\n927particulardetector,theydoindicateanumberofdif-\n928ferentperformancepointsthatcanbeachievedwith\n929theirapproach.TheydidpublishROCcurvesfortwo\n930oftheirdetectors,buttheseROCcurvesdidnotrep-\n931resenttheirbestresults.FortheRoth-Yang-Ahujade-\n932tector(Rothetal.,2000),theyreportedtheirresulton\n933theMIT\n+CMUtestsetminus5imagescontaining\n934linedrawnfacesremoved.Sotheirresultsareforasub-\n935setoftheMIT\n+CMUtestsetcontaining125images\n936with483faces.Presumablytheirdetectionratewould\n937belowerifthefulltestsetwasused.Theparenthe-\n938sesaroundtheirdetectionrateindicatesthisslightly\n939differenttestset.TheSungandPoggiofacedetec-\n940tor(SungandPoggio,1998)wastestedontheMIT\n941subsetoftheMIT\n+CMUtestsetsincetheCMU\n942portiondidnotexistyet.TheMITtestsetcontains\n94323imageswith149faces.Theyachievedadetection\n944rateof79.9%with5falsepositives.Ourdetection\n945ratewith5falsepositivesis77.8%ontheMITtest\n946set.947Figure10showstheoutputofourfacedetectoron\n948sometestimagesfromtheMIT\n+CMUtestset.\n9495.7.1.ASimpleVotingSchemeFurtherImproves\n950Results.Thebestresultswereobtainedthroughthe\n951combinationofthreedetectorstrainedusingdifferent\n952initialnegativeexamples,slightlydifferentweighting\n953onnegativeversuspositiveerrors,andslightlydifferent\n954criteriafortradingofffalsepositivesforclassiersize.\n955Thesethreesystemsperformedsimilarlyonthenal\n956task,butinsomecaseserrorsweredifferent.Thedetec-\n957tionresultsfromthesethreedetectorswerecombined\n958byretainingonlythosedetectionswhereatleast2out\n959of3detectorsagree.Thisimprovesthenaldetection\n960rateaswellaseliminatingmorefalsepositives.Since\n961detectorerrorsarenotuncorrelated,thecombination\n962resultsinameasurable,butmodest,improvementover\n963thebestsingledetector.\n9645.7.2.FailureModes.\nByobservingtheperformance\n965ofourfacedetectoronanumberoftestimageswehave\n966noticedafewdifferentfailuremodes.\n967Thefacedetectorwastrainedonfrontal,upright\n968faces.Thefaceswereonlyveryroughlyalignedso\n969thereissomevariationinrotationbothinplaneandout\n970ofplane.Informalobservationsuggeststhattheface\n971detectorcandetectfacesthataretilteduptoabout\n15972degreesinplaneandabout\n45degreesoutofplane\n973(towardaproleview).Thedetectorbecomesunreli-\n974ablewithmorerotationthanthis.\n975Wehavealsonoticedthatharshbacklightingin\n976whichthefacesareverydarkwhilethebackground\n977isrelativelylightsometimescausesfailures.Itisin-\n978terestingtonotethatusinganonlinearvariancenor-\n979malizationbasedonrobuststatisticstoremoveout-\n980liersimprovesthedetectionrateinthissituation.The\n981problemwithsuchanormalizationisthegreatlyin-\n982creasedcomputationalcostwithinourintegralimage\n983framework.\n984Finally,ourfacedetectorfailsonsignicantlyoc-\n985cludedfaces.Iftheeyesareoccludedforexample,the\n986detectorwillusuallyfail.Themouthisnotasimportant\n987andsoafacewithacoveredmouthwillusuallystillbe\n988detected.989'b'P1:***\nInternationalJournalofComputerVisionKL2213-05/5263672January10,200420:17\nUNCORRECTEDPROOF\n152ViolaandJones\nFigure10\n.OutputofourfacedetectoronanumberoftestimagesfromtheMIT\n+CMUtestset.\n6.Conclusions\n990Wehavepresentedanapproachforfacedetection\n991whichminimizescomputationtimewhileachieving\n992highdetectionaccuracy.Theapproachwasusedtocon-\n993structafacedetectionsystemwhichisapproximately\n99415timesfasterthananypreviousapproach.Preliminary\n995experiments,whichwillbedescribedelsewhere,show\n996thathighlyefcientdetectorsforotherobjects,suchas\n997pedestriansorautomobiles,canalsobeconstructedin\n998thisway.\n999Thispaperbringstogethernewalgorithms,represen-\n1000tations,andinsightswhicharequitegenericandmay\n1001wellhavebroaderapplicationincomputervisionand\n1002imageprocessing.\n1003Therstcontributionisanewatechniqueforcom-\n1004putingarichsetofimagefeaturesusingtheintegral\n1005image.Inordertoachievetruescaleinvariance,almost\n1006allfacedetectionsystemsmustoperateonmultiple\n1007imagescales.Theintegralimage,byeliminatingthe\n1008needtocomputeamulti-scaleimagepyramid,reduces\n1009theinitialimageprocessingrequiredforfacedetection\n1010'b'P1:***\nInternationalJournalofComputerVisionKL2213-05/5263672January10,200420:17\nUNCORRECTEDPROOF\nRobustReal-TimeFaceDetection153\nsignicantly.Usingtheintegralimage,facedetection\n1011iscompletedinalmostthesametimeasittakesforan\n1012imagepyramidtobecomputed.\n1013Whiletheintegralimageshouldalsohaveimmedi-\n1014ateuseforothersystemswhichhaveusedHaar-like\n1015featuressuchasPapageorgiouetal.(1998),itcanfore-\n1016seeablyhaveimpactonanytaskwhereHaar-likefea-\n1017turesmaybeofvalue.Initialexperimentshaveshown\n1018thatasimilarfeaturesetisalsoeffectiveforthetask\n1019ofparameterestimation,wheretheexpressionofa\n1020face,thepositionofahead,ortheposeofanobjectis\n1021determined.1022Thesecondcontributionofthispaperisasimple\n1023andefcientclassierbuiltfromcomputationallyef-\n1024cientfeaturesusingAdaBoostforfeatureselection.\n1025Thisclassierisclearlyaneffectiveoneforfacedetec-\n1026tionandwearecondentthatitwillalsobeeffectivein\n1027otherdomainssuchasautomobileorpedestriandetec-\n1028tion.Furthermore,theideaofanaggressiveandeffec-\n1029tivetechniqueforfeatureselectionshouldhaveimpact\n1030onawidevarietyoflearningtasks.Givenaneffective\n1031toolforfeatureselection,thesystemdesignerisfreeto\n1032deneaverylargeandverycomplexsetoffeaturesas\n1033inputforthelearningprocess.Theresultingclassier\n1034isneverthelesscomputationallyefcient,sinceonlya\n1035smallnumberoffeaturesneedtobeevaluatedduring\n1036runtime.Frequentlytheresultingclassierisalsoquite\n1037simple;withinalargesetofcomplexfeaturesitismore\n1038likelythatafewcriticalfeaturescanbefoundwhich\n1039capturethestructureoftheclassicationproblemina\n1040straightforwardfashion.\n1041Thethirdcontributionofthispaperisatechniquefor\n1042constructingacascadeofclassierswhichradically\n1043reducescomputationtimewhileimprovingdetection\n1044accuracy.Earlystagesofthecascadearedesignedto\n1045rejectamajorityoftheimageinordertofocussubse-\n1046quentprocessingonpromisingregions.Onekeypoint\n1047isthatthecascadepresentedisquitesimpleandho-\n1048mogeneousinstructure.Previousapproachesforat-\n1049tentiveltering,suchasIttietal.(1998)proposea\n1050morecomplexandheterogeneousmechanismforl-\n1051tering.SimilarlyAmitandGeman(1999)proposea\n1052hierarchicalstructurefordetectioninwhichthestages\n1053arequitedifferentinstructureandprocessing.Aho-\n1054mogeneoussystem,besidesbeingeasytoimplement\n1055andunderstand,hastheadvantagethatsimpletradeoffs\n1056canbemadebetweenprocessingtimeanddetection\n1057performance.1058Finallythispaperpresentsasetofdetailedexper-\n1059imentsonadifcultfacedetectiondatasetwhichhas\n1060beenwidelystudied.Thisdatasetincludesfacesunder\n1061averywiderangeofconditionsincluding:illumina-\n1062tion,scale,pose,andcameravariation.Experimentson\n1063suchalargeandcomplexdatasetaredifcultandtime\n1064consuming.Neverthelesssystemswhichworkunder\n1065theseconditionsareunlikelytobebrittleorlimitedtoa\n1066singlesetofconditions.Moreimportantlyconclusions\n1067drawnfromthisdatasetareunlikelytobeexperimental\n1068artifacts.\n1069Acknowledgments\n1070TheauthorswouldliketothankT.M.Murali,JimRehg,\n1071Tat-jenCham,RahulSukthankar,VladimirPavlovic,\n1072andThomasLeungforthetheirhelpfulcomments.\n1073HenryRowleywasextremelyhelpfulinprovidingim-\n1074plementationsofhisfacedetectorforcomparisonwith\n1075ourown.\n1076Notes10771.Supervisedreferstothefactthattheattentionaloperatoristrained\n1078todetectexamplesofaparticularclass.\n2.HenryRowleyverygraciouslysupplieduswithimplementations\n1079ofhisdetectionsystemfordirectcomparison.Reportedresults\n1080areagainsthisfastestsystem.Itisdifculttodeterminefrom\n1081thepublishedliterature,buttheRowley-Baluja-Kanadedetector\n1082iswidelyconsideredthefastestdetectionsystemandhasbeen\n1083heavilytestedonreal-worldproblems.\n3.Acompletebasishasnolineardependencebetweenbasisele-\n1084mentsandhasthesamenumberofelementsastheimagespace,\n1085inthiscase576.Thefullsetof160,000featuresismanytimes\n1086over-complete.4.Thereisacloserelationtosummedareatablesasusedingraph-\n1087ics(Crow,1984).Wechooseadifferentnamehereinordertoem-\n1088phasizeitsusefortheanalysisofimages,ratherthanfortexture\n1089mapping.5.Theavailabilityofcustomhardwareandtheappearanceofspe-\n1090cialinstructionsetslikeIntelMMXcanchangethisanalysis.\n1091Itisneverthelessinstructivetocompareperformanceassuming\n1092conventionalsoftwarealgorithms.\n6.Inthecasewheretheweaklearnerisaperceptronlearningal-\n1093gorithm,thenalboostedclassierisatwolayerperceptron.A\n1094twolayerperceptronisinprinciplemuchmorepowerfulthanany\n1095singlelayerperceptron.\n7.Amongotherpublishedfacedetectionsystemssomearepoten-\n1096tiallyfaster.Thesehaveeitherneglectedtodiscussperformance\n1097indetail,orhaveneverpublisheddetectionandfalsepositiverates\n1098onalargeanddifculttrainingset.\nReferences\n1099Amit,Y.andGeman,D.1999.Acomputationalmodelforvisual\n1100selection.NeuralComputation\n,11:16911715.1101'b'P1:***\nInternationalJournalofComputerVisionKL2213-05/5263672January10,200420:17\nUNCORRECTEDPROOF\n154ViolaandJones\nCrow,F.1984.Summed-areatablesfortexturemapping.In\nProceed-\n1102ingsofSIGGRAPH\n,18(3):207212.1103Fleuret,F.andGeman,D.2001.Coarse-to-nefacedetection.\nInt.1104J.ComputerVision\n.Au:Pls.\nprovide\n\nvol&\n\npagerange.\n1105Freeman,W.T.andAdelson,E.H.1991.Thedesignanduseofsteer-\n1106ablelters.\nIEEETransactionsonPatternAnalysisandMachine\n1107Intelligence\n,13(9):891906.1108Freund,Y.andSchapire,R.E.1995.Adecision-theoreticgeneraliza-\n1109tionofon-linelearningandanapplicationtoboosting.In\nCom-1110putationalLearningTheory:Eurocolt95\n,Springer-Verlag,pp.\n11112337.1112Greenspan,H.,Belongie,S.,Gooodman,R.,Perona,P.,Rakshit,S.,\n1113andAnderson,C.1994.Overcompletesteerablepyramidlters\n1114androtationinvariance.In\nProceedingsoftheIEEEConference\n1115onComputerVisionandPatternRecognition\n.1116Itti,L.,Koch,C.,andNiebur,E.1998.Amodelofsaliency-based\n1117visualattentionforrapidsceneanalysis.\nIEEEPatt.Anal.Mach.\n1118Intell.,20(11):1254-1259.1119John,G.,Kohavi,R.,andPfeger,K.1994.Irrelevantfeaturesand\n1120thesubsetselectionproblem.In\nMachineLearningConference\n1121Proceedings\n.1122Osuna,E.,Freund,R.,andGirosi,F.1997a.Trainingsupport\n1123vectormachines:Anapplicationtofacedetection.In\nProceed-\n1124ingsoftheIEEEConferenceonComputerVisionandPattern\n1125Recognition.\n1126Osuna,E.,Freund,R.,andGirosi,F.1997b.Trainingsupportvector\n1127machines:anapplicationtofacedetection.In\nProceedingsofthe\n1128IEEEConferenceonComputerVisionandPatternRecognition.\n1129Papageorgiou,C.,Oren,M.,andPoggio,T.1998.Ageneralframe-\n1130workforobjectdetection.In\nInternationalConferenceonCom-\n1131puterVision\n.1132Quinlan,J.1986.Inductionofdecisiontrees.\nMachineLearning\n,11331:81106.1134Roth,D.,Yang,M.,andAhuja,N.2000.Asnowbasedfacedetector.\n1135InNeuralInformationProcessing\n12.1136Rowley,H.,Baluja,S.,andKanade,T.1998.Neuralnetwork-based\n1137facedetection.\nIEEEPatt.Anal.Mach.Intell.\n,20:2238.1138Schapire,R.E.,Freund,Y.,Bartlett,P.,andLee,W.S.1997.Boost-\n1139ingthemargin:Anewexplanationfortheeffectivenessofvoting\n1140methods.In\nProceedingsoftheFourteenthInternationalConfer-\n1141enceonMachineLearning.\n1142Schapire,R.E.,Freund,Y.,Bartlett,P.,andLee,W.S.1998.Boost-\n1143ingthemargin:Anewexplanationfortheeffectivenessofvoting\n1144methods.Ann.Stat.\n,26(5):16511686.1145Schneiderman,H.andKanade,T.2000.Astatisticalmethodfor\n11463Dobjectdetectionappliedtofacesandcars.In\nInternational1147ConferenceonComputerVision\n.1148Simard,P.Y.,Bottou,L.,Haffner,P.,andLeCun,Y.(1999).Boxlets:\n1149Afastconvolutionalgorithmforsignalprocessingandneuralnet-\n1150works.InM.Kearns,S.Solla,andD.Cohn(Eds.),\nAdvances1151inNeuralInformationProcessingSystems\n,vol.11,pp.571\n1152577.1153Sung,K.andPoggio,T.1998.Example-basedlearningforview-\n1154basedfacedetection.\nIEEEPatt.Anal.Mach.Intell.\n,20:3951.1155Tieu,K.andViola,P.2000.Boostingimageretrieval.In\nProceedings\n1156oftheIEEEConferenceonComputerVisionandPatternRecog-\n1157nition.1158Tsotsos,J.,Culhane,S.,Wai,W.,Lai,Y.,Davis,N.,andNuo,\n1159F.1995.Modelingvisual-attentionviaselectivetuning.\nArticial1160IntelligenceJournal\n,78(1/2):507545.1161Webb,A.1999.StatisticalPatternRecognition.OxfordUniversity\n1162Press:NewYork.\n1163'