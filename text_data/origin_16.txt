b'ArterialTravelTimeEstimationBasedOnVehicleUsingWireless\nMagneticSensors\nKarricKwongandRobertKavaler\nSensysNetworks,Inc.\n2560NinthStreet,Berkeley,CA94710\nTel.(510)548-4620,Fax:(510)548-8264\nf\nkarric,kavaler\ng\n@sensysnetworks.com\nRamRajagopalandPravinVaraiya\n1\nDepartmentofElectricalEngineeringandComputerSciences\nUniversityofCalifornia,Berkeley,CA94720-1700\nTel:(510)642-5270;Fax:(510)642-1785\nf\nramr,varaiya\ng\n@eecs.berkeley.edu\n19July,2008\n1\nCorrespondingauthor\n'b"1\nAbstract\nApracticalschemeisdescribedforthereal-timeestimationoftraveltimeacrossanarterial\nsegmentwithmultipleintersections.Theschemereliesonmatchingvehiclesignaturesfrom\nwirelesssensors.Thesensorsprovideanoisymagneticsignatureofavehicleandtheprecise\ntimewhenitcrossesthesensors.Amatchofsignaturesattwolocationsgives\nthecorrespondingtraveltimeofthevehicle.Thetraveltimesforallmatchedvehiclesyieldthe\ntraveltime\ndistribution\n.Matchingresultscanbeprocessedtoprovideotherimportantarterial\nperformancemeasuresincludingcapacity,volume/capacityratio,queuelengths,andnumberof\nvehiclesinthelink.Thematchingalgorithmisbasedonastatisticalmodelofthesignatures.\nThestatisticalmodelitselfisestimatedfromthedata,anddoesnotrequiremeasurementof\n`groundtruth'.Theproceduredoes\nnot\nrequiremeasurementsofsignalsettings;infact,signal\nsettingscanbeinferredfromthematchedvehicleresults.Theprocedureistestedona0.9\nmile-longsegmentofSanPabloAvenueinAlbany,CA,underdifferenttrafconditions.The\nsegmentisdividedintothreelinks:onelinkspansfourintersections,andtwolinkseachspan\noneintersection.\nKeywords\n:real-timetraveltimeestimation;vehiclearterialperformancemeasures;\nqueuelength;dischargerate;magneticsignature\n"b"2\n1IntroductionandPreviousWork\nEstimatingarterialtraveltimeisdifSincethemovementofvehiclesisinterruptedbysignals,\nestimatesbasedonaveragespeedsfromloopdetectorsorradarareinaccurate.\nApproachesforestimatingtraveltimesonarteriallinksincludespeedvs.volumetocapacityratio\nrelationshipsorproceduresbasedontheHighwayCapacityManual.Thelattercalculatesaverage\ntraveltimeasthesumoftherunningtime,basedonarterialdesigncharacteristics,andtheintersec-\ntiondelay,basedonadeterministicpointdelaymodel.Theseapproachesarenotsuitedforreal-time\napplicationswithvariabletrafconditions.\nStatisticalmodelshavebeenproposedforestimatingtraveltimesfromsurveillancedata.Forex-\nample,\nZhang\n(\n1999\n)estimateslink-speedasafunctionofvolumetocapacityratioandvolume\nandoccupancymeasuredbyloopdetectors.Sincetheestimationitselfrequirescollectionoftravel\ntimes,themodelisandimpracticaltoimplement.\nBycontrast,\nSkabardonisandGeroliminis\n(\n2005\n)developagenerallyapplicablekinematicwave\nmodeltoconstructalinktraveltimeestimatefrom30-secondwandoccupancydatafroman\nupstreamloopdetectorandtheexacttimesoftheredandgreenphases.Theirprocedureforthe\ncasewhenqueuesclearineachcyclecanbeexplainedasfollows.Theupstreamdetectorgivesthe\nnumber\nn\nofvehiclesthatarriveina30-secinterval,sayduring\n[\ns\n;\ns\n+\n30\n]\n.These\nn\nvehiclesare\nassumedtocrossthedetectoratuniformlyspacedtimes\ns\n+\n30\ni\n=\nn\n;\ni\n=\n1\n;\n\n;\nn\n.Fromtheknown\norestimatedfreewtraveltime\nT\nf\n,thesevehicleswillarriveattheintersectionattimes\nT\nf\n+\ns\n+\n30\ni\n=\nn\n.Knowingthesignalphaseatthesearrivaltimesandthepreviouslycalculatedqueueatthe\nintersection,andusingthekinematicwavemodel(withknownorestimatedcongestionwavespeed\nandjamdensity),itisstraightforwardtooutthedelayfacedbyeachofthe\nn\nvehicles,andthe\nqueueremainingattheendofthe30seconds.Theprocedureisthenrepeated,toyieldtheaverage\ntraveltimeacrossthelinkandtheaveragedelay.\nLiuandMa\n(\n2008\n)useasimilarmodel.However,theymeasureindividualvehicledetectoractua-\ntions,sotheyknowtheexacttimesthatthevehiclescrossedthedetector,insteadofassumingthat\ntheseareuniformlyspacedtimes.Therestoftheirprocedureissimilar.Themodelsofindividual\nvehicletrajectoriesinboth\nSkabardonisandGeroliminis\n(\n2005\n)and\nLiuandMa\n(\n2008\n)aremore\nelaboratethantheuniformfreeowspeedassumedabove,andtakeintoaccountthevehicle'sde-\ncelerationasitapproachesaqueueanditsaccelerationasitdepartsfromthesignal.However,this\nelaborationdoesnotmeasurablyaffecttheaveragetraveltimeanddelayestimates(\nLiuandMa\n,\n2008\n,Figure10).Both\nSkabardonisandGeroliminis\n(\n2005\n)and\nLiuandMa\n(\n2008\n)alsotreatthe\ncasewhenarrivalsarenotclearedineachcycle.\nThetwoapproachesoutlinedabovehavelimitations.Theyrequireprecisesignalphasetimes,and\nthesemustbesynchronizedwiththedetectortimes.Moreover,foralinkwithmultipleintersec-\ntions,eachintersectionmustbeinstrumented.Suchinstrumentationisexpensive.Second,both\napproachesrequireknowledgeofparameterssuchasfreeowtraveltime,whichmaynotbecon-\nstantacrosstheentirerangeoftrafconditions,andleadtobiasintheestimates.Third,\naverage\ntraveltimeanddelayareinsuftocalculateinterestingarterialperformancemeasuresprovided\nbytheschemeproposedhere,asseeninSection\n3\n.\nInprinciple,vehicleschemesovercometheselimitations.Theseschemesworkas\nfollows.Sensorsplacedatthetwoendsofalinkrecordwhenavehiclecrossesthemandmeasure\nitssignature.Whenavehicle'ssignatureismatchedatthetwosensors,itstraveltimeisobtained.\n"b"3\nSignalphaseinformationisnotneeded.Ifsufntlymanyvehiclesarethetravel\ntimedistributioncanbeestimated.Vehiclescanbebymatchinguniquetagsorlicense\nplates;butbesidesraisingprivacyconcerns,theseschemesaretooexpensivetodeployoveran\narterialnetwork.\nschemesfor\nfreeway\ntraveltimeshavebeendemonstrated.\nSunetal.\n(\n1999\n)match\nwaveformsfrominductiveloops.Thewaveformsarenormalizedusingindependentlymea-\nsuredspeeds.Featuresfromthenormalizedwaveformpairsareextractedandcomparedinamulti-\ncriterionoptimizationframeworktoobtainthebestmatch.\nCoifman\n(\n1999\n)compareslengthsof\nvehicleplatoonsatthetwodetectorlocations.Thelengthestimatetoorequiresindependentspeed\nmeasurements.\nM.Ndoyeetal.\n(\n2008\n)and\nOhandRitchie\n(\n2002\n)reportexperimentsusinginductiveloopsigna-\ntures.Again,vehiclespeedisusedtonormalizetherawsignatureandproduceaspeed-independent\nsignature.Thespeednormalizationprocedureassumesthatvehiclespeedisconstant.Ifavehicle\nisacceleratingordecelerating,thisassumptionisinvalid:asNdoyeetal\nM.Ndoyeetal.\n(\n2008\n)\nreport,therateofcorrectmatchingthendropsdrastically.\nOhandRitchie\n(\n2002\n)onlyreportresults\nforanon-peakperiod.Neitherschemewouldperformwellinalinkwithacceleration\nanddeceleration,causedbytrafsignals.Platoonlengthsusedin\nCoifman\n(\n1999\n)wouldnotwork\nwellfortheadditionalreasonthatsignalizedintersectionswouldbreakplatoonsup.\nSunetal.\n(\n2004\n)usevideoimages(forvehiclecolor)inadditiontotheloop-basedsignatureand\nspeedinadata`fusion'algorithmthatachievesahighmatchingrateforvehicleplatoonsinalink\nthatdoesnotspananintersection.Theselectionoftheparametersofthefusionalgorithmre-\nquiresanextensiveandexpensivecollectionof`groundtruth'measurements.Thefusionalgorithm\nweightsloopsignature,speed,vehiclecolorandplatoontraversaltime.Inthebestfusionscheme,\ncolorreceivesaweightof95%.Theschemeisimpractical.\nThispaperpresentsaschemetoestimatethetraveltime\ndistribution\nofasinglearteriallink,span-\nningseveralsignalizedintersections.Theschemeisbasedonmatchingindividualvehiclesignatures\nobtainedfromwirelessmagneticsensorsplacedatthetwoendsofthelink.Thesignatureconsists\nofthesequenceofpeakvaluesofthe`raw'magneticsignal.Thepeakvaluesareindependentofthe\nvehiclespeed,sospeedmeasurementsarenotneeded.\nUnlike\nSkabardonisandGeroliminis\n(\n2005\n);\nLiuandMa\n(\n2008\n)theschemerequires\nno\nsignalphase\nmeasurements.Indeed,signalphases,queuelengths,delaydistributionsandotherperformance\nmeasurescanallbeevaluatedfromthematchedvehicles.Theschemeistestedona0.9mile-long\nsegmentofSanPabloAvenueinAlbany,CA,spanningsixintersections.Thesegmentisdivided\nintothreelinks:onelinkspansfourintersections,andtwolinkseachspanoneintersection.The\npeakhourperlanewoverthesegmentis500-600vph.\nThepaperisorganizedasfollows.ThetestsiteandmeasurementsystemaredescribedinSec-\ntion\n2\n.TestresultsarepresentedinSection\n3\n.Thematchingproblemandthestatisticalsignature\nmodelusedtoevaluatematchingalgorithmsoccupySection\n4\n.Theoptimalunconstrainedmatching\nalgorithmandtheoptimalconstrainedmatchingalgorithmaredescribedinSections\n5\nand\n6\n,respec-\ntively.(TheresultsofSection\n3\narebasedonoptimalconstrainedmatching.)Areal-timeversionof\ntheoptimalconstrainedalgorithmispresentedinSection\n7\n.Section\n8\nexplainshowthestatistical\nsignaturemodelisestimatedwithoutgroundtruth.Section\n9\ncollectstheconclusions.Someofthe\nmoretechnicalmaterialispresentedintheAppendix.\n"b"4\n2Testsiteandmeasurementsystem\nOntheleftinFigure\n1\nisamapofthe0.9mile-longtestsegmentonsouthboundSanPabloAvenue\ninAlbany,CA,startingat\nA\n(Fairmount)andendingat\nD\n(Buchanan).Thesegmentisdividedinto\nthreelinks,\nA\n!\nB\n,\nB\n!\nC\n,\nC\n!\nD\n.Link\nA\n!\nB\nspansfoursignalizedintersections(thethreecircles\nplustheintersectionatWashington),links\nB\n!\nC\nand\nC\n!\nD\neachspanonesignalizedintersection.\nSensorsat\nA\n;\nB\n;\nC\n,and\nD\narelocatedimmediatelydownstream(12m)ofthecorrespondingintersec-\ntion.Thuseachlinkhasoneuplinkandonedownstreamsensor,asshowninthemiddleofFigure\n1\n.Forexample,link\nC\n!\nD\nhasitsupstreamsensorat\nC\n(12mdownstreamoftheintersectionat\nSolano)anditsdownstreamsensorat\nD\n(12mdownstreamoftheintersectionatBuchanan).\nFigure1:Testsite,sensorlocations,andvehiclematches.\nSanPabloAvenuehastwolanes,eachwithitsownsensors.Vehiclesineachlanearematched\nseparately.Theresultsbelowareforlane1,nexttothemedian.Wenowdescribethedata.Consider\nthelinkillustratedinthemiddleoftheDuringameasurementtimeinterval,vehiclesindexed\ni\n=\n1\n;\n\n;\nN\ncrosstheupstreamsensorattimes\ns\n1\n<\ns\n2\n<\n\n.Vehiclesindexed\nj\n=\n1\n;\n\n;\nM\ncross\nthedownstreamsensorattimes\nt\n1\n<\nt\n2\n<\n\n.Theupstreamsensormeasuresthe`signature'\nX\ni\nof\neachvehicle\ni\nthatcrossesitandthecorrespondingtime\ns\ni\n.Thedownstreamsensormeasuresthe\nsignature\nY\nj\nofeachvehicle\nj\nthatcrossesitandthecorrespondingtime\nt\nj\n.Thusthemeasurement\ndataconsistsoftwoarrays\nf\n(\ns\ni\n;\nX\ni\n)\n;\ni\n=\n1\n;\n\n;\nN\ng\nand\nf\n(\nt\nj\n;\nY\nj\n)\n;\nj\n=\n1\n;\n\n;\nM\ng\n.Vehiclespeedis\nnot\nmeasured.Assuggestedbytheontheright,upstreamvehicle1isthesameasdownstream\nvehicle3,whichwillbedenotedas\nX\n1\n!\nY\n3\n;similarly\nX\n3\n!\nY\n5\n.Ontheotherhandupstreamvehicle\n2hasturned(eitherintotheotherlaneorattheintersection)beforereachingthedownstreamsensor,\ndenoted\nX\n2\n!\nt\n;similarly\nt\n!\nY\n4\nindicatesthatdownstreamvehicle4turnedintothelaneanddid\nnotcrosstheupstreamsensor.\n"b"5\nEachsensorconsistsofanarrayofseven3\n\n3\n\n2nodes,embeddedinthepavement1foot\napart,perpendiculartothedirectionofmotion.Anodehaselectroniccircuitsthatincorporate\nintoasystemamagneto-resistivesensormeasuringtheearthsmagneticaradiotransceiver,\nanantenna,amicroprocessor,memoryandabattery.Themagneticisdistortedasavehicle\ngoesoverthesensor.Thenoderecordsthemeasuredsampledatarateof128Hzandextracts\nfromtherecordafeaturevectorofthevehicle.Thesevenfeaturevectorsconstitutethevehicle's\nsignature.Thenodestransmitthetimewhenthevehiclecrossedittogetherwithitssignaturevia\nradiotoaroadside`accesspoint'.Theaccesspointinturntransmitsthedatatoaserverusinga\ncellularservice.Datafromtheserverareanalyzedoff-line.Inadeployment,thedatacouldbe\nanalyzedon-lineattheaccesspoint.ThenodesandaccesspointareproductsofSensysNetworks,\nInc.anddescribedin\nHaouietal.\n(\n2008\n).\nAswehaveseen,dataarrivingattheserverfromalinkduringatimeintervalconsistoftheup-\nstreamarray\nf\n(\ns\ni\n;\nX\ni\n)\n;\ni\n=\n1\n;\n\n;\nN\ng\nandthedownstreamarray\nf\n(\nt\nj\n;\nY\nj\n)\n;\nj\n=\n1\n;\n\n;\nM\ng\n.Thetime\nintervalshouldbesoshortthatthetraveltimedistributiondoesnotchangebutlongenoughfor\nmeaningfulstatisticalestimates.Resultsarereportedfor30-minuteintervalsduringthepeakperiod\n(1-2PM)and60-minuteintervalsintheoff-peakperiod(11PM-12AM);duringthe30-minpeak\nperiodbetween200and300vehiclestraversedeachlinkofthetestsegment.\nThematchingofupstreamanddownstreamarraysisdoneintwosteps.Intheor\nsignalpro-\ncessing\nstep,eachpairof\n(\nX\ni\n;\nY\nj\n)\nofupstreamanddownstreamsignaturesiscomparedtoproducea\nmeasureofdissimilarityordistance\nd\n(\ni\n;\nj\n)\n\n0betweenthem,i.e.,thesignalprocessingalgorithm\nimplementsafunction\nd\n,\nd\n(\ni\n;\nj\n)=\nd\n(\nX\ni\n;\nY\nj\n)\n.Thesignalprocessingsteptherebyreducesthetwosig-\nnaturearraystothe\nN\n\nM\nmatrix\nD\n=\nf\nd\n(\ni\n;\nj\n)\nj\n1\n\ni\n\nN\n;\n1\n\nj\n\nM\ng\n.Thesignalprocessingstep\nisdescribedintheAppendix.Inthesecondstepthe\nmatchingproblem\nisformulatedandsolved.\nThesolutiontothematchingproblemisasetofmatchesoftheform\ni\n!\nj\n,\ni\n!\nt\n,or\nt\n!\nj\n,\nindicatingrespectivelythatupstreamvehicle\ni\nisdeclaredtobedownstreamvehicle\nj\n,\ni\ncannotbe\nmatchedtoanydownstreamvehicle,or\nj\ncannotbematchedtoanyupstreamvehicle.Foravehicle\nmatch\ni\n!\nj\n,\ns\ni\nand\nt\nj\narethetimesthevehiclewasatthebeginningandendofthelink,so\n(\nt\nj\n\ns\ni\n)\nisitslinktraveltime.Theothermatchesmayindicateturns.Thenextsectiondiscussesthesolution\nofthematchingproblemforthetestsite.\n3Testresultsandanalysis\nWeconsiderthesolutionofthematchingproblemforthesinglelink\nB\n!\nC\n,andthenanalyze\ntheimplicationsofthesolution.Thesolutionisobtainedusingtheoptimalconstrainedmatching\nalgorithmofSection\n6\n.Figure\n2\nshowsonewaytodisplaythematchesforlink\nB\n!\nC\nduringthe\npeakhourperiod1-1:23PMonMay23,2008.The\nx\n-axisisthetimein10\n4\nsthatamatchedvehicle\ncrossestheupstreamsensorat\nB\n(top)orthedownstreamsensorat\nC\n(bottom).(Midnightis0s,\n4\n:\n68\n\n10\n4\n=\n3600\n=\n13hoursor1PM,and4\n:\n86\n\n10\n4\n=\n3600is1:23PM.)The\ny\n-axisisthematched\nvehicle'straveltimeinseconds.Forillustration,twomatchesarehighlighted:onevehiclewith\nstarttime\ns\n1\n,endtime\nt\n1\nandtraveltime\nt\n1\n\ns\n1\n,andanothervehiclewithcorrespondingtimes\ns\n10\n;\nt\n10\n;\nt\n10\n\ns\n10\n.Thetraveltimesamplescanbeusedtoestimate\ntraveltimedistributions\nasin\nFigure\n5\nbelow.VehiclesthatarenotmatchedarenotshowninFigure\n2\n(butseeFigure\n4\n).Figure\n2\nalsorevealsinformationaboutdelay,signalphase,queues,numberofvehiclesinthelink,and\nturningmovements.\n"b"6\nFigure2:Sampleresultsforlink\nB\n!\nC\n,May23,2008,1-1:23PM:traveltimevs.starttime(top),\ntraveltimevs.endtime(bottom).\nDelay\nThefreewtraveltime\nT\nf\nistheshortesttraveltime,20-30sintheseplots,asindicatedinthe\nlowerplot.Thedifferencebetweenavehicle'straveltimeandthefreewtraveltimeisthedelay\nitencounteredattheintersectionfromdecelerationandacceleration,andwaitinginqueueoratthe\nstopbarduringtheredphase.Thusitisstraightforwardtoestimatethetotaldelay,averagedelay,\nanddelaystatisticssuchaspercentofvehiclesexperiencingdelaylargerthansomeamount.\nSignalphase\nThesensorat\nC\nis12mdownstreamoftheintersectionat\nC\n,sotheendtimeofavehicleisvirtually\nthesameasthetimethatitcrossestheintersection.Hencethesignalphaseat\nC\nmustbegreenat\neveryvehicleendtime.Thearrivalofaclusterorplatoonofvehiclesindicatesthatthesevehicles\nhadformedaqueueatthestopbar.Sotheendtimeofthevehicleinaplatoonmustcoincide\nwiththestartofthegreenphase(andendoftheredphase)at\nC\n.Fromthesefactswecanprecisely\ninferthestartofthegreenphaseat\nC\n.Ontheotherhand,thevehicleintheplatoonmustbethe\ntoarriveintheredphase.Thusthestartoftheredphaseat\nC\nmustoccurbeforethestarttimeof\nthevehicleintheplatoonplusitsfreewtraveltime.Thisreasoningleadstotheconstruction\nofthesignalphasesasillustratedinthebottomoftheThesignalat\nC\nisactuated,sothe\nphasedurationsarenotconstant.\nDischargerate\nIntersectioncapacityestimatesarebasedonthemaximumrateatwhichaqueuedischargesduring\nagreenphase.Thismaximumrate\nr\niseasilyobtainedfromthetimes\nf\nt\nj\ng\nwhenvehiclescrossthe\n"b"7\ndownstreamsensorbytheminimumtimeneededtodischarge(say)vevehicles:\nr\n=\n5\nmin\nj\n(\nt\nj\n+\n5\n\nt\nj\n)\n:\nBytakingdifferentnumbers(than5)moredetailedcharacteristicsofqueuedischargecanalsobe\nobtained(\nLinandThomas\n(\n2005\n)).\nQueues\nAplatoonarrivingatthedownstreamsensorindicatesthatthesevehicleswereearlierqueuedatthe\nstopbar.Vehiclesintheplatoonarriveinorderoftheirpositioninthequeue.Thevehiclein\nthequeuewillexperiencethelongestdelay(andtraveltime)andsuccessivevehiclesinthequeue\nwillexperienceshorterqueueingdelays.Thusfromthetopplotinthewecaninferthatthe\nvehiclewithstarttime\ns\n1\nisinthequeueanditwaitedinthequeuefortime\nt\n1\n\ns\n1\n\nT\nf\n,the\nsecondvehicleinthequeuewaitedfortime\nt\n2\n\ns\n2\n\nT\nf\n,andsoon.Thevehiclewithstarttime\ns\n10\n(orperhapsthevehiclewithstarttime\ns\n8\n)isthevehiclethatjoinedthequeueafterithadclearedand\nhenceitfacednodelay.Sincetheseeightortenvehiclesarrivedinaplatoon,wemayinferthatthe\nqueuesizereachedamaximumvalueoftenoreightvehiclesduringthiscycle.\nCyclefailure\nInmostcyclesthetraveltimeofthevehicleinaplatoonislargerthanthetraveltimeofthe\nprecedingvehicle,andthelatterequalsthefreewtraveltime,\nT\nf\n.Thisimpliesthatthequeueat\nthestopbarisclearedinthesecycles,indicatingnocyclefailure.ButinFigure\n2\nthevehiclewith\nstarttime\ns\n1\nleft\nB\nwiththeprecedingplatoon,butdidnotleave\nC\nwiththatplatoon.Thevehicle\nwithstarttime\ns\n1\nisdelayedbymorethanoneredphase,indicatingcyclefailure.Thusonecan\nestimatecyclefailure(\nZhengetal.\n(\n2006\n)).\nVehiclesinlink\nFigure\n3\nshowshowtoestimate\nN\n(\nt\n)\n,thenumberofvehiclesinthelinkbetweentheupstreamand\ndownstreamsensorsattime\nt\n.Let\ni\n;\ns\ni\ndenoteavehicle'sindexandthetimeitcrossestheupstream\nsensor,andlet\nj\n;\nt\nj\ncorrespondtothedownstreamsensor.Let\nJ\nbetheindexofthedownstream\nvehiclewiththelargesttime\nt\nJ\n\nt\nthatismatchedwithsomeupstreamvehiclewithindex\nI\n,say.\nLet\nK\nbetheindexoftheupstreamvehiclewiththelargesttime\ns\nK\n\nt\n.Inthe\nJ\n=\n19,\nI\n=\n6,\nK\n=\n10.Theupstreamvehiclewithindex\nI\nleftthelinkbeforetime\nt\n.Soif\nI\nmax\nisthelargestindex\nofanupstreamvehiclethatleftthelinkbefore\nt\n,\nI\nmax\n\nI\n.Ontheotherhand,\nK\nisthelargestindex\nofanupstreamvehiclethatisstillinthelinkattime\nt\n.Henceiftherearenoturningmovements,\nN\n(\nt\n)=\nK\n\nI\nmax\n\nK\n\nI\n:\nEqualitywillnotholdaboveonlyif\nI\nmax\n>\nI\n,whichhappensonlywhenupstreamvehicle\nI\nmax\nis\nnotmatched.(Inthe\nI\nmax\n=\nI\n=\n6\n;\nK\n\nI\n=\n4.)Ifthematchingprobabilityis\np\n,onaverage\nI\nmax\n\nI\n=\np\n\n1\n\n1,soif\np\n>\n0\n:\n5,theestimate\nK\n\nI\ndiffersfrom\nN\n(\nt\n)\nbyatmost1onaverage.\nIfthereareturningmovements,theboundabovechangesto\nN\n(\nt\n)\n\nK\n\nI\n\nn\nout\n+\nn\nin\n;\ninwhich\nn\nout\nisthenumberofupstreamvehicleswithindexbetween\nI\nand\nK\n(likevehiclewith\nindex\ni\n=\n8inthethatwentoutofthelinkbeforecrossingthedownstreamsensorand\nn\nin\nis\nthenumberofvehicleswithindexlargerthan\nJ\n(like\nj\n=\n20)thatcameintothelinkwithoutcrossing\ntheupstreamsensor.\n"b"8\nFigure3:Calculationofnumberofvehicles\nN\nt\ninlinkattime\nt\n.Darksquaresarevehiclesthathave\nbeenmatchedbefore\nt\n.\nRemark\nIfsensorsareplacedatthebeginningandendofanon-oroff-ramp,theschemeabove\nwillgiveanaccuratereal-timeestimateofthenumber\nN\n(\nt\n)\nofvehiclesontherampatanytime\nt\n.On\naramp,therearenoturningmovements,so\nn\nout\n=\nn\nin\n=\n0.Note,too,thatintermsofthenotation\nabove,\nt\nJ\n\ns\nI\nistherampdelayexperiencedbythemostrecentdepartingvehicle.Theschemecan\nalsobeusedtoestimatethenumberofvehicles(andhencetheaverageheadway)withinafreeway\nsegmenttoobtainthetruespatialdensity.Suchestimatesmaybeusefulinsettinga`variablespeed\ncontrol'policy.\nFigure4:Matchedvehiclesonlink\nB\n!\nC\nareconnected;unmatchedvehiclesareshownasisolated\ncrosses.Vehiclesmorefrombottom(\nB\n)totop(\nC\n).\nTurning\nFigure\n4\ngivesmoreinformationthanFigure\n2\n.Matchedvehiclesareconnected;unmatchedvehicles\nareshownasisolatedcrosses.Thesignalphasesat\nC\nwereinferredasexplainedabove.Itappears\n"b'9\nthattheunmatchedvehiclesthatcross\nC\nduringaredphasearethosethatturnintoSanPablofrom\nSolano(seemapinFigure\n1\n).Similarly,someunmatchedvehiclesat\nB\nappeartohaveturnedfrom\nSanPablointoSolanowithoutcrossingthesensoratSolano.\nTraveltimedistribution\nFromthematchedvehiclesoneobtainsthefourtraveltimedistributionsofFigure\n5\n.\nFigure5:TraveltimedistributionsforMay23,2008,1-1:30PM.\nThe\nx\n-axisistraveltimeinsecondsandthe\ny\n-axisisprobability.Thetraveltimedistributions\nofFigure\n5\nalsomakeclearthatthemeantraveltimeisaninsufindicationoftraveltime\nreliability\n.\nTable\n3\ngivesthemeansandvariancesofthefourtraveltimedistributionsinFigure\n5\n.Thesumof\nthemeansandvariancesforlinks\nA\n!\nB\n,\nB\n!\nC\nand\nC\n!\nD\ncanbecomparedwiththemeanand\nvarianceforlink\nAtoD\n.Asexpected,themeantraveltimeover\nA\n!\nD\nisthesumofitscomponent\nlinkmeantraveltimes.Moreinterestingisthatthevariancefor\nA\n!\nD\nissmallerthanthesumof\nthecomponentlinkvariances,indicatingadegreeofeffectivesignalcoordination.\nMatchingRate\n'b'10\nLink\nMean\nVariance\nA\n!\nB\n92.4\n860\nB\n!\nC\n58.4\n784\nC\n!\nD\n36.8\n109\nSum\n187.6\n1753\nA\n!\nD\n187.7\n1455\nTable1:Meanandvarianceoftraveltimes.\nThelegend99/211intheplotforlink\nA\n!\nB\ninFigure\n5\nmeansthat211vehiclescrossedthesensor\nat\nA\nofwhich99werematchedat\nB\n.Ifafraction\nt\nofvehiclesentering\nA\nturnedbeforecrossing\nB\n,\nthematchingrateis99\n=\n(\n1\n\nt\n)\n211.Foranestimated\nt\n=\n0\n:\n3(therearefourintersectionsbetween\nA\nand\nB\n)thisgivesamatchingrateof99\n=\n[\n0\n:\n7\n\n211\n]\nor67%.Thematchingratesfortheotherlinksare\n138\n=\n[\n0\n:\n8\n\n232\n]=\n74%for\nB\n!\nC\n;115\n=\n[\n0\n:\n8\n\n225\n]=\n64%for\nC\n!\nD\n;and87\n=\n[\n0\n:\n6\n\n211\n]=\n69%\nfor\nA\n!\nD\n(whichhassixintersections).\nPeakvsoff-peak\nFigure\n6\ndisplaysthetraveltimedistributionsforlinks\nA\n!\nB\nand\nC\n!\nD\nforanoff-peakperiod,\n11-12PM.ComparisonwithFigure\n2\nshowsthatthemeantraveltimeislower:77.12secvs.92.4sec\nforlink\nA\n!\nB\n;29.6secvs.36.8secforlink\nC\n!\nD\n.Moreinterestingly,about25%ofpeakvehicles\nfacethesametraveltimeasoff-peakvehicles.\nFigure6:TraveltimedistributionsforMay23,2008,11-12PM.\nOptimummatching\nTheresultsdescribedaboveareobtainedfromtheoptimummatchingalgorithmpresentedinSection\n6\n.Thealgorithmtakesthedistancematrixasdataandproducestheoptimummatch,asillustratedin\nFigure\n7\n.Theplotontheleftisagrayscalecodingofthedistancematrix.Thereisonepixelforthe\ndistancebetweenthesignaturesofeachpairofvehicles;adarkercolorindicatesshorterdistance.\nClearlyvisibleintheplotisadarkdiagonallineofshortdistances.Thegraphontherightisthe\nassignmentfromtheoptimalmatchingfunction.Thedataareforabout250vehiclesthattraversed\nlink\nC\n!\nD\nonMay23,2008,1-1:30PM.\n'b'11\nFigure7:Thedistancematrix(left)andtheoptimumconstrainedmatch(right)forlink\nC\n!\nD\n,May\n23,2008,1-1:30PM\n4Matchingproblem\nThe\nsignal-processing\nstepassignstoeachpairofsignatures\n(\nX\ni\n;\nY\nj\n)\nthedistance\nd\n(\ni\n;\nj\n)=\nd\n(\nX\ni\n;\nY\nj\n)\n\n0betweenthem.Thesmalleris\nd\n(\nX\ni\n;\nY\nj\n)\nthemorelikelyitisthat\nX\ni\n;\nY\nj\naresignaturesofthesame\nvehicle.Attheendofthesignalprocessingstepwethusarriveatthedata\n(\nD\n;\nS\n;\nT\n)\nconsistingofthe\nN\n\nM\ndistancematrix\nD\n=\nf\nd\n(\ni\n;\nj\n)\n;\n1\n\ni\n\nN\n;\n1\n\nj\n\nM\ng\n;thearrayof\nN\norderedupstreamtimes\nS\n=(\ns\n1\n;\n\n;\ns\nN\n)\n;andthearrayof\nM\nordereddownstreamtimes\nT\n=(\nt\n1\n;\n\n;\nt\nM\n)\n.\nA\nmatchingfunction\nassignstoeachdistancematrix\nD\nthematching\n\n(\nD\n)\n,\n\n(\nD\n)\n:\nf\n1\n;\n\n;\nN\ng!f\n1\n;\n\n;\nM\n;\nt\ng\n;\nwiththisinterpretation:\n\n(\nD\n)(\ni\n)=\nj\nmeansthattheupstreamvehicle\ni\nisdeclaredtomatch(be\nthesameas)downstreamvehicle\nj\n;\n\n(\nD\n)(\ni\n)=\nt\nmeans\ni\nisdeclarednottomatchanydownstream\nvehicle.Ifvehicle\ni\nismatchedwith\nj\n,itsstart,endandtraveltimesare\ns\ni\n;\nt\nj\n,and\nt\nj\n\ns\ni\nareobtained\nfromthearrays\nS\nand\nT\n;anunmatchedvehicledoesnotyieldatraveltime,andmayindicatea\nturningmovement.\nThe\ntruematching\n(groundtruth)isdenotedby\n\n.Theproblemistodesignamatching\n\n(\nD\n)\n,based\nontheobservationmatrix\nD\n,thatiscloseto\n\n,withoutofcourseknowing\n\n.\nAnimportant,intuitiveexampleisthe\nminimumdistance\nmatchingfunction,\n\nminD\n,whichdeclares\nanupstreamvehicle\ni\ntobethesameasthedownstreamvehicle\nj\nthatisclosesttoit,providedalso\nthatthedistance\nd\n(\ni\n;\nj\n)\nissmallerthanathreshold,say\nd\n\n;otherwiseitassigns\nt\n.Formally,\n\nminD\n(\nD\n)(\ni\n)=\n\nj\nif\nd\n(\ni\n;\nj\n)\n\nd\n(\ni\n;\nk\n)\n8\nk\n;\nd\n(\ni\n;\nj\n)\n\nd\n\nt\nif\nd\n(\ni\n;\nk\n)\n>\nd\n\n8\nk\n:\n(1)\nStatisticalmodelofsignaturedistance\n'b'12\nInordertoevaluatetheperformanceof\n\nminD\nandtodevelopbettermatchingfunctions,wepropose\nastatisticalmodelofthesignaturedistance.\nWeassumethatthedistancematrixischaracterizedbytwoprobabilitydensityfunctions(pdf),\nf\nand\ng\n:\nf\nisthepdfofthedistance\nd\n(\nX\nv\n;\nY\nv\n)\nbetweenthesignaturesattheupstreamanddownstream\nsensorsofthe\nsame\nrandomlyselectedvehicle\nv\n,\nf\n(\nd\n)=\np\n(\nd\n(\nX\nv\n;\nY\nv\n)=\nd\n)\n;\nand\ng\nisthepdfofthedistance\nd\n(\nX\nv\n;\nY\nw\n)\nbetweentwo\ndifferent\nrandomlyselectedvehicles\nv\n6\n=\nw\n:\ng\n(\nd\n)=\np\n(\nd\n(\nX\nv\n;\nY\nw\n)=\nd\n)\n:\nThen,conditionalonthetruematching\n\n,thecoefoftherandomobservationmatrix\nD\nhave\nthepdf\nd\n(\ni\n;\nj\n)\n\n\nf\nif\n\n(\ni\n)=\nj\ng\nif\n\n(\ni\n)\n6\n=\nj\nor\n\n(\ni\n)=\nt\n:\nWeassumethatconditionalon\n\nthe\nd\n(\ni\n;\nj\n)\nareindependentrandomvariables.Let\nD\ni\n=\nf\nd\n(\ni\n;\nj\n)\n;\n1\n\nj\n\nM\ng\nbethearrayofdistancesbetween\nX\ni\nandallthe\nY\nj\n.Then\np\n(\nD\nj\n\n\n)=\n\ni\np\n(\nD\ni\nj\n\n\n(\ni\n))\n;\n(2)\np\n(\nD\ni\nj\n\n\n(\ni\n))=\n\nf\n(\nd\n(\ni\n;\nj\n))\n\nk\n6\n=\nj\ng\n(\nd\n(\ni\n;\nk\n))\nif\n\n(\ni\n)=\nj\n\nk\ng\n(\nd\n(\ni\n;\nk\n))\nif\n\n(\ni\n)=\nt\n=\n\nL\n(\nd\n(\ni\n;\nj\n))\ng\n(\nD\ni\n)\nif\n\n(\ni\n)=\nj\ng\n(\nD\ni\n)\nif\n\n(\ni\n)=\nt\n;\n(3)\ninwhich\nL\n(\nd\n(\ni\n;\nj\n))=\nf\n(\nd\n(\ni\n;\nj\n))\ng\n(\nd\n(\ni\n;\nj\n))\n;\ng\n(\nD\ni\n)=\nM\n\nk\n=\n1\ng\n(\nd\n(\ni\n;\nk\n))\n:\n(4)\nRelations(\n2\n)-(\n4\n)constitutethesignaturedistancestatisticalmodel.\nFigure\n8\ndisplaystheempiricalpdfsandtheGaussianapproximationsof\nf\nand\ng\nforthethreelinks.\nTheannotationabovetheleftplotforlink\nA\n!\nB\nmeansthat\n\nf\nand\ns\nf\narethemeanandstandard\ndeviationfor\nf\n;\n\ng\nand\ns\ng\narethemeanandstandarddeviationfor\ng\n;\nn\nf\n=\n91and\nn\ng\n=\n24\n;\n622are\nthenumberofsamplesusedtoestimatethestatisticsfor\nf\nand\ng\n,respectively.Thatis,therewere\n91matchedvehiclepairsand24,622unmatchedpairs.(Therealwaysaremanymoreunmatched\npairs.)Section\n8\ndescribeshowthedistributionsinFigure\n8\nareestimated.\n5Optimalunconstrainedmatching\nWeevaluatetheperformanceof\n\nminD\nandtheunconstrainedMAP(maximumaposteriori)matching\nfunction,\n\nuMAP\n,later.Thesematchingfunctionsare\nunconstrained\nsincenorestrictionis\nplacedontheassignment:\n\n(\nD\n)\n:\nf\n1\n;\n\n;\nN\ng!f\n1\n;\n\n;\nM\n;\nt\ng\n:\nInparticular,thematchingfunctionpermitsavehicletoovertakeothervehiclesinfrontofit,even\nthough,asinthecaseofasinglearteriallink,thisisunlikely.Matchingfunctionsconsideredinthe\n'b'13\nFigure8:Theempiricalpdfs\nf\nand\ng\nandtheirGaussianapproximationsforlinks\nA\n!\nB\n,\nB\n!\nC\nand\nC\n!\nD\n.\nliteratureareunconstrained.Inthenextsectionweconsiderconstrainedmatchingfunctions,which\ndonotpermitovertaking.Suchaconstraintgreatlyimprovesperformance.\nthecumulativeandcomplementarydistributionfunctions\nG\n(\nd\n)=\nZ\nd\n0\ng\n(\nx\n)\ndx\n;\n\nG\n(\nd\n)=\n1\n\nG\n(\nd\n)\n:\nSimilarly\nF\n(\nd\n)\nand\n\nF\n(\nd\n)\n.\n5.1Minimumdistancematching\nTheorem\n5.1\ngivestheperformanceoftheminimumdistancematchingfunction,\n\nminD\n.Itisproved\nintheAppendix.\nTheorem5.1\nTheprobabilityofacorrectmatch,\nminD\n(\ni\n)=\n\n\n(\ni\n)\n,is\np\n(\n\nminD\n(\nD\n)(\ni\n)=\nj\nj\n\n\n(\ni\n)=\nj\n)=\nZ\nd\n\n0\nf\n(\nx\n)[\n\nG\n(\nx\n)]\nM\n\n1\ndx\n:\n(5)\nTheprobabilityofanincorrectmatch,\nminD\n(\ni\n)\n6\n=\n\n\n(\ni\n)\n,is\np\n(\n\nminD\n(\nD\n)(\ni\n)\n6\n=\nj\nj\n\n\n(\ni\n)=\nj\n)=(\nM\n\n1\n)\nZ\nd\n\n0\n[\n\nG\n(\nx\n)]\nM\n\n2\ng\n(\nx\n)\n\nF\n(\nx\n)\ndx\n:\n(6)\nTheprobabilitythatavehicleisunmatched,\nminD\n(\ni\n)=\nt\n,is\np\n(\n\nminD\n(\nD\n)(\ni\n)=\nt\nj\n\n\n(\ni\n)=\nj\n)=\n\nF\n(\nd\n\n)[\n\nG\n(\nd\n\n)]\nM\n\n1\n:\n(7)\nThethreeprobabilities(\n5\n)-(\n7\n)addupto\n1\n.\n'b'14\nTheorem\n5.1\nallowsustopredicthowtheperformancedependsonthethreshold\nd\n\nandthenumber\nM\nofpotentialvehiclematches.From(\n5\n)-(\n6\n),theprobabilitiesofbothcorrectandincorrectmatch\nincreaseas\nd\n\nincreases.Thus,asinhypothesistestinggenerally,theproperchoiceofthethreshold\nvaluemustcompromisebetweencorrectandincorrect\nSecond,from(\n5\n)-(\n6\n),theprobabilityofacorrectmatchdecreasesandtheprobabilityofanincorrect\nmatchincreasesas\nM\nincreases.Thisisintuitive:thelargeristhenumber\nM\nofpotentialmatches,\ntheworseistheperformanceoftheminimumdistancematchingfunction.Soonewaytoimprove\nthematchingalgorithmistoreduce\nM\n.Acommonwayofreducing\nM\nistoplaceanupperbound\nT\nonthelinktraveltimeandlimitthematchingofanupstreamvehicle\ni\ntothosedownstreamvehicles\nj\nforwhich\nt\nj\n\ns\ni\n\nT\n,e.g.,\nM.Ndoyeetal.\n(\n2008\n).\nThird,theprobabilityofavehiclebeingunmatcheddecreasesas\nd\n\nor\nM\nincreases.This,too,is\nintuitive:alarger\nd\n\nimpliesalessstringentconditiononmatching,whilealarger\nM\nincreasesthe\nchanceofapotentialmatch.\nFormulas(\n5\n)-(\n7\n)helpdeterminetherangeofvaluesof\nd\n\nand\nM\nforwhichthe\nschemegivessatisfactoryperformance.Figure\n9\nplotstheprobabilitiesofcorrectandincorrect\nmatchesusingtheGaussianapproximationsforthedistributions\nf\n;\ng\ninFigure\n8\nin(\n5\n),(\n6\n)forlink\nA\n!\nB\n.Foraperlanewof500vph,\nM\n=\n50correspondstoatimeintervalof6minutes,whichis\nthetraveltimewindowoverathree-milelonglinkatanaveragespeedof30mph.For\nd\n\n=\n0\n:\n15,the\nminimumdistancematchingfunctionispredictedtogive45%correctlymatched,25%incorrectly\nmatched,and30%unmatchedvehicles.\nFigure9:Probabilitiesofcorrectandincorrectmatchesof\n\nminD\nfordifferentvaluesof\nd\n\n;\nM\n.\n5.2UnconstrainedMAPmatching\n\nuMAP\nWeshallevaluatetheperformanceofanymatchingfunction\n\nbyits(normalized)\nreward\nr\n(\n\n)\n:\nr\n(\n\n)=\n1\nN\nE\nN\n\ni\n=\n1\n1\n(\n\n(\nD\n)(\ni\n)=\n\n\n(\ni\n))\n;\n(8)\ninwhich\n1\n(\n\n)\nistheindicatorfunction:\n1\n(\n\n(\nD\n)(\ni\n)=\n\n\n(\ni\n))=\n1if\n\n(\nD\n)(\ni\n)=\n\n\n(\ni\n)\n,and\n=\n0otherwise.\nThus\nr\n(\n\n)\nisthecorrectmatchingrate,thefractionofcorrectlymatchedvehiclesonaverage.\n'b"15\nToevaluatetheexpectationoperator\nE\nin(\n8\n)weneedthejointprobabilitydistributionon\n(\nD\n;\n\n\n)\n.\nSince\np\n(\nD\nj\n\n\n)\nisalreadyby(\n2\n)-(\n4\n)weonlyneedthe(prior)distributionof\n\n.Weassume\nthatthenumberofupstreamvehicles\nN\n=(\n1\n+\nb\n)\nM\nofwhich\nM\nvehiclescrossthedownstreamsen-\nsorand\nb\nM\nvehiclesturnbeforereachingthedownstreamsensor.Thus\nb\nistheturningprobability.\nSubjecttothisassumption,weimposeauniformdistributionon\n\n:\np\n(\n\n\n(\ni\n)=\nj\n)=\na\n;\nj\n=\n1\n;\n\n;\nM\n;\np\n(\n\n\n(\ni\n)=\nt\n)=\nb\n;\n(9)\nwith\nM\na\n+\nb\n=\n1.\nLet\n\n\ndenotethe\noptimal\norreward-maximizingmatchingfunction.Theorem\n5.2\nisprovedinthe\nAppendix.\nTheorem5.2\n\n\nisgivenby\n\n\n(\nD\n)(\ni\n)=\n\njifL\n(\nd\n(\ni\n;\nj\n))\n\nL\n(\nd\n(\ni\n;\nk\n))\n8\nk\n;\nL\n(\nd\n(\ni\n;\nj\n))\n\nb\n=\na\nt\nifL\n(\nd\n(\ni\n;\nk\n))\n<\nb\n=\na\n8\nk\n:\n(10)\nToimplement(\n10\n)weneed\nb\nor\na\n,sincethe\nd\n(\ni\n;\nj\n)\nand\nM\nareknownfromthedata.Inthepresent\ncontext,\nb\nistheturningprobability,whichmaybedeterminedfromobservationsorexperience.\nButanotherconsiderationmaygovernthechoiceof\nb\n.From(\n10\n)oneseesthatthelargeris\nb\n,the\nmorestringentistherequirementofamatch,andloweristheprobabilityofanincorrectmatch.So,\ndependingontheapplication,oneshouldchoosealargervaluefor\nb\n,ifthe`cost'ofanincorrect\nmatchishigh.\nObservethat\n\n\n(\nD\n)\nmaximizestheposteriorprobability\np\n(\n\n\nj\nD\n)=\np\n(\nD\nj\n\n\n)(\np\n(\n\n\n)\np\n(\nD\n)\n;\n(11)\nwithpriorprobability\np\n(\n\n\n)\ngivenby(\n9\n).So\n\n\n=\n\nuMAP\nisalsothe\n(unconstrained)maximuma\nposteriori(MAP)\nmatchingfunction.\nTheminimumdistancematching\n\nminD\nandunconstrainedMAPmatching\n\nuMAP\nhaveasimilar\nstructure.Onecalculatesastatisticforeachpair\n(\ni\n;\nj\n)\nofdownstreamandupstreamvehicles\nd\n(\ni\n;\nj\n)\ninthe\n\nminD\ncaseandthelikelihoodratio\nL\n(\nd\n(\ni\n;\nj\n))\ninthe\n\nuMAP\ncaseandmatches\ni\ntothe\nbest\nj\nintermsofthisstatistic,providedthatitmeetsathreshold.However,\n\nminD\ndoesnottakeinto\naccounttheuncertaintyinthedistancemeasurements,whereas\n\nuMAP\ndoes.\nIntuitively,correctmatchingofadownstreamvehicle\ni\ntooneoftheupstreamvehicles1\n;\n\n;\nM\nshouldbemoredifas\nM\nincreases.Thenextresultshowsthisisindeedthecase.Corollary\n5.1\ncanbecomparedwith(\n5\n).\n\nf\nL\n(\nl\n)=\np\n(\nL\n(\nd\n(\ni\n;\nj\n))=\nl\nj\n\n\n(\ni\n)=\nj\n)\nand\nG\nL\n(\nl\n)=\np\n(\nL\n(\nd\n(\ni\n;\nk\n))\n\nl\nj\n\n\n(\ni\n)\n6\n=\nk\n)\n;\n(12)\nthepdfof\nL\n(\nd\n(\ni\n;\nj\n))\nandthecumulativedistributionfunction(cdf)of\nL\n(\nd\n(\ni\n;\nk\n))\n,conditionalon\n\n\n(\ni\n)=\nj\n6\n=\nk\n.Thatis,\nf\nL\n(\nl\n)\nisthepdfof\nL\n(\nd\n)\nwhen\nd\nhaspdf\nf\n,and\nG\nL\n(\nl\n)\nisthecdfof\nL\n(\nd\n)\nwhen\nd\nhaspdf\ng\n.\n"b"16\nCorollary5.1\nThemaximumrewardisgivenbytheexplicitformula:\nr\n(\n\nuMAP\n)=\nM\na\nZ\n\nb\n=\na\nf\nL\n(\nl\n)[\nG\nL\n(\nl\n)]\nM\n\n1\ndl\n+\nb\n[\nG\nL\n(\nl\n)]\nM\n:\n(13)\nMoreover,\nr\n(\n\nuMAP\n)\ndecreasesasMincreases,keepingM\na\nand\nb\nconstant(M\na\n+\nb\n=\n1\n).\nProof\nSeeAppendix.\n\nRemarkontheGaussiancase\nIntheGaussiancase,\nf\n(\nd\n)=\n1\nq\n2\nps\n2\nf\nexp\n\n(\nd\n\n\nf\n)\n2\n2\ns\n2\nf\n;\ng\n(\nd\n)=\n1\nq\n2\nps\n2\ng\nexp\n\n(\nd\n\n\ng\n)\n2\n2\ns\n2\ng\n:\nHere\n\nf\nand\ns\nf\ndenotethemeanandstandarddeviationoftheGaussianpdf\nf\nwhile\n\ng\nand\ns\ng\ndenote\nanalogousquantitiesfor\ng\n.Tocharacterize\n\n\nitismoreconvenienttomaximizethe`log-likelihood'\nl\n(\nd\n)\ninsteadofthe`likelihood'\nL\n(\nd\n)\n:\nl\n(\nd\n)=\nln\nL\n(\nd\n)=\nln\ns\ng\ns\nf\n\n(\nd\n\n\nf\n)\n2\n2\ns\n2\nf\n+\n(\nd\n\n\ng\n)\n2\n2\ns\n2\ng\n:\nItiseasytocheckbydifferentiatingthisquadraticexpressionthat\nl\n(\nd\n)\nis\ndecreasing\nin\nd\nfor0\n\nd\n\n\ng\nfortheestimatedparametersofFigure\n8\n.Thusinthisrangemaximizing\nl\n(\nd\n)\nisequivalent\ntominimizing\nd\n.Since\n[\n0\n;\n\ng\n]\nislikelytoincludetherange\nL\n(\nd\n(\ni\n;\nj\n))\n\nb\n=\na\n(in(\n10\n)),thismeans\nthat\n\n\ncoincideswith\n\nminD\n(withanappropriatethreshold).\n6Optimalconstrainedmatching\nMinimumdistance\n\nminD\n,andunconstrainedMAP\n\nuMAP\n,andthematchingsin(\nRitchieetal.\n(\n2002\n);\nM.Ndoyeetal.\n(\n2008\n))areexamplesofunconstrainedmatching.Unconstrainedmatch-\ningmayviolatetwoconstraints.First,amatchingmayallowduplicates:twodifferentupstream\nvehicles\ni\n1\n6\n=\ni\n2\nmaybematchedtothesamedownstreamvehicle\nj\n.Second,amatchingmaypermit\novertaking:anupstreamvehicle\ni\n2\nwhichfollows\ni\n1\n,\ni\n2\n>\ni\n1\n,maybematchedtodownstreamvehi-\ncles\nj\n1\n,\nj\n2\ninthereverseorder,\nj\n1\n>\nj\n2\n.A\nconstrained\nmatchingshouldnotallowduplicatesandit\nshouldnotpermitovertaking.\nSupposethedatacompriseasequenceofupstreamvehiclesignatures\nX\ni\n,\ni\n=\n1\n;\n\n;\nN\nandasequence\nofdownstreamvehiclesignatures\nY\nj\n,\nj\n=\n1\n;\n\n;\nM\n.A\nconstrainedmatching\nisapairofmatched\nsequenceslike\n(\nUp\n;\nDown\n)\n:\nUp\n=\nX\n1\nt\nX\n2\nX\n3\nX\n4\nX\n5\nX\n6\n#######\nDown\n=\nt\nY\n1\nY\n2\nt\nY\n3\nY\n4\nY\n5\n(14)\nTheinterpretationof(\n14\n)isthattheupstreamvehicleswithsignatures\nX\n2\n,\nX\n4\n,\nX\n5\nand\nX\n6\narere-\nspectivelymatchedwiththedownstreamvehicleswithsignatures\nY\n2\n,\nY\n3\n,\nY\n4\nand\nY\n5\n;theupstream\nvehicleswithsignatures\nX\n1\nand\nX\n3\narematchedwith\nt\n,meaningthatthesevehiclesturnedbefore\nreachingthedownstreamsensor(orareunmatchedforsomeotherreason);andthedownstreamve-\nhiclewithsignature\nY\n1\nismatchedwith\nt\n,meaningthisvehicleturnedintothelinkwithoutcrossing\n"b"17\ntheupstreamsensorbutitdidcrossthedownstreamsensor.Notethatin(\n14\n)onecandistinguish\nthetwotypesofturns.\nIngeneral,aconstrainedmatching\n(\nUp\n;\nDown\n)\nisapairofequallengthsequences,comprisingthe\noriginalsignaturesequences,\nX\n1\n;\n\n;\nX\nN\nand\nY\n1\n;\n\n;\nY\nM\n,togetherwitharbitrarilymanyinsertionsof\nt\nwithinthesesequences,withtherestrictionthatanoccurrenceof\nt\nin\nUp\ncanonlybematchedwith\na\nY\nj\nin\nDown\nanda\nt\nin\nDown\ncanonlybematchedwitha\nX\ni\nin\nUp\n.Observethatinaconstrained\nmatchingthematchesoftheform\nY\nj\n!\nt\naredeterminedonceallmatchesoftheform\nX\ni\n!\nY\nj\nand\nX\ni\n!\nt\nare\nWewantto\n\ncMAP\n,the\nmaximumaposteriori\n(MAP)matchingfunctionfortheconstrained\ncase.\n\ncMAP\nmaximizestheposteriorprobability\np\n(\n\n\nj\nD\n)=\np\n(\nD\nj\n\n\n)\np\nc\n(\n\n\n)\np\n(\nD\n)\n;\n(15)\ninwhich\np\nc\n(\n\n\n)\ndenotesthepriorprobabilitythat\n\nisthetrueconstrainedmatching.In(\n15\n),\np\n(\nD\nj\n\n\n)\nisgivenbythesignaturedistancemodel(\n2\n)-(\n4\n),soweonlyneedtoouttheprior\np\nc\n(\n\n\n)\n,\nwhichisjusttheunconstrainedprior\np\n(\n\n\n)\ngivenin(\n9\n),conditionedbytherequirementthat\n\nisa\nconstrainedmatching.Thatis,\np\nc\n(\n\n\n)=\n(\np\n(\n\n\n)\n=\n\n\n\n2\nM\nc\np\n(\n\n\n)\n\n\n2\nM\nc\n0\n\n62\nM\nc\n;\n(16)\ninwhich\nM\nc\ndenotesthesetofconstrainedmatchings.Thus\n\ncMAP\nisgivenby\n\ncMAP\n=\nargmax\n\n\n2\nM\nc\np\n(\nD\nj\n\n\n)\np\n(\n\n\n)\np\n(\nD\n)\n=\nargmax\n\n\n2\nM\nc\np\n(\nD\nj\n\n\n)\np\n(\n\n\n)\n:\nThelastequalityfollowsfromthefactthat\np\n(\nD\n)=\n\n\n\n2\nM\nc\np\n(\nD\nj\n\n\n)\np\n(\n\n\n)\ndoesnotdependon\n\n.\nRecallthattheunconstrainedprioristheuniformdistributionon\n\nwithturningprobability\nb\n:\np\n(\n\n\n)=\n\ni\np\n(\n\n\n(\ni\n))\n;\np\n(\n\n\n(\ni\n)=\nj\n)=\na\n;\nj\n=\n1\n;\n\n;\nM\n;\np\n(\n\n\n(\ni\n)=\nt\n)=\nb\n;\n(17)\nwith\nM\na\n+\nb\n=\n1.Using(\n2\n)-(\n4\n)and(\n17\n)gives\np\n(\nD\nj\n\n\n)\np\n(\n\n\n)=\n\ni\np\n(\nD\ni\nj\n\n\n(\ni\n))\np\n(\n\n\n(\ni\n))\n;\n(18)\np\n(\nD\ni\nj\n\n\n(\ni\n))\np\n(\n\n\n(\ni\n))=\n\nL\n(\nd\n(\ni\n;\nj\n))\ng\n(\nD\ni\n)\na\n\n\n(\ni\n)=\nj\ng\n(\nD\ni\n)\nb\n\n\n(\ni\n)=\nt\n:\n(19)\nTo\n\ncMAP\nwemustmaximizethelikelihood(\n18\n)overtheset\nM\nc\n.Itwillbemoreconvenientto\nminimizethenegative`log-likelihood',\n\nln\np\n(\nD\nj\n\n\n)\np\n(\n\n\n)=\n\n\ni\nln\np\n(\nD\ni\nj\n\n\n(\ni\n))\n\nln\np\n(\n\n\n(\ni\n))\n=\n\ni\n\nj\nl\n(\ni\n;\nj\n)\n1\n(\n\n\n(\ni\n)=\nj\n)+\n\ni\nl\n(\ni\n;\nt\n)\n1\n(\n\n\n(\ni\n)=\nt\n)\n;\n(20)\ninwhich\n1\n(\n\n)\ndenotestheindicatorfunctionand\nl\n(\ni\n;\nj\n)=\n\nln\nL\n(\nd\n(\ni\n;\nj\n))\n\nln\ng\n(\nD\ni\n)\n\nln\na\n;\n(21)\nl\n(\ni\n;\nt\n)=\n\nln\ng\n(\nD\ni\n)\n\nln\nb\n:\n(22)\n"b"18\nThusto\n\ncMAP\nwemustminimizethelinearform(\n20\n)overthecombinatorialconstraint\n\n\n2\nM\nc\n.Thedifistoaconvenientrepresentationof\nM\nc\n.\nWenowdescribeagraph\nG\n(\nN\n;\nM\n)\nwhosepathsareinone-onecorrespondencewiththeset\nM\nc\nof\nallconstrainedmatchings.\nG\n(\nN\n;\nM\n)\ncomprises\n(\nN\n+\n1\n)\n\n(\nM\n+\n1\n)\nnodesarrangedintheformof\nagridliketheoneshowninFigure\n10\n,whichisthegraphforexample(\n14\n)with\nN\n=\n6\n;\nM\n=\n5.\nG\n(\nN\n;\nM\n)\niscalledthe\neditgraph\nintheliteratureonsequencecomparisonalgorithmsincomputer\nscienceandmolecularbiology\nMyers\n(\n1986\n).\nFigure10:Theeditgraphforexample(\n14\n).Adiagonaledgecorrespondstoasignaturematch;a\nhorizontalorverticaledgecorrespondstoaturn(matchwith\nt\n).\nG\n(\nN\n;\nM\n)\nisconstructedasfollows.Itsnodesarelabeled\n(\ni\n;\nj\n)\n;\n0\n\ni\n\nN\n;\n0\n\nj\n\nM\n.Anode\n(\ni\n\n1\n;\nj\n\n1\n)\nhasthreedirectededgesconnectedtonodes\n(\ni\n\n1\n;\nj\n)\n,\n(\ni\n;\nj\n\n1\n)\nand\n(\ni\n;\nj\n)\n(unless\ni\n>\nN\nor\nj\n>\nM\n).The`diagonal'edge\n(\ni\n\n1\n;\nj\n\n1\n)\n!\n(\ni\n;\nj\n)\nindicatesthematch\nX\ni\n!\nY\nj\n;the`horizontal'\nedge\n(\ni\n\n1\n;\nj\n\n1\n)\n!\n(\ni\n;\nj\n\n1\n)\nindicatesthematch\nX\ni\n!\nt\n(vehicle\ni\ndidnotcrossthedownstream\nsensor);the`vertical'edge\n(\ni\n\n1\n;\nj\n\n1\n)\n!\n(\ni\n\n1\n;\nj\n)\nindicatesthematch\nY\nj\n!\nt\n(vehicle\nj\ndidnot\ncrosstheupstreamsensor).\nItisanobviousbutveryimportantfactthateachpathin\nG\n(\nN\n;\nM\n)\nfromnode\n(\n0\n;\n0\n)\nto\n(\nN\n;\nM\n)\ncor-\nrespondstoaconstrainedmatching(noduplicates,noovertaking)andviceversa.Theconstrained\nmatching(\n14\n)correspondstothepathinFigure\n10\nindicatedbythethickdashedlines.\nHavingconstrainedmatchingswithpathsintheeditgraph,weidentify(\n20\n)withthesum\noftheweightsoftheedgesalongthepath,assigningedgeweightsaccordingto\nw\n((\ni\n\n1\n;\nj\n\n1\n)\n!\n(\ni\n;\nj\n))=\nl\n(\ni\n;\nj\n)\nw\n((\ni\n\n1\n;\nj\n\n1\n)\n!\n(\ni\n;\nj\n\n1\n))=\nl\n(\ni\n;\nt\n)\nw\n((\ni\n\n1\n;\nj\n\n1\n)\n!\n(\ni\n\n1\n;\nj\n))=\n0\n:\n(23)\nEvidently,thevalue(\n20\n)foranyconstrainedmatching\n\nisequaltotheweightofthecorresponding\npathasthesumoftheedgeweights)intheeditgraph.Thus\n\ncMAP\nisequivalentto\ntheminimumweightpath.\n"b'19\nTheminimumweightpathcanbefoundviathealgorithmdescribedinTable\n2\n,whichrecursively\ncomputes\nW\n(\ni\n;\nj\n)\n,theweightoftheshortestpathfromnode\n(\n0\n;\n0\n)\ntonode\n(\ni\n;\nj\n)\n;inparticular\nW\n(\nN\n;\nM\n)=\nmin\n\nW\n(\n\n)\n:\nThearray\nE\n(\ni\n;\nj\n)\ncanbeusedtobacktrackandrecovertheshortestpathor\n\nminW\n.Thealgorithm\nrequiresasinglepassthroughallthe\nMN\nnodestakenintopologicalorder,soitscomplexityis\nO\n(\nMN\n)\n.\nW\n(\n0\n;\n0\n)\n \n0.\nFor\nj\n \n1to\nM\ndo\nW\n(\n0\n;\nj\n)\n \nW\n(\n0\n;\nj\n\n1\n)+\nw\n((\n0\n;\nj\n\n1\n)\n!\n(\n0\n;\nj\n))\n.\nFor\ni\n \n1to\nN\ndo\nW\n(\ni\n;\n0\n)\n \nW\n(\ni\n\n1\n;\n0\n)+\nw\n((\ni\n\n1\n;\n0\n)\n!\n(\ni\n;\n0\n))\n.\nFor\ni\n \n1to\nN\ndo\nFor\nj\n \n1to\nM\ndo\nf\nW\n(\ni\n;\nj\n)\n \nmin\nf\nW\n(\ni\n\n1\n;\nj\n)+\nw\n((\ni\n\n1\n;\nj\n)\n!\n(\ni\n;\nj\n))\n;\nW\n(\ni\n;\nj\n\n1\n)+\nw\n((\ni\n;\nj\n\n1\n)\n!\n(\ni\n;\nj\n))\n;\nW\n(\ni\n\n1\n;\nj\n\n1\n)+\n+\nw\n((\ni\n\n1\n;\nj\n\n1\n)\n!\n(\ni\n;\nj\n))\ng\n;\nE\n(\ni\n;\nj\n)\n \nargmin\nf\nW\n(\ni\n\n1\n;\nj\n)+\nw\n((\ni\n\n1\n;\nj\n)\n!\n(\ni\n;\nj\n))\n;\nW\n(\ni\n;\nj\n\n1\n)+\nw\n((\ni\n;\nj\n\n1\n)\n;\n(\ni\n;\nj\n))\n;\nW\n(\ni\n\n1\n;\nj\n\n1\n)+\n+\nw\n((\ni\n\n1\n;\nj\n\n1\n)\n!\n(\ni\n;\nj\n))\ng\n;\ng\nTable2:Shortestpathalgorithmfor\n\ncMAP\n.\nAsevidentinFigure\n10\n,fromtheshortestpathonecanreadoffthevehiclesthatare\nX\ni\n!\nY\nj\n.Sinceweknowthetimes\ns\ni\n;\nt\nj\nwhenthesevehiclescrossedthetwosensors,weknow\ntheirtraveltime\nT\ni\n=\nt\nj\n\ns\ni\n.Onecanalsoreadoffwhichvehiclesweredeclaredtohavecrossed\ntheupstreamsensorbutnotthedownstreamsensor(thesearethehorizontaledgesinthepath)and\nwhichvehiclesweredeclaredtohavecrossedtheupstreamsensorbutnotthedownstreamsensor\n(thesearetheverticaledges).\nTheresultsinSection4arebasedonthisshortestpathalgorithm.Figure\n7\nillustratestheresultfor\nlink\nC\n!\nD\n.Approximately250vehiclescrossedthislinkin30min.Thehorizontaledgesinthe\nshortestpatharepresumablyvehiclesthatcrossedthesensorat\nC\nbutnotat\nD\n;theverticaledges\narevehiclesthatcrossed\nD\nbutnot\nC\n.\nImplementationofthealgorithmrequirestheedgeweights,whichinturnrequireknowingtheGaus-\nsiandistributions\nf\n;\ng\nofFigure\n8\nandtheturningprobability\nb\n.Weconsidertheseinturn.\nSection\n8\nexplainshowthedistributionsareobtainedthroughaniterativeprocedure.Theiteration\nstartsfromaninitialmatching,whichisobtainedbyashortestpathalgorithmapplied\ntoedgeweightsobtaineddirectlyfromthedistancematrix\nD\n=\nf\nd\n(\ni\n;\nj\n)\ng\n.Thatalgorithmcalled\nsaturationmethod\nworksasfollows:\nStep1.Thedistancematrixisscannedandvalues\nd\n(\ni\n;\nj\n)\n>:\n75aresetto\n:\n75.(Thesignalprocessing\nstepassignsdistancevaluesbetween0and1.)Calltheresultingmatrix\nDM\n.\nStep2.Theshortestpathiscalculatedwiththisiterationrule:\nD\n(\ni\n;\nj\n)=\nmin\nf\nD\n(\ni\n\n1\n;\nj\n\n1\n)+\n2\n\nDM\n(\ni\n;\nj\n)\n;\nD\n(\ni\n\n1\n;\nj\n)+\nDM\n(\ni\n;\nj\n)\n;\nD\n(\ni\n;\nj\n\n1\n)+\nDM\n(\ni\n;\nj\n)\ng\ninwhich\nD\n(\ni\n;\nj\n)\nisthecostoftheshortestpathfromnode\n(\n0\n;\n0\n)\ntonode\n(\ni\n;\nj\n)\n.\nAsintheunconstrainedcase,thechoiceof\nb\nisdeterminedbyexperienceorobservation.More\nimportantly,thechoiceof\nb\ncontrolstheprobabilitythat\n\ncMAP\nmakesincorrectmatches:thelarger\n'b'20\nis\nb\n,thelowertheprobabilityofanincorrectmatch;butthelargeris\nb\n,thelowerisalsotheprob-\nabilityofacorrectmatch.Itispossibletoobtainaformulafortheexpectednumberofcorrect\nmatcheswith\n\ncMAP\nlikeformula(\n13\n)fortheperformanceof\n\nuMAP\n.Buttheformulafor\n\ncMAP\ninvolvesamulti-dimensionalintegralthatcannotbeevaluatedinclosedform(unlike(\n13\n))anditis\nnotpresentedhere.\nOfcoursetheperformanceof\n\ncMAP\nismuchbetterthanthatof\n\nuMAP\nbecauseoftherestrictionto\nconstrainedmatching.\n7Real-timematching\nAsformulatedinSection\n6\ntheeditgraphgrowswiththeobservationtimeinterval,andsowitheach\nnewupstreamordownstreamvehicle,oneneedstocalculatethedistanceofitssignaturefromall\nprevioussignatures.Theefforttocomputethesedistancesforeachnewvehiclegrowslinearlywith\ntheobservationinterval,whichisunsuitableforreal-timeimplementation.\nFigure11:Thedistancestobecalculatedinreal-timeimplementation.\nForreal-timeimplementation,wewanttorestrictthegrowthoftheeditgraph.Onewayofdoing\nthisisasfollows.Foreachnewupstreamvehicle\ni\n(withsignature\nX\ni\n)thatarrivesattime\ns\ni\ncompute\nthedistance\nd\n(\nX\ni\n;\nY\nk\n)\n:\nd\n(\ni\n;\nk\n)=\n\nd\n(\nX\ni\n;\nY\nk\n)\nif0\n\nt\nk\n\ns\ni\n\nT\nM\n\nelse\n:\n(24)\n'b'21\nForeachnewdownstreamvehicle\nj\n(withsignature\nY\nj\n)thatarrivesattime\nt\nj\ncomputethedistance\nd\n(\nX\nm\n;\nY\nj\n)\n:\nd\n(\nm\n;\nj\n)=\n\nd\n(\nX\nm\n;\nY\nj\n)\nif0\n\nt\nj\n\ns\nm\n\nT\nM\n\nelse\n:\n(25)\nIf\nT\nM\nisanupperboundonthetraveltime,(\n24\n)-(\n25\n)musthold.Thedistances\nd\n(\nX\ni\n;\nY\nj\n)\ntobe\ncalculatedarethusboundedbythedashedlinesinFigure\n11\n.Sothecomputationalburdenforeach\nnewupstreamordownstreamvehicleisessentiallyconstant.\nAsimplechoicefor\nT\nM\nwouldbetoassumeaminimumspeedandtake\nT\nM\ntobethecorresponding\ntraveltime,whichrequiresknowledgeofthelinklength,cycletimes,etc.Abetterideaisthis.Let\n\nbetheshortestpathmatchinguntilthecurrenttime.Pickaninteger\nM\n.Let\ni\n1\n;\n\n;\ni\nM\nbethemost\nrecent\nM\nmatcheddownstreamvehicles,andset\nT\nM\n=\n2\n\nmax\nf\nt\n\n(\ni\nm\n)\n\ns\ni\nm\n;\n1\n\nm\n\nM\ng\n:\nThus\nT\nM\nistwicethemaximumtraveltimeexperiencedbythese\nM\nvehicles.Thischoicewill\nautomaticallyadapttochangesintraveltime.\n8Estimatingthestatisticalmodel\nThestatisticalmodel(\n2\n)-(\n4\n)parameterizestheprobabilitydensityoftheobservationmatrix\nD\nas\np\n(\nD\nj\n\n\n;\n\nf\n;\ns\nf\n;\n\ng\n;\ns\ng\n)\n,withparameter\n\nforthetruematching,and\n(\n\nf\n;\n\n;\ns\ng\n)\nforthefourparam-\netersoftheGaussiandistributionsof\nf\n;\ng\n.\nIdeallytheoptimummatchingandtheparametersof\nf\n;\ng\nshouldbejointlydeterminedasthemaxi-\nmumlikelihoodestimate\n(\n\n\n\n;\n\n\nf\n;\n\ns\nf\n;\n\n\ng\n;\n\ns\ng\n)=\nargmax\n\n\n;\n\nf\n;\ns\nf\n;\n\ng\n;\ns\ng\np\n(\nD\nj\n\n\n;\n\nf\n;\ns\nf\n;\n\ng\n;\ns\ng\n)\n:\n(26)\nWhile(\n26\n)isaoptimizationproblem,itiscomputationallyveryexpensivetosolve\nbecauseofthecombinatorialnatureofthevariable\n\n.Insteadweperformacoordinate-wiseopti-\nmization:\n1.\nBeginwithaninitialestimate\n\n0\n(whichwedousingthesaturationmethod).\n2.\nAtstep\ni\nwehavetheestimate\n\ni\n.Find\n(\n\ni\nf\n;\ns\ni\nf\n;\n\ni\ng\n;\ns\ni\ng\n)=\nargmax\n\nf\n;\ns\nf\n;\n\ng\n;\ns\ng\np\n(\nD\nj\n\n\ni\n;\n\nf\n;\ns\nf\n;\n\ng\n;\ns\ng\n))\n:\nThisstepiseasybecausethegivenmatch\n\ni\ndivideselementsoftheobservationmatrix\nD\ninto\ndistancesofpairsofmatchedandunmatchedvehicles,so\n(\n\ni\nf\n;\ns\ni\nf\n)\naretheempiricalmoments\nofthematchedpairsand\n(\n\ni\ng\n;\ns\ni\ng\n)\narecorrespondingvaluesfortheunmatchedpairs.\n3.\nUsetheoptimalmatchingalgorithmto\n\n\ni\n+\n1\n=\nargmax\n\n\np\n(\nD\nj\n\n\n;\n\ni\nf\n;\ns\ni\nf\n;\n\ni\ng\n;\ns\ni\ng\n)\n;\nandreturnto2.with\ni\n+\n1.\nSincethelikelihood\np\n(\nD\nj\n\n\ni\n;\n\ni\nf\n;\ns\ni\nf\n;\n\ni\ng\n;\ns\ni\ng\n)\nincreaseswith\ni\n,theiterationmustconvergetoalocal\nmaximumofthelikelihood.Forthetestresultstheiterationsconvergedinthreetofoursteps.\n'b'22\n9Conclusion\nAprocedureisdescribedforthereal-timeestimationofthedistributionoftraveltimeacrossan\narterialsegmentwithseveralintersections.Theschemereliesonofvehiclesig-\nnaturesfromwirelessmagneticsensors.Theprocedureistestedfora0.9-milesegmentwithsix\nintersections.Theprocedurerequiresnomeasurementofvehiclespeedorsignalphaseinformation.\nMatchedvehicleresultsyieldsignalphase,queuesatstopbars,numberofvehiclesinthelink,and\notherarterialperformancemeasures,inadditiontotraveltimeanddelaydistributions.\nTheschemecanbeusedinanoff-oron-rampforthereal-timeestimationofthenumberofvehicles\nwithintherampandtherampdelayexperiencedbyeveryvehicle.Theschemecanalsobeused\ntwodeterminethenumberofvehiclesbetweentwolocationsonafreewayinordertoestimatetrue\nspatialdensity.Thesepropertiesmakedeploymentoftheschemeimmediatelypracticable.\nTheprocedureisbasedonastatisticalmodelofsignaturedistance,whoseparametersarethemselves\nestimatedfromthedata,sothat\nno\ngroundtruthmeasurementsareneeded.Themodelcanbeused\ntopredicttheratesofcorrect,incorrect,andmissedmatches.\nReferences\nB.Coifman.\nVehiclerandtraveltimemeasurementusingloopdetectorspeedtraps\n.\nPhDthesis,UniversityofCalifornia,Berkeley,Berkeley,CA94720,1999.\nA.Haoui,R.Kavaler,andP.Varaiya.Wirelessmagneticsensorsfortrafsurveillance.\nTrans-\nportationResearchPartC\n,16:294306,2008.\nF.B.LinandD.R.Thomas.Headwaycompressionduringqueuedischargeatsignalizedintersec-\ntions.\nTransportationResearchRecord\n,(1920):8185,2005.\nH.X.LiuandW.Ma.Avirtualvehicleprobemodelfortime-dependentarterialtraveltimeestima-\ntion.SubmittedforPublication,2008.\nM.Ndoye,V.Totten,B.Carter,D.M.Bullock,andJ.V.Krogmeier.Vehicledetectorsignaturepro-\ncessingandvehiclefortraveltimeestimation.In\nProceedingsof88thTransporta-\ntionResearchBoardAnnualMeeting\n,Washington,D.C.,January2008.\nE.W.Myers.An\nO\n(\nND\n)\ndifferencealgorithmanditsvariations.\nAlgorithmica\n,1:251266,1986.\nC.OhandS.G.Ritchie.Real-timeinductive-signature-basedlevelofserviceforsignalizedinter-\nsections.\nTransportationResearchRecord\n,(1802):97104,2002.\nS.G.Ritchie,S.Park,C.Oh,andC.Sun.Fieldinvestigationofadvancedvehicle\ntiontechniquesanddetectortechnologiesphase1.TechnicalReportPATHResearchReport\nUCB-ITS-PRR-2002-15,InstituteofTransportationStudies,UniversityofCalifornia,Berkeley,\nCalifornia,2002.\nA.SkabardonisandN.Geroliminis.Real-timeestimationoftraveltimesalongsignalizedarterials.\nInH.S.Mahmassani,editor,\nProceedingsofthe16thInternationalSymposiumonTransportation\nandTrafTheory\n,pages387406.Elsevier,2005.\n'b"23\nC.Sun,S.G.Ritchie,K.Tsai,andR.Jayakrishnan.Useofvehiclesignatureanalysisandlexi-\ncographicoptimizationforvehiclereidenticationonfreeways.\nTransportationResearch,C\n,7:\n167185,1999.\nC.C.Sun,G.S.Arr,R.P.Ramachandram,andS.G.Ritchie.Vehicleusingmultide-\ntectorfusion.\nIEEETransactionsonIntelligentTransportationSystems\n,5(3):155164,September\n2004.\nH.M.Zhang.Link-journey-speedmodelforarterialtraf\nTransportationResearchRecord\n,(1676):\n109115,1999.\nJ.Zheng,Y.Wang,andN.L.Nihan.Detectingcyclefailuresatsignalizedintersectionsusingvideo\nimageprocessing.\nComputer-AidedCivilandInfrastructureEngineering\n,21:425435,2006.\nAppendix\nSignalprocessingalgorithm\nAsmentionedinthetext,asensorcomprisesanarrayofsevennodes,eachofwhichhasathree-axis\nmagnetometerthatmeasuresthe\nx\n;\ny\n;\nz\ndirectionsoftheearth'smagneticatasamplingrateof\n128Hzasavehiclegoesoverthenode.Figure\n12\nshowstheraw\nz\n-axismeasuredsignalfromone\nnode.The\nx\n-and\ny\n-axissignalsaresimilar.\nThemicroprocessorinthenodeautomaticallyextractsthesequenceofpeakvalues(localmaxima\nandminima)fromeachofthe\nx\n;\ny\n;\nz\nsignals.(Thetimeswhenthepeaksoccurarenotrecorded.)\nIntheexample,therearesixpeakvalues(includingtheinitialandterminalvaluesofthesignal),\ndenotedbysquares.Thenodetransmitsthearrayofthesepeakvaluestotheaccesspoints(AP).\nTherewillbethreesucharrays,correspondingtothethreeaxes.Together,thethreearraysconstitute\na\nslice\nofthetwo-dimensionalmagnetic`footprint'ofthevehicle.\nAslicemeasuredbyanodeisdeterminedbythedistributionoftheferrousmaterialinthevehicle\nwithin12fromthenode.Foreachvehicle,theAPreceivesoneslicefromeachofthesevennodes.\nThesevenslicesconstitutethevehicle'ssignatureatthesensor.\nThesignalprocessingalgorithmtakestwosignatures,say\nX\n=(\nX\n1\n;\n\n;\nX\n7\n)\nand\nY\n=(\nY\n1\n;\n\n;\nY\n7\n)\n(\nX\ni\n;\nY\nj\naretheslices),andcomputesadistance(ameasureofdissimilarity)betweeneachpairof\nslices.Thedistance\nd\n(\nX\n;\nY\n)\nisastheminimumofthedistancesbetweenallpairsofslices\n(\nX\ni\n;\nY\nj\n)\n.\nProofofTheorem\n5.1\nApplyingthe(\n1\n)andusing(\n2\n),theprobabilityofacorrectmatch,\n\nminD\n(\ni\n)=\n\n\n(\ni\n)\n,is\np\n(\n\nminD\n(\nD\n)(\ni\n)=\nj\nj\n\n\n(\ni\n)=\nj\n)=\np\n(\nd\n(\ni\n;\nj\n)\n\nd\n(\ni\n;\nk\n)\n8\nk\n;\nd\n(\ni\n;\nj\n)\n\nd\n\nj\n\n\n(\ni\n)=\nj\n)\n=\nZ\nd\n\n0\np\n(\nd\n(\ni\n;\nj\n)=\nx\nj\n\n\n(\ni\n)=\nj\n)\n\nk\n6\n=\nj\nProb\n(\nd\n(\ni\n;\nk\n)\n\nx\nj\n\n\n(\ni\n)=\nj\n)\ndx\n=\nZ\nd\n\n0\nf\n(\nx\n)[\n\nG\n(\nx\n)]\nM\n\n1\ndx\n:\n"b'24\nFigure12:Theraw\nz\n-axismagneticsignalgeneratedbyavehicle;thesquaresdenotethepeaks\nextractedfromthesignal.\nTheprobabilityofanincorrectmatchis\np\n(\n\nminD\n(\nD\n)\n6\n=\nj\nj\n\n\n(\ni\n)=\nj\n)=\np\n(\nd\n(\ni\n;\nj\n)\n>\nmin\nk\n6\n=\nj\nd\n(\ni\n;\nk\n)\n;min\nk\n6\n=\nj\nd\n(\ni\n;\nk\n)\n\nd\n\nj\n\n\n(\ni\n)=\nj\n)\n=\nZ\nd\n\n0\nProb\n(\nd\n(\ni\n;\nj\n)\n>\nx\nj\n\n\n(\ni\n)=\nj\n)\np\n(\nmin\nk\n6\n=\nj\nd\n(\ni\n;\nk\n)=\nx\nj\n\n\n(\ni\n)=\nj\n)\ndx\n=(\nM\n\n1\n)\nZ\nd\n\n0\n[\n\nG\n(\nx\n)]\nM\n\n2\ng\n(\nx\n)\n\nF\n(\nx\n)\ndx\n:\nToarriveatthelastequality,weusethefactsthat\nProb\n(\nd\n(\ni\n;\nj\n)\n>\nx\nj\n\n\n(\ni\n)=\nj\n)=\n\nF\n(\nx\n)\nand\nProb\n(\nmin\nk\n6\n=\nj\nd\n(\ni\n;\nk\n)\n\nx\nj\n\n\n(\ni\n)=\nj\n)=\n1\n\nProb\n(\nd\n(\ni\n;\nk\n)\n\nx\n;\nk\n6\n=\nj\nj\n\n\n(\ni\n)=\nj\n)=\n1\n\n[\n\nG\n(\nx\n)]\nM\n\n1\n;\nwhich,upondifferentiatingwithrespectto\nx\n,givesthedensity\np\n(\nmin\nk\n6\n=\nj\nd\n(\ni\n;\nk\n)=\nx\nj\n\n\n(\ni\n)=\nj\n)=(\nM\n\n1\n)[\n\nG\n(\nx\n)]\nM\n\n2\ng\n(\nx\n)\n:\nLastly,theprobabilitythat\n\nminD\n(\ni\n)=\nt\nis\np\n(\n\nminD\n(\nD\n)(\ni\n)=\nt\nj\n\n\n(\ni\n)=\nj\n)=\np\n(\nd\n(\ni\n;\nj\n)\n\nd\n\n;\nd\n(\ni\n;\nk\n)\n\nd\n\n;\nk\n6\n=\nj\nj\n\n\n(\ni\n)=\nj\n)\n=\n\nF\n(\nd\n\n)[\n\nG\n(\nd\n\n)]\nM\n\n1\n:\nThisproves(\n5\n)-(\n7\n).\n\nProofofTheorem\n5.2\n'b'25\nForanymatchingfunction\n\n,wecanexpress\nr\n(\n\n)\nas\nN\nr\n(\n\n)=\nN\n\ni\n=\n1\n\nM\n\nj\n=\n1\np\n(\n\n(\nD\n)(\ni\n)=\nj\nj\n\n\n(\ni\n)=\nj\n)\np\n(\n\n\n(\ni\n)=\nj\n)\n+\np\n(\n\n(\nD\n)(\ni\n)=\nt\nj\n\n\n(\ni\n)=\nt\n)\np\n(\n\n\n(\ni\n)=\nt\n)\n\n(27)\n=\nN\n\ni\n=\n1\n\na\nM\n\nj\n=\n1\nZ\np\n(\n\n(\nD\n)(\ni\n)=\nj\nj\nD\n)\np\n(\nD\nj\n\n\n(\ni\n)=\nj\n)\ndD\n+\nb\nZ\np\n(\n\n(\nD\n)(\ni\n)=\nt\nj\nD\n)\np\n(\nD\nj\n\n\n(\ni\n)=\nt\n)\ndD\n\n:\n(28)\nFrom(\n2\n)-(\n4\n)and(\n9\n)\np\n(\nD\nj\n\n\n(\ni\n)=\nj\n)=\np\n(\nD\ni\nj\n\n\n(\ni\n)=\nj\n)\np\n(\nD\n\ni\n)=\nL\n(\nd\n(\ni\n;\nj\n))\ng\n(\nD\ni\n)\np\n(\nD\n\ni\n)\n;\np\n(\nD\nj\n\n\n(\ni\n)=\nt\n)=\ng\n(\nD\ni\n)\np\n(\nD\n\ni\n)\n;\ninwhich\np\n(\nD\n\ni\n)=\n\nl\n6\n=\ni\np\n(\nD\nl\n)\n.Substitutioninto(\n28\n)yields\nN\nr\n(\n\n)=\nN\n\ni\n=\n1\n\na\nM\n\nj\n=\n1\nZ\np\n(\n\n(\nD\n)(\ni\n)=\nj\nj\nD\n)\nL\n(\nd\n(\ni\n;\nj\n))\ng\n(\nD\ni\n)\np\n(\nD\n\ni\n)\ndD\n+\nb\nZ\np\n(\n\n(\nD\n)(\ni\n)=\nt\nj\nD\n)\ng\n(\nD\ni\n)\np\n(\nD\n\ni\n)\ndD\n\n;\n(29)\nWeseefrom(\n29\n)that\n\n\n(\nD\n)(\ni\n)\nisgivenbythat\nj\nwhichmaximizestheintegrand.Thisselection\nleadsto(\n10\n).\n\nProofofCorollary\n5.1\nFrom(\n27\n)\nN\nr\n(\n\n\n)=\nN\n\ni\n=\n1\n\na\nM\n\nj\n=\n1\np\n(\n\n\n(\nD\n)(\ni\n)=\nj\nj\n\n\n(\ni\n)=\nj\n)+\nb\np\n(\n\n(\nD\n)(\ni\n)=\nt\nj\n\n\n(\ni\n)=\nt\n)\n\n:\n(30)\nFrom(\n10\n)\np\na\n(\nM\n)=\np\n(\n\n\n(\nD\n)(\ni\n)=\nj\nj\n\n\n(\ni\n)=\nj\n)\n=\np\n(\nL\n(\nd\n(\ni\n;\nj\n))\n\nmax\nf\nL\n(\nd\n(\ni\n;\nk\n))\n;\nk\n6\n=\nj\n;\nb\n=\na\ngj\n\n\n(\ni\n)=\nj\n)\n(31)\np\nb\n(\nM\n)=\np\n(\n\n(\nD\n)(\ni\n)=\nt\nj\n\n\n(\ni\n)=\nt\n)=\np\n(\nb\n=\na\n\nmax\nf\nL\n(\nd\n(\ni\n;\nk\n))\ngj\n\n\n(\ni\n)=\nt\n)\n:\n(32)\nIn(\n31\n)-(\n32\n),therandomvariables\nd\n(\ni\n;\nj\n)\nand\nd\n(\ni\n;\nk\n)\nareindependent;\nd\n(\ni\n;\nj\n)\nisdistributedaccording\nto\nf\nandthe\nd\n(\ni\n;\nk\n)\narealldistributedaccordingto\ng\n.Therandomvariableontherighthandsideof\ntheinequalitiesin(\n31\n)-(\n32\n)increaseswith\nM\n,becauseitisthemaximumofmorerandomvariables,\nwhereastherandomvariableonthelefthandsidedoesnotchangewith\nM\n.Thusbothprobabilities\np\na\n(\nM\n)\nand\np\nb\n(\nM\n)\ndecreasewith\nM\n.So,from(\n30\n)\nr\n(\n\n\n)=\nM\na\np\na\n(\nM\n)+\nb\np\nb\n(\nM\n)\ndecreaseswith\nM\n.\nWecanuse(\n31\n),(\n32\n)tocalculate\nr\n(\n\n\n)\n.From(\n31\n),\np\na\n(\nM\n)=\np\n(\nL\n(\nd\n(\ni\n;\nj\n)\n\nmax\nk\n6\n=\nj\nL\n(\nd\n(\ni\n;\nk\n))\n;\nL\n(\nd\n(\ni\n;\nj\n)\n\nb\n=\na\nj\n\n\n(\ni\n)=\nj\n)=\nZ\n\nb\n=\na\nf\nL\n(\nl\n)[\nG\nL\n(\nl\n)]\nM\n\n1\ndl\n;\np\nb\n(\nM\n)=\np\n(\nmax\nk\nL\n(\nd\n(\ni\n;\nk\n)\n\nb\n=\na\nj\n\n\n(\ni\n)=\nt\n)=[\nG\nL\n(\nl\n)]\nM\n:\nThisgives(\n13\n).\n\n'