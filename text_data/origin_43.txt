b'PROSSER\netal.\n:PERSONRE-IDENTIFICATIONBYSUPPORTVECTORRANKING\n1\nPersonRe-IdenticationbySupportVector\n\nRanking\nBryanProsser\nbryan@eecs.qmul.ac.uk\nWei-ShiZheng\njason@eecs.qmul.ac.uk\nShaogangGong\nsgg@eecs.qmul.ac.uk\nTaoXiang\ntxiang@eecs.qmul.ac.uk\nQueenMaryVisionLaboratory,\n\nSchoolofElectronicEngineeringand\n\nComputerScience,\n\nQueenMary,UniversityofLondon,\n\nLondon,E14NS,U.K.\nAbstract\nSolvingthepersonre-idencationprobleminvolvesmatchingobservation\nsofindi-\nvidualsacrossdisjointcameraviews.Theproblembecomesparticularly\nhardinabusy\npublicsceneasthenumberofpossiblematchesisveryhigh.Thisisfurthe\nrcompounded\nbysigncantappearancechangesduetovaryinglightingconditions,vie\nwingangles\nandbodyposesacrosscameraviews.Toaddressthisproblem,existin\ngapproaches\nfocusonextractingorlearningdiscriminativefeaturesfollowedbytempla\ntematching\nusingadistancemeasure.Thenoveltyofthisworkisthatwereformulateth\nepersonre-\nidencationproblemasarankingproblemandlearnasubspacewhereth\nepotentialtrue\nmatchisgivenhighestrankingratherthananydirectdistancemeasure\n.Bydoingso,we\nconvertthepersonre-idencationproblemfromanabsolutescoringp\nroblemtoarela-\ntiverankingproblem.WefurtherdevelopannovelEnsembleRankSVM\ntoovercomethe\nscalabilitylimitationproblemsufferedbyexistingSVM-basedrankingmethod\ns.This\nnewmodelreducessigncantlymemoryusagethereforeismuchmore\nscalable,whilst\nmaintaininghigh-levelperformance.Wepresentextensiveexperime\nntstodemonstrate\ntheperformancegainoftheproposedrankingapproachoverexisting\ntemplatematching\nandclasscationmodels.\n1Introduction\nInter-cameraobjectassociation,knownas\nre-identication\n,enablestrackingofthesameob-\njectsthroughdifferentdisjointcamerasviewseitheron-t\nhe-yorretrospectively.Insmall\nscaleCCTVnetworks,thisproblemcanbeapproachedusingte\nmporalinformationandvi-\nsualappearancematching.However,inordertomatchindivi\ndualsoversignicantlydisjoint\nviewsinwhichthetemporaltransitiontimebetweencameras\nvariesgreatlyfromindividual\ntoindividualandwithagreatdealofuncertainty,theprobl\nemismadeharderasamodel\nmustnowrelyonappearancefeaturesalone.Furthermore,in\nter-cameravariationsinlight-\ningconditions,changesinobjectorientationandobjectpo\nseallmakethistasksubstantially\nharderstill.Figure\n1\ndemonstratesthedifcultiesarisingfrompersonre-ident\nicationin\nc\n\n2010.Thecopyrightofthisdocumentresideswithitsauthors\n.\nItmaybedistributedunchangedfreelyinprintorelectronic\nforms.\nBMVC 2010 doi:10.5244/C.24.21\n'b'2\nPROSSER\netal.\n:PERSONRE-IDENTIFICATIONBYSUPPORTVECTORRANKING\n(a)VIPeRDataset(b)i-LIDSDataset\nFigure1:(a)SampleimagepairsfromtheVIPeRdataset[\n6\n]and(b)thei-LIDSdataset\n(http://www.ilids.co.uk).Eachcolumnrepresentsamatch\ningpairofobservationswiththe\ntopandbottomrowsrepresentingdifferentcameraviews.\npublicspaceswhenappearancechangesbetweencameraviews\ncanrenderdifferentpeople\nalmostindistinguishable.\nInordertotacklethisproblem,mostexistingworkhasconce\nntratedoncompilingfeature\nsetsasatemplatetodescribeanindividual,followedbytem\nplatematchingusingadirect\ndistancemeasurechosenindependentlyfromthedata.Theco\nmmonfeaturesetsinclude\nmajorcolours[\n9\n],combinationsofcolourandtexture[\n10\n],orcomplexstructurallayouts\n[\n4\n].TypicaldistancemeasuresincludehistogrambasedBhatt\nacharyyadistance[\n10\n],K-\nNearestNeighbourclassiers[\n7\n],L1-Norm[\n12\n]ordistancemeasuresofrelativeproportions\nofcolours[\n9\n].Regardlessofthechoiceoffeaturesanddistancemeasure\ns,re-identication\nbythisapproachisdifcultbecausethereisoftentoomucho\nfanoverlapbetweenfeature\ndistributionsofdifferentobjects,somuchsothatgivenap\nrobeimage,anincorrectgallery\nimagecanappeartobemoresimilartotheprobethanacorrect\ngalleryimage.Figure\n1\nshowsthatincorrectmatchescanoftenappearalmostidenti\ncaltothecorrectmatch.Based\nontheassumptionthatcertainfeaturesaremoresuitablefo\nrmatchingthanothers,Grayand\nTao[\n5\n]proposedtouseAdaboosttosearchthroughalargefeatures\netforthosefeatures\nthataremorerelevant(morediscriminative)formorerelia\nblere-identication.However,\ntheirfeatureselectionbecomeslesseffectiveifobjectfe\naturedistributionsoverlapseverely\ninamulti-dimensionalfeaturespaceaseachoftheirweakle\narnersonlyaimstoseekthe\nmostrelevantfeaturesineachfeaturedimensionindepende\nntly,notacrosstheentiremulti-\ndimensionalfeaturespacecollaboratively.\nInthiswork,wepresentanovelreformulationofthepersonr\ne-identicationproblem.\nWhilepreviousapproacheshavelookedatthisproblemasacla\nssicationofcorrectvsincor-\nrectmatch,weproposeanapproachbasedontheinformationr\netrievalconceptofdocument\nranking[\n1\n].Textdocumentrankingaimstoproducearankedlistofrele\nvantdocuments\nbasedonauserqueryfordocumentsearch.Weconsiderthatpe\nrsonre-identicationgiven\nweaklydistinctive(heavilyoverlapped)visualappearanc\nehassimilarparallels.Givena\nqueryimage,wewishtondthoseobservedpeoplewhoaremost\nrelevant,withafocus\nonthehighestrankedperson.Themaindifferencebetweenth\nisapproachandpreviousper-\nsonre-identicationtechniquesisthatwearenotconcerne\ndwithcomparingdirectdistance\nscoresbetweencorrectandincorrectmatches.Instead,wea\nreonlyinterestedintherelative\nrankingofthesescoresthatreectstherelevanceofeachli\nkelymatchtothequeryimage.By\ndoingso,weconvertthepersonre-identicationproblemfr\nomanabsolutescoringproblem\n'b"PROSSER\netal.\n:PERSONRE-IDENTIFICATIONBYSUPPORTVECTORRANKING\n3\ntoarelativerankingproblem.Wethusavoidtheneedforseek\ningamaximumdistancescore\nandtheassumptionontheexistenceoflargedisparitiesbet\nweenthedistanceofatruematch\nandthoseofmismatches,northeneedforthresholding.\nRankingcanbebasedoneitherBoostingorkernelbasedlearn\ningsuchasSupportVector\nMachines(SVMs).RankBoost[\n3\n]usesasetofweakrankersboostedtoformastrong\nranker.However,asthere-identicationproblemintrinsi\ncallysuffersfromalargedegree\noffeatureoverlappinginamulti-dimensionalfeaturespac\ne,pickingweakrankersineach\nindividualfeaturedimension,asconsideredby[\n3\n],islikelytoleadtoveryweakrankers\nthusreducingmatchingeffectiveness.Incontrast,SVMbas\nedmodelssuchasRankSVM[\n8\n]\nseektolearnarankingfunctioninahigherdimensionalfeat\nurespacewheretruematches\nandwrongmatchesbecomemoreseparablethantheoriginalfe\naturespaceviathekernel\ntrick.RankSVMisthuspotentiallymoreeffectiveforcopin\ngwithhighlyoverlappedfeature\ndistributionsinpersonre-identication.However,amain\nissuewithrunningRankSVMon\nlargedatasetssuchastheLETORdataset\n1\nisthatitiscomputationallyveryexpensivedue\ntolargeamountofinequalityconstraints.Asaresult,Rank\nSVMbasedlearningtorankis\nlimitedasmuchfeweriterationscanbeperformed,resultin\nginasub-optimalranker.Given\nthenecessarilylargenumberofcandidatematchesforperso\nnre-identication,thisposesa\nseverescalabilitylimitationonRankSVM'sapplicability\ntopersonre-identication.\nChapelleandKeerthi[\n1\n]proposedaprimal-basedRankSVM(PRSVM)tospeedup\nexistingRankSVMfordocumentretrieval.WeexploitthisPR\nSVMmodelforaddressingthe\npersonre-identicationproblemandshowthatPRSVMstills\nuffersfromanotherscalability\nlimitationproblem.Specically,asthenumberoftraining\nsamplesgrows,thenumberof\nnegativesamplesincreasesnon-linearly,coupledwiththe\nhighfeaturedimensionalitythis\nmeansthatthememoryconsumptioncanbecomeunmanageable.\nToaddressthisproblem,\nweproposeinthisworkanEnsembleRankSVMthatusesaboosti\nngprincipleonweak\nPRSVMstomaintainthecomputationalefciencyinahigh-di\nmensionalfeaturespacewhilst\novercomingthescalabilitylimitationproblemofPRSVMsin\ntermsofmemoryusage.An\nadditionalbenetofthismodelisthatitintegratesthepar\nametertuningstepofPRSVMinto\naboostingframeworkremovingtheneedtorebuildtraininga\nndvalidationsets.\nForvalidatingourmodel,wetestandcompareaselectionofn\non-learning,learningand\nrankingmethodsonboththeVIPeRdataset[\n6\n]andthei-LIDSdataset\n2\n.Weshowthata\nrankingbasedapproachtopersonre-identicationgivessi\ngnicantimprovementoverex-\nistingre-identicationtechniques.Wealsoshowthatthep\nroposedEnsembleRankSVMis\nabletoachievecomparableresultstoconventionalRankSVM\nwhilstbeingcomputationally\nmuchmoreefcientthushavingsuperiorscalability.\n2RankingPeopleforRe-Identication\nPersonre-identicationbyrankingcanbeformulatedasfol\nlows.Assumethereexistsa\nsetofrelevanceranks\nl\n=\nf\nr\n1\n;\nr\n2\n;\n\n;\nr\nr\ng\nsuchthat\nr\nr\n\nr\nr\n\n1\n\nr\n1\nwhere\nr\nisthe\nnumberofranksand\n\nindicatestheorder.Inourproblemthereareonlytworeleva\nnce\nlevels/ranks,thatofrelevantandirrelevantobservation\nfeaturevectors,i.e.thecorrectand\nincorrectmatches.Givenadataset\nX\n=\nf\n(\nx\ni\n;\ny\ni\n)\ng\nm\n\ni\n=\n1\nwhere\nx\ni\nisamulti-dimensionalfeature\nvectorrepresentingtheappearanceofapersoncapturedino\nneview,\ny\ni\nisitslabeland\nm\nis\nthenumberoftrainingsamples(imagesofpeople).Eachvect\nor\nx\ni\n(\n2\nR\nd\n)\nhasanassociated\nsetofrelevantobservationfeaturevectors\nd\n+\n\ni\n=\nf\nx\n+\ni\n;\n1\n;\nx\n+\ni\n;\n2\n;\n\n;\nx\n+\ni\n;\nm\n+\n(\nx\ni\n)\ng\nandrelatedirrele-\n1\nhttp://research.microsoft.com/en-us/um/beijing/project\ns/letor/Baselines/RankSVM.html\n2\nhttp://www.ilids.co.uk\n"b'4\nPROSSER\netal.\n:PERSONRE-IDENTIFICATIONBYSUPPORTVECTORRANKING\nvantobservationfeaturevectors\nd\n\n\ni\n=\nf\nx\n\ni\n;\n1\n;\nx\n\ni\n;\n2\n;\n\n;\nx\n\ni\n;\nm\n\n(\nx\ni\n)\ng\ncorrespondingtocorrectand\nincorrectmatchesfromanothercameraview.Here\nm\n+\n(\nx\ni\n)\n(\nm\n\n(\nx\ni\n)\n)isthenumberofrele-\nvant(relatedirrelevant)observationsforquery\nx\ni\nandwehave\nm\n\n(\nx\ni\n)=\nm\n\nm\n+\n(\nx\ni\n)\n\n1.In\ngeneral,\nm\n+\n(\nx\ni\n)\n<<\nm\n\n(\nx\ni\n)\nbecausetherearelikelyonlyafewinstancesofcorrectmatc\nhes\nandmanyincorrectmatches.Thegoalofrankinganypairedim\nagerelevanceistolearna\nrankingfunction\nd\nforallpairsof\n(\nx\ni\n;\nx\n+\ni\n;\nj\n)\nand\n(\nx\ni\n;\nx\n\ni\n;\nj\n0\n)\nsuchthattherelevancerankingscore\nd\n(\nx\ni\n;\nx\n+\ni\n;\nj\n)\nislargerthan\nd\n(\nx\ni\n;\nx\n\ni\n;\nj\n0\n)\n.\n2.1RankingbySupportVectorMachine\nHereweseektocomputethescore\nd\nintermsofapairwisesample(\nx\ni\n,\nx\ni\n;\nj\n)byalinear\nfunction\nw\nasfollows:\nd\n(\nx\ni\n;\nx\ni\n;\nj\n)=\nw\n>\nj\nx\ni\n\nx\ni\n;\nj\nj\n;\n(1)\nwhere\nj\nx\ni\n\nx\ni\n;\nj\nj\n=(\nj\nx\ni\n(\n1\n)\n\nx\ni\n;\nj\n(\n1\n)\nj\n;\n\n;\nj\nx\ni\n(\nd\n)\n\nx\ni\n;\nj\n(\nd\n)\nj\n)\n>\nand\nd\nisthedimensionalityof\nx\ni\n.\nWecall\nj\nx\ni\n\nx\ni\n;\nj\nj\ntheabsolutedifferencevector.\nNotethatforaqueryfeaturevector\nx\ni\n,wewishtohavethefollowingrankrelationship\nforarelevantfeaturevector\nx\n+\ni\n;\nj\nandarelatedirrelevantfeaturevector\nx\n\ni\n;\nj\n0\n:\nw\n>\n(\nj\nx\ni\n\nx\n+\ni\n;\nj\njj\nx\ni\n\nx\n\ni\n;\nj\n0\nj\n)\n>\n0\n;\n(2)\nLet\nx\n+\ns\n=\nj\nx\ni\n\nx\n+\ni\n;\nj\nj\nand\nx\n\ns\n=\nj\nx\ni\n\nx\n\ni\n;\nj\n0\nj\n.Then,bygoingthroughallsamples\nx\ni\naswellasthe\nx\n+\ni\n;\nj\nand\nx\n\ni\n;\nj\ninthedataset\nX\n,weobtainacorrespondingsetofallpairwiserelevantdiff\nerence\nvectorsinwhich\nw\n>\n(\n\nx\n+\ns\n\n\nx\n\ns\n)\n>\n0isexpected.Thisvectorsetisdenotedby\nP\n=\nf\n(\n\nx\n+\ns\n;\n\nx\n\ns\n)\ng\n.\nARankSVMmodelisthendenedastheminimizationofthefoll\nowingobjectivefunction:\n1\n2\nk\nw\nk\n2\n+\nC\nj\nP\nj\n\ns\n=\n1\nx\ns\ns\n:\nt\n:\nw\n>\n(\n\nx\n+\ns\n\n\nx\n\ns\n)\n\n1\n\nx\ns\n;\ns\n=\n1\n;\n\n;\nj\nP\nj\n;\nx\ns\n\n0\n;\ns\n=\n1\n;\n\n;\nj\nP\nj\n;\n(3)\nwhere\nC\nisapositiveparameterthattradesmarginsizeagainsttrai\nningerror.\nOneofthemainproblemswithusinganSVMtosolvetheranking\nproblemisthepoten-\ntiallylargesizeof\nP\n.Inproblemswithlotsofqueriesand/orquerieswithlotsof\nassociated\nobservationfeaturevectors,thesizeof\nP\nmeansthatformingthe\nx\n+\ns\n\n\nx\n\ns\nvectorsbecomes\ncomputationallychallenging.Particularly,inthecaseof\npersonre-identication,assuming\nthereisatrainingsetconsistingof\nm\npersonimagesintwocameraviews.Thesizeof\nP\nis\nproportionalto\nm\n2\n,itthusincreasesrapidlyas\nm\nincreases.SVM-basedmethodsalsorely\nonparameter\nC\n,whichmustbeknownbeforetraining.Inordertoyieldareas\nonablemodel\nonemustusecrossvalidationtotunemodelparameters.This\nsteprequirestherebuilding\nofthetraining/validationsetateachiteration,thusfurt\nherincreasingthecomputationalcost\nandmemoryusage.Hence,theRankSVMinEqn(\n3\n)isnotcomputationallytractablefor\nlarge-scaleconstraintproblemsduetobothcomputational\ncostandmemoryuse.\nChapelleandKeerthi[\n1\n]proposedamethodbasedonprimalRankSVM(PRSVM)that\nrelaxestheconstrainedRankSVMandformulatedanon-const\nraintmodelasfollows:\nw\n=\nargmin\nw\n1\n2\nk\nw\nk\n2\n+\nC\nj\nP\nj\n\ns\n=\n1\n`\n\n0\n;\n1\n\nw\n>\n\nx\n+\ns\n\n\nx\n\ns\n\n2\n;\n(4)\n'b'PROSSER\netal.\n:PERSONRE-IDENTIFICATIONBYSUPPORTVECTORRANKING\n5\nwhere\nC\nisapositiveimportanceweightontherankingperformancea\nnd\n`\nisthehinge\nlossfunction.Moreover,aNewtonoptimisationmethodisin\ntroducedtoreducethetraining\ntimeoftheSVM.Additionally,itremovestheneedforanexpl\nicitcomputationofthe\nx\n+\ns\n\n\nx\n\ns\npairsthroughtheuseofasparsematrix.However,whilstthe\ncomputationalcostof\nRankSVMhasbeenreducedsignicantly,thememoryusageiss\nueremains.Specically,in\nthecaseofpersonre-identication,thespacialcomplexit\ny(memorycost)ofcreatingallthe\ntrainingsamplesis\nO\n \nm\n\ni\n=\n1\nd\n\nm\n+\n(\nx\ni\n)\n\nm\n\n(\nx\ni\n)\n!\n;\n(5)\nwhere\nd\nisthefeaturedimensionality.Assumingthereare\nL\npeopleinthetrainingset,and\nm\nL\nimagesforeachperson,wethenhave\nm\n+\n(\nx\ni\n)=\nm\nL\n\n1andthespacialcomplexitycanbe\nre-writtenas:\nO\n(\nd\n\n((\n1\nL\n\n1\nL\n2\n)\n\nm\n3\n+(\n1\nL\n\n1\n)\n\nm\n2\n))\n:\n(6)\nThiscomplexityisveryhighgivenlargenumberoftrainings\namples\nm\nandhighdimen-\nsionalfeaturespace\nd\n,anditcannotbereducedusingPRSVM.InordertomakeRankSV\nM\ntractableforthelargescalepersonre-identicationprob\nlemwewishtoresolve,wepropose\nanEnsembleRankSVMtobothsignicantlyreducethespacial\ncomplexityandsolvethe\nproblemoftuning\nC\ninRankSVM.\n2.2EnsembleRankSVM\nRatherthanlearningabatchmodeRankSVM,weaimtolearnase\ntofweakRankSVMs\neachcomputedonasmallsetofdataandthencombinethemtobu\nildastrongerrankerusing\nensemblelearning.Moreprecisely,astrongranker\nw\nopt\nisconstructedbyasetofweak\nrankers\nw\ni\nasfollows:\nw\nopt\n=\nN\n\ni\na\ni\n\nw\ni\n:\n(7)\nLearningtheweakrankers.\nWedivideadatasetintogroupsandeachweakrankeris\nlearnedbasedonthatgroupofdata.Specically,assumethe\nreareintotal\nL\npeople\nC\n=\nf\nC\n1\n;\n\n;\nC\nL\ng\nandweequallydividetheminto\nn\ngroups\nG\n1\n;\n\n;\nG\nn\nwithoutoverlap,i.e.\nC\n=\nS\nn\n\ni\n=\n1\nG\ni\nand\n8\ni\n6=\nj\n,\nG\ni\nT\nG\nj\n=\n/0.Thenthetrainingdataset\nZ\nisdividedinto\nn\ngroups\nZ\n1\n;\n\n;\nZ\nn\nasfollows:\nZ\ni\n=\nf\n(\nx\ni\n;\ny\ni\n)\nj\ny\ni\n2\nG\ni\ng\n:\n(8)\nThesimplestwaytolearnaweakrankeristoperformRankSVMo\nneachsubset\nZ\ni\n.In\nordertoavoidlearningaratherweakranker,welearnallwea\nkrankersfromasubset\n\nZ\ni\nand\n\nZ\ni\n=\nZ\ni\nS\nO\ni\nsothatallweakrankersarenotcompletelylearnedonsepara\ntedatasets,where\nO\ni\nisasubsetofdataofthesameamount\nj\nZ\ni\nj\nrandomlyselectedfromtheremainingdata\nset\nZ\n\nZ\ni\n.Thisallowsustolearnweakrankersonoverlappingsubsets\n.Inourexperiment\n(Section3),foreach\nZ\ni\nandforeachimportanceweight\nC\n,aweakrankerislearned;thatisif\nthereare\ns\ncandidatevaluesofparameter\nC\n,then\nN\n=\ns\n\nn\nweakrankersarecomputed.This\nmakesselectionoftheparameter\nC\nintheprimal-basedRankSVMuniedintotheensemble\nlearningframework,withoutusinganyadditionalcross-va\nlidationthatrequiresreforming\ntrainingsamples.\nForeach\n\nZ\ni\n,wecomputeaweakranker\nw\ni\nbyusingaprimal-basedRankSVMofChapelle\nandKeerthi[\n1\n],whichistractablegivenamoderatesizedataset.Tocompu\nteRankSVM,we\n'b'6\nPROSSER\netal.\n:PERSONRE-IDENTIFICATIONBYSUPPORTVECTORRANKING\nrstcalculateasetofrelevantandtherelatedirrelevanta\nbsolutedifferencevectorsin\n\nZ\ni\n,de-\nnotedby\nP\ni\n=\nf\n(\n\nx\n+\ni\n;\ns\n;\n\nx\n\ni\n;\ns\n)\ng\n.Then,forsomepositiveparameter\nC\n,theprimal-basedRankSVM\nsolvesthesquaredhingelossfunctionbasedoncriterionof\nEqn.(\n4\n).\nLearning\na\ni\n.\nSuppose\nN\nweakrankers\nf\nw\ni\ng\nN\n\ni\n=\n1\nhavebeenlearnedfromthepreviousstep.\nWenowexploreboostingtolearntheweight\na\ni\nonthewholedataset\nX\niteratively(seeAl-\ngorithm\n1\n).Specically,atthe\nt\nstep,werstselectthebestweakranker\nw\nk\nt\nthatminimises\nthefollowingcostfunction:\nk\nt\n=\nargmin\ni\nj\nP\nj\n\ns\n=\n1\nD\ns\nt\n\nI\nw\n>\n\ni\n(\n\nx\n\ns\n\n\nx\n+\ns\n)\n\n0\n(9)\nwhere\nD\ns\nt\nistheweightofpairwisedifferencevectorsat\nt\nstep,\n\nj\nP\nj\ns\n=\n1\nD\ns\nt\n=\n1and\nI\nisaboolean\nfunction.Then,\nD\ns\nt\nisupdatedasfollows:\nD\ns\nt\n+\n1\n=\nF\n\n1\nD\ns\nt\n\nexp\nn\na\nt\n\n\nw\n>\n\nk\nt\n(\n\nx\n\ns\n\n\nx\n+\ns\n)\no\n;\n(10)\nwhere\nF\nisthenormalisersuchthat\n\nj\nP\nj\ns\n=\n1\nD\ns\nt\n+\n1\n=\n1andweinitialise\nD\ns\n\n1\n=\n1\nj\nP\nj\n.Theweight\na\nt\nisthendeterminedby:\na\nt\n=\n0\n:\n5\n\nlog\n1\n+\nr\n1\n\nr\n;\nr\n=\nj\nP\nj\n\ns\n=\n1\nD\ns\nt\n(\nw\n>\n\nk\nt\n\nx\n+\ns\n\n\nx\n\ns\n)\n:\n(11)\nNotethatinordertoensurethattheboostingalgorithmboth\nconvergesandupdatesthe\naboveweight,theinputweakrankers\nw\ni\narenormalisedby2\n\nmax\ni\n;\ns\n\n\n\nw\n>\n\ni\n(\n\nx\n\ns\n\n\nx\n+\ns\n)\n\n\n\n,sothat\nw\n>\n\ni\n(\n\nx\n+\ns\n\n\nx\n\ns\n)\n2\n[\n\n1\n;\n+\n1\n]\n,assuggestedin[\n3\n].\nComparedtothebatchmodeRankSVM,theadvantagesofEnsemb\nleRankSVMare\ntwo-fold.Firstly,itisnotrequiredtoselectthebestpara\nmeter\nC\nforeachweakranker\nusingcross-validation,astheensemblelearningalgorith\nmautomaticallyselectstheoptimal\nvalueof\nC\nbyassigningdifferentweightstoweakrankersofdifferent\nparametervaluesof\nC\n.\nSecondlyandmoreimportantly,eachweakrankerislearnedo\nnasmallsetofdataandthe\nboostingprocessisbasedonthedataprojectionvaluesofea\nchweakranker.Tolearneach\nweakranker,thespacialcomplexityis\nO\n(\nd\n\n(\n1\nn\n2\n(\n1\nL\n\nn\nL\n2\n)\n\nm\n3\n+\n1\nn\n(\n1\nL\n\n1\nn\n)\n\nm\n2\n))\n,where\nd\nis\nthedimensionofeachimagefeaturevectorand\nn\nisthenumberofsubsets.Afterlearning\neachweaklearner,fortheensemblelearningprocess,thesp\nacecomplexityis\nO\n(\nN\n\n((\n1\nL\n\n1\nL\n2\n)\n\nm\n3\n+(\n1\nL\n\n1\n)\n\nm\n2\n))\nwhere\nN\nisthetotalnumberofweakrankers,andasthenumberof\nfeatures\nd\n>\n2000inre-identicationwehave\nN\n<<\nd\n.Overallthespacecomplexityofour\nEnsembleRankSVMisaround1\n=\nn\n2\nofthatoftheoriginalRankSVM.Ourexperimentsshow\ntheensembleRankSVMcanobtaincomparableperformanceast\nhebatchmodeRankSVM\nbutwithsignicantreductioninmemoryusage.\n3Experiments\nDatasets:\nTwochallengingdatasetswereusedinthiswork,theVIPeRda\ntasetpresentedby\nGrayetal.[\n6\n]andasetofimagesextractedfromthei-LIDSdataset\n3\n.Exampleimages\nfrombothdatasetscanbeseeninFigure\n1\n.TheVIPeRdatasetconsistsof632pedestrian\nimagepairstakenfromtwocameraviews.Eachoftheimagesha\nsbeenscaledtoastandard\n3\nhttp://scienceandresearch.homeofce.gov.uk/hosdb/cct\nv-imaging-technology/i-lids/scenarios\n'b"PROSSER\netal.\n:PERSONRE-IDENTIFICATIONBYSUPPORTVECTORRANKING\n7\nAlgorithm1:\nAlgorithmofEnsembleRankSVM\nData\n:Pairwiserelevantdifferencevectorset\nP\n,Initialdistribution\nD\n1\n=\nf\nD\ns\n\n1\ng\nbegin\nfor\nt\n=\n1\n;\n\n;\nT\ndo\nSelectthebestranker\nw\nk\nt\nbyEqn.(\n9\n);\nComputetheweight\na\nt\nbyEqn.(\n11\n);\nUpdatethedistribution\nD\nt\n+\n1\nbyEqn.(\n10\n).\nend\nend\n\nOutput\n:Output\nw\nopt\n=\n\nT\nt\n=\n1\na\nt\n\nw\nk\nt\nsizeandcontainsstarkdifferencesinpose,orientationan\ndilluminationmakingthisdataset\nagoodrepresentationofchallengingrealworlddata.Thei-\nLIDSdatasetusedinthiswork\ncontained208imagepairsthatwehaveextractedfromtheHOS\nDB'si-LIDSmulti-camera\ntrackingdataset.Eachpersonhastwomanuallyextractedim\nagesfromtwodifferentcamera\nviews(onefromeach).Thedatasetcontainsaselectionofca\nmeraviewcombinationsfrom\ndifferentvideosinthei-LIDSmulti-cameraselection.Asw\niththeVIPeRdatasetthese\nimageswerescaledtoastandardsizeandwerenotsegmentedf\nromthebackground.As\nsuchthei-LIDSdatasetinthispaperhasindividualscaptur\nedunderadiversesetofcamera\nconditions.Whiletheimagesfrombothdatasetsttoeachsub\njectclosely,somebackground\nnoiseispresentineveryimage(seeFig.\n1\n).\nFeatureExtraction:\nThefeaturesusedwere8colourchannels(RGB,HSandYCbCr)\nand21texturelters(Gabor[\n2\n]andSchmid[\n11\n])appliedtotheluminancechannel.The\nGaborlterusedhadparameters\ng,\nl\n,\nq\nand\ns\n2\nthatweresetto(0.3,0,4,2),(0.3,0,8,2),\n(0.4,0,4,1),(0.4,0,4,1),(0.3,\np\n2\n,8,2),(0.4,\np\n2\n,4,1)and(0.4,\np\n2\n,8,2)respectively.TheSchmid\nltersusedparameters\ntand\ns\nsetto(2,1),(4,1),(4,2),(6,1),(6,2),(6,3),(8,1),(8,2\n),(8,3),\n(10,1),(10,2),(10,3)and(10,4)respectively,similarto\n[\n5\n].Acommonbinsizewasselected\nforeachfeaturechannelof16bins.Asdifferentregionsoft\nheimagearelikelytocontain\nvisuallydistinctareasofinterestsomeformofspatialrep\nresentationisclearlyneeded.Some\napproachesuseasinglerectangletocapturethewholeappea\nrance[\n10\n],andothersoptfor\namorecomplicatedstructuralrepresentation[\n4\n].Theseapproachesareeithertoosimpleor\ntooconstrained.Insteadwechoosearepresentationusings\nixequalsizedhorizontalstripsin\nordertoroughlycapturethehead,upperandlowertorsoandu\npperandlowerlegs.\nMethodsforComparison:\nWeimplementedthePRSVMbyselectingparameter\nC\ninthe\nset\nf\n0\n:\n0001\n;\n0\n:\n005\n;\n0\n:\n001\n;\n0\n:\n05\n;\n0\n:\n1\n;\n0\n:\n5\n;\n1\n;\n10\n;\n100\n;\n1000\ng\nusingcrossvalidation.ForEnsem-\nbleRankSVM,thenumberofgroupsofdata\nn\nwassetto5.Wenotedthattheperformance\nofmethodisinsensitivetothevalueof\nn\n.Forcomparison,anotherfourdifferentexisting\npersonre-identicationmodelsweretested,includingtwo\nnon-learningdistancebasedmea-\nsuresBhattacharyyaandL1-norm,astate-of-the-artAdabo\nost-basedpersonre-identication\nsystem(ELF)[\n5\n],andarankingbasedmodelusingRankBoost[\n3\n].Allsixmethodswere\ntestedusingexactlythesameimagefeaturesetandimagerep\nresentation.Weconductedve\nrandomtrialsandreporttheresultsaveragedoverthetrial\ns.Presentedaretheresultsofusing\n75%ofthetotalsamplesfortestingwiththerest25%fortrai\nning,and50%fortestingwith\ntherest50%training.Toevaluatecomparativelyallsixre-\nidenticationmethods,wedisplay\nthecumulativematchingcharacteristic(CMC)curve[\n13\n],whichisbasedontherankingof\neachofthegalleryimagewithrespecttotheprobe,thusresu\nltingintheexpectationofthe\n"b'8\nPROSSER\netal.\n:PERSONRE-IDENTIFICATIONBYSUPPORTVECTORRANKING\n0204060801000102030405060708090100VIPeR DatasetRank ScoreMatching Rate (%)  ELFBhat.L1-NormEnsemble-RankSVMRankBoostPRSVM(a)316training,316testing\n0204060801000102030405060708090VIPeR DatasetRank ScoreMatching Rate (%)  ELFBhat.L1-NormEnsemble-RankSVMRankBoostPRSVM(b)158training,474testing\nFigure2:CumulativeMatchingCharacteristic(CMC)curves\nfortheVIPeRdataset.\ncorrectmatchbeingatrank\nr\n.\nRankingvs.Non-RankingApproaches:\nFigure\n2(a)\nshowstheCMCcurvesfortheVIPeR\ndatasetwith50%(316)ofthedatausedfortrainingand50%fo\nrtestingwhileFigure\n2(b)\nuseslesssamplesfortraining(158)andmorefortesting(47\n4).Duetothehighnumberof\npossiblematchescoupledwiththeintrinsicdifcultyofth\nedatainwhichobjectsappearin\ndifferentviewingconditions,thenon-learningbaseddist\nancemeasures(Bhattacharyyaand\nL1-Norm)performfairlypoorlyoverall.IncontrasttheELF\nmethodshowsthatbylearning\nfromtrainingsamplesamoreaccuratedistancemeasurecanb\neobtained.Itisclearthat\nbyemployingarankingframeworkwecangainasignicantboo\nstinperformancewiththe\nPRSVMandEnsemble-RankSVMbeingthebestoverall.Similar\nly,theresultsonthei-\nLIDSdataset(Figures\n3(a)\nand\n3(b)\n)showthatwiththeexceptionofRankBoost,explained\nbelow,thenon-rankingmethodsstillshowloweroverallper\nformance.Someexamplequery\nandrankedobservationresultscanbeseeninFigure\n4\n.\nEnsembleRankSVMvs.PRSVM:\nOntheVIPeRdataset(Figures\n2(a)\nand\n2(b)\n)thediffer-\nenceinperformancebetweentheEnsembleRankSVMandthePRS\nVMisnegligible.This\ndemonstratesthatgivenalargedatasetlikeVIPeRtheEnsem\nble-RankSVMisanequalin\ntermsofperformance,whileallowingabetterscalingofmem\noryusage(5.6GBneededfor\nthePRSVMwith50%trainingontheVIPeRdataset,whiletheEn\nsemble-RankSVMneeded\nonly740MBandthisgapwillwidenonlargerdatasets).Onthe\ni-LIDSdataset(Figures\n3(a)\nand\n3(b)\n)thegapbetweenthemisslightlyincreased,withtheEnsemb\nleRankSVMhaving\naloweroverallscorewhenthenumberoftrainingsamplesisd\necreased.Thisisbecausethat\ngivenasmalltrainingset,therearetoofewsamplesineachs\nubsetforlearningaweakranker\nwhichaffectstheperformanceofourEnsembleRankSVM.Neve\nrtheless,sincetheprimary\ngoaloftheintroductionoftheensembleframeworkwastoinc\nreasescalability,itisnatural\nthatonsmallerexperimentsthePRSVMismoresuitable.\n\nSVM-basedvs.Boosting:\nFrombothdatasetsitisclearthattheRankSVMbasedmethods\naremoresuitedtothistaskthantheBoostingmethods(ELFan\ndRankBoost).Theperfor-\nmanceontheVIPeRdataset(Figures\n2(a)\nand\n2(b)\n),showsthattheELFmethodoutper-\nformstheRankBoostmethodwiththesettingused,bothbeing\nsignicantlylowerthanthe\ntwoSVMbasedrankingmethods.Onthei-LIDSdataset(Figure\ns\n3(a)\nand\n3(b)\n)wecansee\nthattheRankBoostmethodshowssimilarresultstotheELF,b\nothofwhicharelowereven\nthanthebaselinenon-learningmethods,indicatingthatth\neweakrankers/classiersbasedon\nsinglefeaturechannelsarenoteffective.Onthisdatasett\nherank1matchingrateofPRSVM\nismorethandoublethoseofELFandRankBoost.\n'b'PROSSER\netal.\n:PERSONRE-IDENTIFICATIONBYSUPPORTVECTORRANKING\n9\n051015202530102030405060708090100i-LIDS DatasetRank ScoreMatching Rate (%)  ELFBhat.L1-NormEnsemble-RankSVMRankBoostPRSVM(a)108training,108testing\n0510152025300102030405060708090i-LIDS DatasetRank ScoreMatching Rate (%)  ELFBhat.L1-NormEnsemble-RankSVMRankBoostPRSVM(b)52training,156testing\nFigure3:CumulativeMatchingCharacteristic(CMC)curves\nforthei-LIDSdataset.\nVIPeRDataset\ni-LIDSDataset\nFigure4:Examplesofre-identicationontheVIPeRandi-LI\nDSdatasetsrespectively.The\nrstcolumnindicatesthequeryimage,themiddlecolumnsho\nwsthePRSVMrankedresults\nwiththecorrectmatchinred.\nComputationTime:\nAlltheexperimentswererunonaservermachinewith8CPUcor\nes\nand24GBofRAMinordertoaccommodateanyrequiredRAMconsu\nmption.Theim-\nplementationwasinMatlab,nospecialeffortwasmadeinter\nmsofmulti-threadingsothe\n'b"10\nPROSSER\netal.\n:PERSONRE-IDENTIFICATIONBYSUPPORTVECTORRANKING\nexperimentsgenerallytookup1CPUcoreandatmost3forsome\nMatlabfunctions.The\ncomputationtimesoftheSVM-basedrankingmethodsweremuc\nhlowerthanthatofthe\nELFandRankBoostmethods.Forinstance,forone-foldtrain\ningandtestingfortheVIPeR\ndatasetwithatrainingsizeof316,thePRSVMtookabout11mi\nnutesandtheEnsemble-\nRankSVM13minuteswhiletheELFtookover5hoursandtheRank\nBoostmethod10days.\n4Conclusion\nInthiswork,weproposedareformulationofthepersonre-id\nenticationproblemasalearn-\ningtorankproblem.Wehaveshownthatarankingrelevanceba\nsedmodelcanimprovethe\nreliabilityandaccuracyinpersonre-identicationunder\nchallengingviewingconditions.In\naddition,weformulatedanEnsembleRankSVMsinordertoove\nrcomethecomputational\nscalabilitylimitationofexistingRankSVMmodels,whichi\nsespeciallyseverewhenthereis\nalargenumberofpeopletomatchandthefeaturespacehasahi\nghdimensionality.Wefur-\ntherincorporatedthetuningofparametersfortrainingaPR\nSVMinourensemblelearning\nmethodtoeliminatetheneedforiterativecross-validatio\nninmodeltraining.Theproposed\napproachshowsasignicantimprovementoverotherboostin\ngbasedrankingmodelswhere\ntheweakrankerswereconstructedfromindividualfeatures\n.\nReferences\n[1]O.ChapelleandS.Keerthi.Efcientalgorithmsforrank\ningwithsvms.\nInformation\nRetrieval\n,18,2010.toappear.\n[2]I.FogelandD.Sagi.Gaborltersastexturediscriminat\nor.\nBiologicalCybernetics\n,\n61(3):102113,1989.\n[3]Y.Freund,R.Iyer,R.E.Schapire,andY.Singer.Anefci\nentboostingalgorithmfor\ncombiningpreferences.\nJournalofMachineLearningResearch\n,4:933969,2003.\n[4]N.Gheissari,T.Sebastian,P.Tu,andJ.Rittscher.Pers\nonreidenticationusingspa-\ntiotemporalappearance.In\nIEEEConferenceonComputerVisionandPatternRecog-\nnition\n,volume2,pages15281535,2006.\n[5]D.GrayandH.Tao.Viewpointinvariantpedestrianrecog\nnitionwithanensembleof\nlocalizedfeatures.In\nEuropeanConferenceonComputerVision\n,Marseille,France,\n2008.\n[6]D.Gray,S.Brennan,andH.Tao.Evaluatingappearancemo\ndelsforrecognition,reac-\nquisition,andtracking.In\nIEEEInternationalWorkshoponPerformanceEvaluation\nforTrackingandSurveillance\n,RiodeJaneiro,Brazil,October2007.\n[7]M.Hahnel,D.Klunder,andK.-F.Kraiss.Colorandtextur\nefeaturesforpersonrecog-\nnition.In\nIEEEInternationalJointConferenceonNeuralNetworks\n,volume1,pages\n647652,July2004.\n[8]T.Joachims.Optimizingsearchenginesusingclickthro\nughdata.In\nKDD'02:Proceed-\ningsoftheeighthACMSIGKDDinternationalconferenceonKn\nowledgediscoveryand\ndatamining\n,pages133142,NewYork,NY,USA,2002.ACM.ISBN1-58113-5\n67-X.\ndoi:http://doi.acm.org/10.1145/775047.775067.\n"b'PROSSER\netal.\n:PERSONRE-IDENTIFICATIONBYSUPPORTVECTORRANKING\n11\n[9]C.Madden,E.DahaiCheng,andM.Piccardi.Trackingpeop\nleacrossdisjointcam-\neraviewsbyanillumination-tolerantappearancerepresen\ntation.\nMachineVisionand\nApplications\n,18(3):233247,2007.\n[10]B.Prosser,S.Gong,andT.Xiang.Multi-cameramatchin\ngunderilluminationchange\novertime.In\nECCVWorkshoponMulti-cameraandMulti-modalSensorFusio\nnAlgo-\nrithmsandApplications\n,Marseille,France,2008.\n[11]C.Schmid.Constructingmodelsforcontent-basedimag\neretrieval.In\nIEEEComputer\nSocietyConferenceonComputerVisionandPatternRecognit\nion\n,pages3945,Hawaii,\nUSA,December2001.\n[12]H.Wang,D.Suter,andK.Schindler.Effectiveappearan\ncemodelandsimilaritymea-\nsureforparticlelteringandvisualtracking.In\nEuropeanConferenceonComputer\nVision\n,pages606618,Graz,Austria,2006.\n[13]X.Wang,G.Doretto,T.Sebastian,J.Rittscher,andP.T\nu.Shapeandappearance\ncontextmodeling.In\nIEEEInternationalConferenceonComputerVision\n,pages18,\nRiodeJaneiro,Brazil,October2007.\n'