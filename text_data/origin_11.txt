b'IEEETrans.onPatternAnalysisandMachineIntelligence,Vol.18,No.9,1996version).RegionCompetition\n:UnifyingSnakes,RegionGrowing,andBayes/MDLforMulti-bandImageSegmentation.SongChunZhu1andAlanYuille2AbstractWepresentanovelstatisticalandvariationalapproachtoimagesegmentationbasedonanewalgorithmnamedregioncompetition.ThisalgorithmisderivedbyminimizingageneralizedBayes/MDLcriterionusingthevariationalprinciple.Thealgorithmisguaranteedtoconvergetoalocal\nminimumandcombinesaspects\nofsnakes/balloons\nandregiongrowing.Indeedtheclassicsnakes/balloons\nandregiongrowingalgorithmscanbe\ndirectlyderivedfromourapproach.Weprovidetheoreticalanalysisofregioncompetition\nincludingaccuracyofboundary\nlocation,\ncriteriaforinitialconditions,andtherelationshiptoedgedetectionusingItisstraightforwardtogeneralizethealgorithmtomulti-bandsegmentationandwedemonstrateitongreylevelimages,colorimagesandtextureimages.Thenovelcolormodel\nallowsustoeliminateintensitygradientsandshadows,therebyobtainingsegmentationbasedonthealbedos\nofobjects.\nItalsohelpsdetecthighlightregions.1DivisionofAppliedSciences,HarvardUniversity.Cambridge,MA02138.2TheSmith-KettlewellEyeResearchInstitute.2232WebsterStreet,SanFran,CA94115.'b'1Introduction\nImagesegmentationisacriticalproblemofearlyvisionandithasbeen\nintensivelystud-ied.Approachestoimagesegmentationcanbe\nroughlyintofourgroups:(i)Local\napproachessuchastheCannyedgedetector[4],\n(ii)Snake[19]\nandBalloon\nmethods\n[6],\n[7],\n[37],\n[32](iii)\nRegiongrowingandmergingtechniques[2],\n[1],[26],\nand(iv)Globaloptimizationapproachesbasedonenergyfunctions[28]\norBayesian[10]\n[3],[11]\nandMDL(MinimumDescriptionLength)criteria[23]\n[20]\n[18].\nAcommonpropert\nyoftheseapproachesisthattheyallmakehypothesesabout\ntheimage,testfeaturesandmakedecisionsbyapplyingthresholdsexplicitlyorimplicitly.Asshownbytheshadowedareasin(1),amajor\nbet\nweenthefourapproachesliesinthedomainsonwhichthehypotheses,\ntests,anddecisionsarebased.Theseapproachesallhavecertaindraw-backs.Theapproachonlymakesuseoflocal\ninformationandcannotguaranteecontinuousclosededgecontours.Snake/balloon\nmodels\nmakeuseonlyofinformationalongtheboundary\nandrequiregood\ninitialestimatestoyieldcorrectconvergence.Anadvantageofregiongrowingisthatitteststhestatisticsinsidetheregion,howeveritoftengeneratesirregularboundaries\nandsmallholes.Inaddition,allthesethreemethods\nlackaglobalcriterionforsegmentingtheentireimage.Bycontrast,energy/Bayes/MDLhaveglobalcriteriabutitisoftenverytotheirminima.i.  filteringiv.  Bayes/MDLiii. region growingii. snake/balloonFigure1Theshadowedareasshowtheimagedomainsbasedonwhichthehypotheses,\ntests,anddeci-sionsaremadeby(i)(ii)snakes/balloons,\n(iii)regiongrowing,and(iv)theenergy/Bayes/MDLapproach.Inthispaper\nwepresentastatisticalframeworkforimagesegmentationusinganovelalgorithmwhichwecallregioncompetition.ItisderivedbyminimizingageneralizedBayes/MDLcriterionwhichinvolvesasamplingwindow(whosesizedepends\nonthesignaltonoiseratio).Thealgorithmcombinestheattractivegeometricalfeaturesofsnake/balloon\nmodels\nandthestatisticaltechniquesofregiongrowing.Indeedwecande-rivetheclassicsnake/balloon\nandregiongrowingalgorithmsdirectlyfromourframework.Ourapproachcanthereforebe\nappliedforindividualimageregions,thoughweonlyshowsimulationsforthehardertaskofglobalsegmentation.Theprecisionoftheboundary\nlocation\ndepends\nonthesizeofthesamplingwindows.AsfortheCannyedgedetector[4],\nthedesirablesizeofthesewindowsdepends\nonatrade-bet\nweenthegoalsofmaximizingthesignaltonoiseratioandlocating\ntheboundaries\naccurately.Thisgivesrisetoanuncertaincyprinciple[36].\nWedescribe\nhowoptimallysizedwindowscanbe\nchosentominimizethisuncertainty.1'b'Likemanyalgorithms,theperformance\nofregioncompetition\nwilldepends\nontheinitialconditions{morepreciselyonthechoiceofinitial"seeds".Wediscusscriteriaforchoosing\nsuchseeds.Wealsodescribe\nanimportan\ntdominowherebybadseedsaretransformedintogood\nseeds.Ourapproachisdirectlygeneralizedtomulti-bandsegmentation.Firstweextendittocolorusinganovelmodel\nwhich,forcertaintypes\nofmaterials,allowsustosegmenttheimagebasedonthealbedo\nofthematerial.Thisavoidsthekeydrawbackofmanyapproachestoimagesegmentationwhichonlylook\nfordiscontinuitiesinintensities,andwhichcangivemisleadingresults.Forexample,clothestypicallyhaveregionsofhomo-geneousalbedo\nortexture,butwilloftenhavesharpshadowsduetocreases.Finallywerunouralgorithmontextureimagesusingtoprovidemulti-bandinput.Thispaper\nhassomesimilaritiestoworkdescribed\nby[29]\nand[26].\nBothapproachesusestatisticalteststogrowmultipleseedregionsindependen\ntly,andthenusetheMDLcriteriontocompresstheoverlappingbet\nweenregions.Bycontrast,ourmethod\nminimizestheMDLcriterionfortheentireimagedirectly.Ourworkalsohassomesimilaritiestoideasdiscussedin[28]\nand[22]\n[27].\nTheseworksfromoursbynotusingastatisticalcriterion.Thispaper\nisorganizedasfollows.Section(2)setsthescenebydescribingSnakesandBalloons,\nRegionGrowingandEnergy/Bayes/MDL.InSection(3)weintro-duceourapproachforgreylevelimagesanddescribe\nimplementationresults.Section(4)discusseshowthewindowsizetheprecisionofboundary\nlocation\nandtheofinitialconditions.Section(5)describes\nthecolormodel\nanddiscusseshowitcanremoveintensitygradientsanddetecthighlights.Insection(6),weapplyourmethod\ntotextureimages.Finallysection(7)discussesseveralpossible\nextensionsofourapproach.2Snakes,RegionGrowingandEnergy/Bayes/MDLThissectionreviewstheproperties\nofsnakes/balloons,\nregiongrowingandEn-ergy/Bayes/MDL.2.1SnakesandBallo\nonsAsnake[19]\nisanactivecontourbys)=(x(s);y\n(s)),wherescanbe\nthearclengthofthecontour1.Hereweassumethats)istheclosedboundary\nofaregionR(i.e.s)=@R\n).Atypicalenergyforasnakeis:Es)]=Is)f12(jsj2+jssj2)~rI~rIgds(1)whichisminimizedbysteepest\ndescent:d(s)dt=E\n=ss+ssss+~r~rI~rI;(2)1Thecontourcanalsobe\nrepresentedparametrically,forexamplebyB-splinesorFourierco\nts,butwewillnotconsidersuchvariantsinthispaper.\n2'b"wheress=(\nx(s);y(s)),etc.Thisderivationrequirestakingfunctionalderivativesoftheenergy,seeAppendix.\nTheballoon\nmodels[6],\n[7],[37]\naremotivatedbythedesiretodrivethesnakeauto-maticallytoagood\nposition\n(therebydecreasingthedependence\nontheinitialconditions).Theyintroduce\nanadditionalforceterm~n(s)toEquation(2)whichpushesthecontourout(orin)alongitsnormal~n(s).Thisadditionalforcetermcanbe\nderivedfromanenergyfunction.Itcorresponds,\nseeAppendix,\ntoanadditionalenergytermEadds)]=RRRdxdy.Thecompleteenergyfortheballoon\nis:E(s)]=I(s)f12(jsj2+(ss)2)~rI~rIgdsZZRdxdy(3)Thustheballoon\ntriestomaximizeitsareawhilesmoothing\nitsbounding\ncontourandmaximizingtheintensitygradientalongthecontour.2.2RegionGrowingandMergingThegoalofregionmergingandregiongrowing[16],\n[26]\nistodividethedomainRoftheimageIintoregionsfRi:i=1;:::;M\ngsothatR=[Mi=1Ri,Ri\\Rj=ifi6=j,andIahomogeneitycriteriononeachRi.Regionmergingbuildsupcomplicatedregionsbycombiningsmallerregionsusingastatisticalsimilaritytest.Apopular\nchoiceisFisher'stest[33].\nForexample,suppose\ntherearetwoadjacentregionsR1andR2,wheren1;n\n2;^1;^2;^21;^22arethesizes,samplemeansandsamplevariancesofR1;R\n2respectiv\nely.Theninordertodecidewhetherornottomergethem,wecanlook\natthesquaredFisherdistance:(n1+n2)(^\n1^2)2n1^21+n2^22=n^2n1^21+n2^221;(4)wheren=n1+n2and^2isthesamplevarianceofthemixtureregion(ageneralizationtothemulti-dimensionalcaseiscalledHotelling'stest[17]).\nIfthisstatisticisbelo\nwacertainthresholdthentheregionsaremerged.Regiongrowingcanbe\nconsideredasaspecial\ncaseofregionmerging,whereR1isthegrowingregionandR2isasinglepixelattheboundary\nofR1,i.e.n2=1andn1isverylarge(sayn1>100).Inthiscasewecantreat=^1;\n2=^21,and2=I(x;y)(theintensityatpoin\nt(x;y\n)),andapproximatethesquaredFisherdistance[8]by:(I)22.Avariantofregiongrowing[26]\nistotheintensitywithineachregiontoaparam-eterizedmodel,\nsuchasaplaneoraquadraticform.ThentestslikeEquation(4)canbe\nappliedtotheresidualsoftheboundary\npixelsafterAlthoughregiongrowingalgorithmsareveryintuitivetheycanrarelybe\nproventoconvergetotheminimumofaglobalcostfunction,andtheresultingregionsmayhavenoisyboundaries.\nAnotherdrawbackresultsfromtheuseofFisher'stest,seeEquation(4),whichcannotdistinguishbet\nweentwodistributionswiththesamemeansbuttvariances.Thisproblemwillbe\ndiscussedinalatersection.3"b"2.3Energy,BayesandMDLBothBayesandMDLspecify\nwaysforsegmentingimagesusingglobalenergyfunctioncriteria.Thesetwoapproachesaremotivatedbytconsiderationsbutitisstraight-forwardtotransferanMDLcriterionintoaBayesianoneandviceversa.Theuseofglobalenergycriteria,derivedfromBayesianprinciples,isacommonapproachtoimagesegmentation[10].\nTheobservedimageismodeled\nasbeing\nadegradedversionofanidealimagewhichisassumedtobe\npiecewisesmooth.\nForexample,theenergyfunctionusedinMumfordandShah[28],\nandinBlakeandZisserman[3](i.e.theweakmembranemodel)\nis:E[f;\n=ZZR(fI)2dxdy+ZZRjjrfjj2dxdy+jj;(5)whereIistheinputimage,fistheoutputimage,andlabels\nthediscontinuities.Itiseasytoseethatwhen7!1thisreducestoacartoon\nmodel:\nE[ffig;=XiZZRi(fiI)22dxdy+jj;(6)wherefiisconstantwithineachregionRiand2=1isconstantovertheentireimage.Ontheotherhand,Leclerc[23]\nsuggeststhatsegmentingimagesaccordingtotheabo\nveBayesianmodel\nshouldbe\nequivalenttoobtainingtheminimumdescriptionlength(MDL)ofitintermsofapreviouslysp\ndescriptionlanguage.Equation(6)isaspecial\ncasewheretheimagedescriptionisintermsofpiecewiseconstantvalues,thestandarddeviationisassumedtobe\ngloballyconstant,andapenalt\nyispaidforencoding\ntheboundary\nproportional\ntoitslengthjj.AmoretypicalMDLcriterionoccurs\ninEquation(7)(seenextsection).ItfromEquation(6)bylettingthe'sbe\nunknownvariableswhichareassumedtobe\nconstantwithineachregion.ItisusuallyverytominimizetheenergyfunctionsresultingfromBayesorMDL.Algorithmssuchassimulatedannealing[10],\ngraduatednon-convexity[3]andde-terministicannealing[9]\nareperhaps\nthemostsuccessful.3RegionCompetition\nforGreyLevelImagesInthissection,wederiveourregioncompetition\nalgorithmfromaglobaloptimizationcriterion.Thenweshowhowtheclassicsnake/balloon\nandregiongrowingalgorithmscanbe\nderivedasspecial\ncases.NextwedoageneralizationtostandardMDLwhichismorerobust.Finallyweillustratetheregioncompetition\nalgorithmbysimulationsongreylevelimages.3.1FromMDLtoAdFrameworkThegoalofimagesegmentationistopartitiontheimageintosubregionswithhomoge-neousintensity(colorortexture)properties\nwhichwillhopefully\ncorrespond\ntoobjects\norobject\nparts.Beforedescribingthealgorithmweneedaofhomogeneity.4"b'InthissectionaregionRisconsideredtobe\nhomogeneousifitsintensityvaluesareconsistentwithhavingbeen\ngeneratedbyoneofafamilyofpre-sp\nprobabilitydis-tributionsP(Ij),wherearetheparametersofthedistribution.Weassumethattheprobabilitymodels\nmayintregions.Suchanassumptionwillbe\nnecessaryiftheapplicationdomainishumanskinandclothes,wheretpatcheswilltypicallyhavetproperties\nandhencewillneedtobe\ndescribed\nbytdistributions.Inlatersectionswewilldescribe\nhowtheprobabilitydistributionsP(Ij)canbe\ngen-eralizedtoresidualsofcertainphysicalmodels\normulti-bandfeaturesextractedfromtheimages,inwhichcasesmayincludestheparametersspecifying\nthosephysicalmodels.\nNowsuppose\nthattheentireimagedomainRhasbeen\ninitiallysegmentedintoMpiecewise\\homogeneous"underlyingregionsfRig;i\n=1;2;:::;M\n,i.e.R=[Mi=1Ri,Ri\\Rj=;,ifi6=j.Let@R\nibe\ntheboundary\nofregionRiwherewethedirectionof@R\nitobe\ncounter-cloc\nkwise,i.e.whenwetravelalongtheboundary\n,Riisonthelefthandside2.Let=[Mi=1ibe\ntheedgesorsegmentationboundaries\noftheentireimagewithi=@R\ni.NowconsideranMDLcriterion{aglobalenergyfunctional{whichisthecontinuumlimitofLeclerc\'s[23]\nforanappropriatechoiceofthefamilyofprobabilitydistributions.Thisgives:E;fig]=MXi=1f2I@R\nidslogP(fI(x;y):(x;y\n)2Rigji)+g;(7)wherethetermwithinthebracesisthelengthoftheboundary\ncurve@R\niforregionRi.Wesimplyassumethatthecode\nlengthisproportional\ntothecurvelengthwhereisthecode\nlengthforunitarclength.Sincealledgesegmentsaresharedbytwoadjacentregions,wedividethetermbyafactorof2.Thesecondtermisthesumofthecostforcoding\ntheintensityofeverypixel(x;y\n)insideregionRiaccordingtoadistributionP(fI(x;y):(x;y\n)2Rigji).isthecode\nlengthneededtodescribe\nthedistributionandcode\nsystemforregionRiandwesimplyassumeiscommontoallregions3.Fortherestofthispaper,\nforpurpose\nofillustration,wewillassumeindependen\ntprobabilitymodels\nsothatlogP(fI(x;y):(x;y\n)2Rigji)=RRRilogP(I(x;y)ji)dxdy.BecausetheenergyEinequation(7)depends\nontwogroupsofvariables{theseg-mentationandtheparametersi\'s{wepropose\nagreedyalgorithmwhichconsistsoftwoalternatingstages.Thestagelocally\nminimizestheenergywiththenumber\nofregionsItproceeds\nbyiteratingtwostepsboth\nofwhichcausetheenergytodecrease.Thesecondstagemergesregionsprovidedthisdecreasestheenergy.Wenowdescribe\nthestage.Inthestep,weInotherwords,weRiandfI(x;y)8(x;y\n)2Rig,andwesolveforthei,i=1;2;:::;M\ntominimizethedescriptioncostforeachregion.ByBayes2Incaseofholes,itwillbe\ncloc\nkwise.3Itispossible\ntousecoding\ntheorytoderivealternativecosts[31]\n[20].\nHowever,wearguethatthesecostsshouldbe\ndeterminedbytheproperties\nofrealimages,ratherthanfromcoding\ntheory,andshouldbe\nfoundempirically[39],\n[40].\n5'b'ruleThiscorresponds\ntosetting4:i=argminiZZRilogP(ijI(x;y))dxdyg;8i(8)Inthediscretecase:i=argmaxiY(x;y)2RiP(ijI(x;y));8i(9)Inotherwords,thei\'sareestimatedbymaximizingtheconditionalprobabilities.Formanydistributionsthiscanbe\ndoneanalytically.Forexample,ifP(Iji)istheGaussiandistributionthenthei\'saresimplythesamplemeanandvarianceofthepixelsinsideRi.Inthesecondstep,wethefiganddosteepest\ndescentwithrespect\ntoForanypoin\nt~v=(x;y\n)ontheboundary\nweobtain:d~vdt=E\n;fig]v(10)wheretherighthandsideis(minus)thefunctionalderivativeoftheenergyE.Takingthefunctionalderivative,seeAppendix,\nyieldsthemotionequationforpoin\nt~v:d~vdt=Xk2Q(~v)2k(~v)~nk(~v)+logP(I(~v)jk)~nk(~v)g(11)whereQ(~v)=fkj~vliesonkg,i.e.thesummationisdoneoverthoseregionsRkforwhich~visonk.k(~v)isthecurvatureofkatpoin\nt~vand~nk(~v)istheunitnormaltokatpoin\nt~v.Weusethecounter-cloc\nkwiseconventionthat~nkpoin\ntsoutwardfromRk5.abcvvfifjiRjRkRfifjfkiRjRFigure2Theforcesactingonthecontour:a.thesmoothing\nforce,b,thestatisticsforceatanbounda\nrypoint.\nc,thestatisticsforceatajunctionpoint\nEquation(11)hasasimpleintuitiveinterpretation.Therearetwokindsof\\forces"actingonthecontour,both\npoin\ntingalongthenormal.Theterm,thesmoothing4Weassumeihasuniformaprioridistribution.5Recentlywenoticedthatasimilarequation(11)wasreported\nin[35].\nButitwasnotderivedfromMDLandthestatisticalmeaningwasnotanalyzedthere.6'b'force,isstrongestatpoin\ntsofhighcurvature.Figure(2.a)showsthesmoothing\nforceatpoin\ntsalongtheregionboundary\n.Thisforceisindependen\ntofthedirectionofthecurveandittriestomakethecurveasstraightaspossible.\nThesecondtermisthestatisticsforce,~f=logP\n(Ij)~n.SincelogP\n0,thestatisticsforcealwayscompressestheregion.Thebetter\nthepoin\nt~vthehomogeneityrequirementthelargerP(Ij),andtheweakerthestatisticsforce.Forexample,asshowninFigure(2.b),~visapoin\ntonthecommonboundary\nofregionsRiandRj.Sincecurvesiandjhaveinversenormalvectorsat~v,wehave~ni=~njandi~ni=j~nj.Themotionequationfor~vis:d~vdt=i(~v)~ni(~v)+(logP\n(I(~v)ji)logP\n(I(~v)jj))~ni(~v)(12)=i(~v)~ni(~v)+log\n(P(I(~v)ji)P(I(~v)jj))~ni(~v)(13)Itiseasytoseethatthesmoothing\ntermbyitselfistheEuclideangeometricheatequationusedforcurvesmoothing\nandevolution,anditisequaltothefollowingheatequation.ddt=@2@s\n2(14)wheresisthearclengthofthecurveDetaileddiscussionsofproperties\nofthisequationaregivenin[12].\nBesidesthesmoothing\nterm,themotionof~visdeterminedbythelikelihood\nratiotest.IfP(I(~v)ji)>P(I(~v)jj){i.e.iftheintensityat~vbetter\ntothedistributionofregionRithantothatofregionRj{thentheboundary\nwillmovealong~ni.Thisisthesameforpoin\ntswhicharesharedbyseveralregionboundaries,\nFigure(2.c)showsthestatisticsforcesatajunctionpoin\nt.Intuitively,adjacentregionscompete\nforownershipofpixelsalongtheirboundaries,\nsubject\ntothesmoothness\nconstraint.Thisiswhywecallouralgorithmregioncompetition.Bothstepsinthealgorithmcausetheenergyfunctiontodecrease6.Inadditionthefunctionisbounded\nbelo\nwandsothealgorithmisguaranteedtoconvergetoalocal\nminimum.Thistwostepprocess,\nhowever,does\nnotallowustoalterthenumber\nofregions.Thusweaddasecondstagewhereadjacentregionsaremergedifthiscausestheenergytodecrease.Thisisfollowedbythetwostepiterationstageagain,andsoon.Overalleachoperation\nreducestheenergyandsoalocal\nminimumisreached.Wearguethatregioncompetition\ncontainsmanyofthedesirableproperties\nofregiongrowing,snakesandballoons.\nIndeedwecanderivemanyaspects\nofthesemodels\nasspecial\ncasesofregioncompetition.\nFirstly,regiongrowingwithconstantthresholdcanbe\nconsideredtobe\nadegeneratecaseofregioncompetition\nwherewetreatthegrowingregionasR1,withP(Ij1)chosenaccordingtoourdesiredhomogeneitycriterion,andthebackgroundregionasR0(sothat6Thistwostepiterationprocess\nissimilartothewell-knownEMalgorithmwhichcanbe\nre-expressedastwosteepest\ndescentstages[14].\n7'b"R1[R0=R)withuniformprobabilitydistributionP0.Thenthemotionequationforeachpoin\nt~valongtheboundary\nis:d~vdt=(logP\n(I(~v)j1)logP\n0)~n(~v)(15)where~nisthenormaloftheregioncontour.Discretizingthisequationcorresponds\ntoregiongrowingwheretheprobabilityP(I(~v)j1)iscalculatedandcomparedwiththeabsolutethresholdP0.Fisher'stest[33]\nandthe2test[26]\ncorrespond\ntoparticularchoicesofP(I(~v)j1).Secondly,theunderlyingstatisticalassumptionfortheballoon/snak\nemodel\nisevensimpler;ittreatsboth\nthecurrentregionR1andthebackgroundR0asuniformdistribu-tionsP1;P\n0with=logP\n1logP\n0.Weobtainthesnakemodel\nasthespecial\ncasewhere=0.Accordingtotheballoon\nmodel,\ntakingthederivativesofequation(3),themotionequationfortheboundary\n~vis:d(s)dt=ss+ssss+(logP\n1logP\n0)~n(s)+~r~rI~rI(16)Thisequationfromregioncompetition,\nEquation(13),intworespects.\nThesmoothing\nforceforballoons\n{thetwotermsontherighthandsideofEquation(16){slightlyfromthesmoothing\ntermforregioncompetition.\nThisisonlyaminormo\nandcouldeasilybe\nremovedbyanalternativesmoothness\ntermintheenergyfunction.TheterminEquation(16)isathresholdfordecidingwhentostopmovingthecontourandisprovidedbylocal\nedgemeasurements.Suchatermdoes\nnotappear\ndirectlyinregioncompetition,\nbutasimilartermcanbe\nobtainedbyincludingacostforencoding\nedgessuchasH@R\nlogP(Ieje)dswhereP(Ieje)istheprobabilityofanedgemeasurementIe,conditionalonanedgeebeing\npresent.However,because\ntheballoon\nmodel\nreliesonlyonedgeinformationanddoes\nnotdostatisticsinsidetheregionsitoftenfailstosegmentimagesintohomogeneousregions.Insummary,theregioncompetition\nalgorithmcombinesthemostattractiveaspects\nofsnakes/balloons\nandregiongrowingtominimizeaglobalcostfunction.3.2GeneralizingtheMDLCriterionforRegionCompetitionToproceed\nfurtherweneedtospecify\nafamilyofprobabilitydistributionsP(Ij).Inthispaper,\nforpurposes\nofillustration,wewillconsiderGaussiandistributions.Thismeansweset=(\n),andP(I(x;y)j(\n))=1p2\nexp(I(x;y))222g:Thistheequationsthoughwestressthatmoresophisticatedmodels\nwillusuallybe\nneededtodealwithrealimages.However,ananalysisofthemotionEquation(13)revealssomeunderlyingdisadvan-tagesforthegreedyalgorithmthatweproposed\n7.First,thestatisticsforceateachboundary\npoin\nt(x;y\n)willdepend\nonP(I(x;y)j\n),inotherwordsontheprobabilitythatI(x;y)ontheboundary\ncanbe\ngeneratedbya7Similarproblemswillariseforsnakesandregiongrowing.8"b"GaussiandistributionN(\n2).Thisforceseemsplausiblebut,sinceonlyasinglesampleistakenfromthisdistribution,thereisareasonablechancethatI(x;y)willlieononeofthetailsofthedistribution.Thiscanleadtothepixelbeing\nandthestatisticsforcethereforemaybe\noverlysensitivetointheintensity.Thiscanbe\nseenintuitivelyinFigure(3.a),wherethesolidcurvesshowtwooverlappingGaussiandistributionsandtheregionofisindicatedbytheshadowedarea.Insubsection(4),wedescribe\nquantitativeresultsshowingtheamountofofthestatisticsforce.s1ms2s1s2mP(x)xm1m2s2P(x)xm1m2=s1abFigure3Twopossible\ndistributionforadjacentregions:a.SolidlinesshowtwoGaussiandistributionwithlargeoverlapduetonoisetheshadowedareadisplaystheerrors.Dashlinesshowthedistributionafterusingwindowsampling.b.TwoGaussiandistributionswithsamemeanbutvariances.Second,inanextremecasewheretwodistributionshavethesamemeanbuttvariances,theerrorwillbe\nintolerable,seeFigure(3.b).OnesuchimageisstudiedinFigure(6).Insuchcases,weneedtomeasurethesecondordermoments(thevariances)neareachboundary\npoin\nt(x;y\n)inordertotellwhetherthepoin\nt(x;y\n)shouldbe\nasbelonging\ntoonedistributionortotheother.Aswementionedearlier,thiscannotbe\ndonebyFisher'stestusedintheregiongrowingalgorithm.Furthermore,ifthedistributionP(Ij)ismoresophisticatedthantheGaussiandistributionthenmorecomplexstatisticsmustbe\ncomputedintheneighborhood\nof(x;y\n).WearguethattheseproblemsareduenotonlytoourgreedyalgorithmbutalsotothenatureoftheMDLcriterion.Forexample,ifthedataisgeneratedbyGaussiansandthevarianceislarge,thenanyalgorithmwillhaveyinclassifyingpixels,because\nofsampleandsofaultysegmentationsmayoccur\neveniftheglobalminimumoftheMDLhasbeen\nreached.Itcanbe\nshown,see[41],\nthatifthedatainaregionisgeneratedbyaGaussianwithvariance2thenthevarianceofthesamplevarianceintheregionisoforder4=N.Forsmallregions,withN<<4,itwilloftenbe\nenergeticallyfavourable,independen\ntoftheminimizationalgorithm,toencode\ntheregionastwo,ormore,sets.ThusstandardMDLcannotbe\nexpected\ntogivethecorrectsolutionforregionsofthissizeandwillhaveatendencytooversegmenttheimage.Wepropose\ndealingwiththeseproblemsbyusingcircularwindowsofmpixelsaround9"b'eachpoin\nt.Wecallthesepixelstheneighbor\nsetof(x;y\n)denotedbyW(x;y).TheofthisistoreplaceP(I(x;y)j)bythejointprobability:Q(u;v)2W(x;y)P(I(u;v)j).Corre-spondingly\n,weobtainageneralizedenergyfunction:E;fig]=MXi=1f2I@R\nidsZZRi1mZZW(x;y)logP(I(u;v)ji)dudvdxdy\n+g:(17)ThewindowWsolvesourproblems.Firstly,weobservethatthelargermisthenthebiggerthechancethatthewindowisrepresentativeofthedistributionandthesmallertheriskofSecondly,thewindowenablesustodohigherorderstatisticsoverfI(u;v):(u;v\n)2W(x;y)gtoanswerthesecondproblemraisedearlier.Butthewindowcannotbe\ntoo\nlargeorwewillnotbe\nabletolocate\nboundaries\naccurately.Thusthereisatradeandlaterinsection(4)weseethattheoptimalchoiceofmdepends\nonthesignaltonoiseratio.ObservethattheoriginalMDLequation(7)willbe\nobtainedasaspecial\ncaseofthegeneralizedenergywhenm=1.Ouranalysiswillshowthisisthecorrectchoiceforhighsignaltonoiseratios.Moreover,theuseofwindowswillhelpreducetheoversegmentationproblemsduetobyelysmoothing\nthesamplemeansandvariances,see[41].\nHowdoes\nourgeneralizedenergyrelatetostandardMDL?Firstobservethatwecanrewriteequation(17)as:E;fig]=IdsZZRMXi=1i(x;y)logP(I(x;y)ji)dxdy+(18)where=[Mi=1@R\ni,andi(x;y)=kRi\\W(x;y)kmsuchthatPMi=1i(x;y)=1forall(x;y\n).Inotherwords,weassumethateachpixel(x;y\n)hasamultiplicativemixturedistribution,P(I(x;y)jfig)/QMi=1Pi(I(x;y)ji).Asseenin4,poin\ntAistotallyinsideregionRi,soi=1;\nj=0;8j6=i.PointBisneartheboundary\n,sothecorresponding\ni;\njareshownbytheshadowareas(similarlyforthepoin\ntatthejunction).pppijkiRjRkRABFigure4Eachpixeliscoded\nbyamultiplicativemixturedistributionwithibeing\ntheshadedpropo\nrtionsinsidethewindow.IfweassumeGaussiandistributionsforP(I(x;y)ji)thenthemultiplicativemixtureP(I(x;y)jfig)isstillaGaussianwithmeansandvariancesdepending\nontheposition\n(x;y\n).Forpoin\ntsintheinteriorofaregionRithemeansandvarianceswillbe\nthoseof10'b'theregion.However,forpoin\ntsneartheboundary\nofregionsRiandRjthemeansandvarianceswillbe\nweightedaveragesofthemeansandvariancesofthetworegions.Thissoftensthechangesinthemeansandthevariancesaswemovefromregiontoregion,see5,andisabetter\nmodel\nforrealisticedgehenceimprovingperformance.\nMoreover,wecanobtainthegeneralizedenergy(17)fromamaximumentropyargument8usingBayestheorem,see[41],\nthoughwithadditionofanextraterm.Wecanshow,however,thatthisextratermissmallandcanbe\nneglected.Hence,(17)canalsobe\nconsideredanMDLcriterion9mmijxRRijGE[I(x)]G+w/2G-w/2Figure5Weplotthemeans,E[I(x)],ofthedistributionsofthepixelsnearthebounda\nrybet\nweenRiandRj.IfweusestandardMDLwithGaussiandistributionsthenthereisastepedgeinatseedashedline.Byconstrast,ourgeneralizedenergysoftenstheedgebyallowingthemeantochangesmoothly\nfrom1to2withinthewindowfrom!=\n2to+!=\n2,seecontinuouscurve.Thevarianceswillbehave\nsimilarly.Intherestofthissection,wewillexploreequation(17)byassumingGaussiandistri-butions.Suppose\nwehavewindowsamplefI(u;v):(u;v\n)2W(x;y)g,witheachI(u;v)N(\n2)shownbythesolidcurvesinFigure(3.a),thenwecancalculatethequantitiesI(x;y)andS2(x;y)asthesamplemean,andsamplevarianceforfI(u;v)g10,thenI(x;y)N(\n2=m),thedistributionshownbythedashedlinesinFigure(3.a).Becausethevarianceshavebeen\ndividedbym,theriskisgreatlyreduced.WecanrewritethestatisticsforcegeneratedbyasingleregionRiat(x;y\n)inthedirectionof~niasthefollowing:1mZZW(x;y)logP(I(u;v)ji)dudv=1mlog\nY(u;v)2W(x;y)P(I(u;v)ji;\n2i)=1mflog\n(2\n2i)m2+X(u;v)2W(x;y)(I(u;v)i)222ig=12flog\n(2\n2i)+(Ii)22i+S22ig(19)8Themaximumentropyderivation,seealso[39]\nand[40],\nusesconstraintsabout\ntheexpected\nnumber\nofregions,theexpected\nlengthsoftheregions,andtheexpected\ndistributionsoftheregionparameters.9Similarresultswouldholdformanyexponen\ntialdistributions[39],\n[40].\n10WeS2(x;y)=(1=m)P(u;v)2W(x;y)(I(u;v)I)2.11'b'Inequation(19),thesecondtermteststhemean,andthelasttermteststhevariance(i.e.theF-test).Withtheadditionofthis\\variance"force,wecandetecttworegionswiththesamemeansbuttvariances,seeFigure(3.b).Equation(19)willbe\ngeneralizedtohigherdimensioninalatersection(seeEquation(35)).Thusfromequation(17),wecanderivethemotionequationforpoin\nt~vatthebound-\naryi\\jbypluggingequation(19)intothemotionequation(13).d~vdt=i(~v)~ni(~v)12flog2i2j+(Ii)22i(Ij)22j+s22is22jg~ni;(20)Beforedescribingthecompleteregioncompetition\nalgorithmattheendofthissection,weexplainhowtodecreasetheenergybymergingtwoadjacentregions.Suppose\nthatni;n\nj;\ni;\nj;\ni;\njarethepixelnumber,\nintensitymean,andintensityvarianceoftwoadjacentregionsRi;R\njrespectiv\nely.LetRij=Ri[Rjbe\ntheregionaftermerging,let`ij=@R\ni\\@R\njbe\nthecommonboundary\nbet\nweenRiandRj,andletij=(ij;\nij)be\nthemeanandvarianceofRij.Itiseasytoseethat:ij=1ni+nj(nii+njj)2ij=1ni+njf(ni)2i+(nj)2j+ninjni+nj(ij)2gThenthechangeofenergyformergingRi;R\njis:E=Z`ijds+ZZRilogP(Iji)dxdy+ZZRjlogP(Ijj)dxdyZZRijlogP(Ijij)dxdy=j@R\ni\\@R\njj+12(nilog\n2ij2i+njlog\n2ij2j+1)(21)Equation(21)isageneralizationofequation(4).IfE0,thenmergingRiandRjwilldecreasetheenergy.Abriefdescriptionofthealgorithmisgivenbelo\nw:12'b'1. initialize the segmentation , we can  put N seeds randomly across the image,\n     and all background (area not occupied by any seed regions) is treated as a\n     single region with uniform probability distribution.2. Fix the boundary G, compute the parameters {ai} by maximizing P(I:ai). in this step, we may need to fit some surface or physical model (see color model).3. Fix {ai}, move the boundary G by minimizing the energy function. When two seed  regions meet, edge is formed at their common boundary, then these two regions\n  compete along this boundary.4. execute step 2, 3  iteratively until the motion of boundary G converges.   Then goto step 5.5. If there is background region not occupied by any seed regions, then put a new\n  seed in the background, and goto step 2;      else goto step 6.\n6. Merge two adjacent regions so that the merging causes the largest energy\n decrease, goto step 2.  if no merge can decrease the energy, then goto step 7.\n7. stop.the region competition algorithm:3.3SimulationsonGreyLevelImagesInthissubsection,weillustratetheregioncompetition\nalgorithmontwotypicalgreylevelimages.Figure(6.a)isa100100imagepartitionedintotworegionsbyaS-shaped\ncurve.TheintensitiesinthesetworegionsaregeneratedrandomlyfromtwoGaussiandistribu-tionswithidenticalmeans:N(128;102)andN(128;352).Suppose\ntheimageisinitiallysegmentedbyaslantedstraightline,seeFigure(6.b).Thenthemotionoftheregionsatiterationstepst=0;20;30;50areshowninFigure(6.b.c.d.e)respectiv\nely.FinallyFigure(6.f)\nshowshowtheboundary\nmovesifwedropthelastterminEquation(20).Thusifwedonottestthevariancethentheedgejustmovestothelow-rightcorneranddisappears.\nThisresultsinanincorrectsegmentationwiththeimagebeing\nperceiv\nedasasingleregion.Forthisimage,weuseacircularwindowWwhichcontains32pixels.Figure(7.a)isa150150imageconsistsoffourregionswhoseintensitiesaregener-atedrandomlyfromfourGaussiandistributions:N(50;102);N\n(80;102);N\n(110;112),andN(150;152).Thesegmentationisstartedbyputtingnineseedregions(eachhas80pixels)onagrid,withfourseedsinsidethefourregions,fourseedsstraddlingtheboundaries,\nandoneseedlyingontheintersectionpoin\ntofthefourregions.Aswewillinthenextsection,thefourregionsarecalledthegoodseeds,whilethelatereonesthebadseeds.Thebackground(shownbytheshadow)istreatedasasingleregionwhichhasuniformprobabilitydistributionP0.Asdiscussedearlierforballoons,\nP0providestheforcescausingtheseedregionstogrow.Themotionofregionsatiterationstepst=0;10;30;42;65;120\n;150\nareshowninFigures(7.b.c.d.e.f.g.h)respectiv\nely.Att=10weobservethatthegood\nseedsgrowfasterthanthebadseeds.Wheretheseregionsmeetedgesareformed,seeFigure(7.d).13'b'a(image)b(t=0)c(t=20)d(t=30)e(t=50)f(withoutF-test)Figure6Tworegionswithidenticalmeansbutvariances.Seetextforinterpretation.Thefourgood\nseedskeepcompressingthebadregionsandtakingoverthebackground,seeFigure(7.e.f.).Duringcompetition\nprocess\nsomeregionsmaybe\nsqueezedoutorsplitbytheirneighbors\n(seestept=42).Finallythecompetition\nconvergesatt=120inFigure(7.g)withallthebadseedregionsbeing\ndrivenintooneofthefourrealregions.Then,inthesecondstageofthealgorithm,wemergethepairsofadjacentregionswhichcausetheenergyfunctiontodecreasethemost,andrestartthestageofregioncompetition.\nAfter30moreiteratives,thealgorithmconvergesatt=150,seeFigure(7.h).Thecurrentimplementationhastwodrawbacks.Firstly,observethatthebounding\ncontoursaresometimesjaggedanditappears\nthatthesmoothness\ntermisnotalwaysdoingitsjob.Secondly,thegood\nseedsinthefoursquaresofFigure(7)allappear\ntogrowatsimilarspeeds\neventhoughthevariancesintheseregionsBoththesecanbe\ntracedtothesimplediscretizationusedinourcurrentimplementationofthealgorithm.Moresophisticateddiscretization,currentlybeing\ninvestigated,wouldeliminatetheseproblems.Finallyweshowanimageforwhichthealgorithmgetsawronganswer,see(8).Thelinesandspots\naredegenerateregions{i.e.theyhaveoneandzerodimensions{whichdonotourassumptionsabout\ntheimageandhencecausethealgorithmtogivetheincorrectsegmentation.Itconvergestoastatewheretheleftsideoftheimage,whichhasahighdensityoflines,isconsideredaseparateregionfromtherightsideoftheimage(wherethelinesaresparse).Itcompletelyfailstolocate\nthefourblobsintherightoftheimagebecause\ntheyaretoo\nsmall.Tosucceedouralgorithmwouldneedtobe\nmo\ntocontainanedgeterm,asdiscussedinsection(3).14'b'a(image)b(t=0)c(t=10)d(t=30)e(t=42)f(t=65)g(t=120)h(t=150)Figure7Thecompetition\nofgood\nandbadseedregions.Seetextforinterpretation.15'b'a(image)b(t=180)Figure8(a)animageofuniformGaussianN(128;152)withsmallblobsof33pixelsandlines(greyvalue200)ofonepixelwidthsuperimposed\nonit.(b)thesegmentationaftermerging.Notethefailuretodetectthesmallblobsandmanyoftheedges.4AnalysisoftheBoundaries,Windows,andSeedsTofurtherunderstandtheperformance\noftheregioncompetition\nalgorithm,itiscrucialtoanalyzetheprecisionoftheboundary\nandtheoftheinitialseedForreasonsofspacewesummarizetheresultshereandreferinterestedreadersto[41]\nformoredetails.Firstlyweshowthatthereexistsanuncertaintyinterval0fortheboundary\n,andshowhowtochoose\nthesizeandshape\nofthewindowWtominimize0.Inthefollowing,weusesquarewindowsandassumeGaussiandistributionsformathematicalconvenience.Figure(9.a)showstworegionsR1;R\n2lyingintheleftandrighthalf-planessox=0isthe\\true"boundary\n.Thedashedlineistheboundary\n12atagivenmoment.TheintensitydistributionsforR1;R\n2areN(1;\n21)andN(2;\n22)respectiv\nely,asshowninFigure(9.b).IfR1andR2arebigenoughthenwecanassumethatthestageofregioncompetition\nhasfoundthetruedistributionparameters(1;\n1);(2;\n2).Duetosymmetry,andwithoutlossofgenerality,wecanreducef(x;y)tof(x),i.e.analyzeitalongthex-axisonly.Itiseasytocomputethestatisticsforceas:f(x)=a2ln2221+a2mX(u;v)2W(x)((I(u;v)2)222(I(u;v)1)221)(22)wherea=log\n2eisaconstant.Obviously,f(x)isarandomvariabledepending\nonthelocation\n(x).Sinceouralgorithmplacestheboundary\n12atpoin\ntswheref(x)=0,thedistributionoff(x)willindicatetheprecisionoftheboundary\nlocation.\nTofurthersimplifythediscussion,weassumethat1=2,andderivetheexpectation\nandvarianceoff(x),with=12,and(x)=kW(x)\\R1kkW(x)k:E[f(x)]=(x)1)a222D[f(x)]=a22m2:16'b'N(m , s  )12122\n2N(m , s  )0I(x)x( s  = s  = s )12\nE(f  )(x)D(f  )(x)ao+\n-x--2w+-w2( m  = m   ;  s  < s   )121\n2xabcdx0fR12RE(f  )(x)D(f  )(x)ao+\n-+-w2--2wFigure9Theexpectations\nandvariancesofthestatisticsforcef(x).Seetextforinterpretationof(a),(b).In(c)and(d)thesolidlinesshowE[f(x)],andthedashedlinesshowtheintervals,inotherwords,upper\nandlowerbounds\nfortheforceIn(9.c),thesolidlinesshowE[f(x)],andthedashedlinesshowtheintervalE[f(x)]oqD[f(x)],\ninotherwords,upper\nandlowerbounds\nfortheforceations.Forexample,ifo=1:95thentheprobabilitythatf(x)fallsbet\nweenthedashedlinesis0:95.From(9.c)weobservethatFact1:SinceE[f(0)]=0,12calculatedbytheregioncompetition\nalgorithmisanunbiasedestimateforthetrueboundary\n.Fact2:Theintervalof12isbytheintersectionsofthetwodashedlineswiththex-axis,shownbythethicklinesegment.Thelengthofthisthicklinesegmentis:0=2o(23)Observethat,sincethevarianceoftheforce,D[f(x)],willbe\namonotonicdecreasingfunctionofthewindowsizem,thusthelargerthewindowthelesstheforceandthecloserthedashedlinesaretothesolidline.From(9.c)weseethatwindowsizemhastosatisfythefollowingconstraints:E[f(x)]oqD[f(x)]08x<!2(24)E[f(x)]+oqD[f(x)]08x>!2(25)Otherwise,theuncertaintyintervaloftheedge(i.e.thethicklinesegment)willbe\nin-long,inotherwords,theboundary\nmaybe\nlocated\natanypoin\ntwithacertain17'b'probability.Forinstance,inthecaseof(9.c),solvingtheabo\nveinequalitiesgivesm42o22.Noticethat22isthesignal-to-noiseratio(SNR);clearlyinanimagewithhighcontrastregions(i.e.highSNR)where>>,wecansimplychoose\nm=1.Thisexplainswhyregiongrowingalgorithmsworkforcertainimages.Butoncethewindowisbigenough,0becomes\naconstant(seeequation(23))Thiscorresponds\ntothegeneralun-certaintyprincipleinimageprocessing[36].\nWechoose\nthewindowsizetobe\nthesmallestmwhichtheinequalities(24,25).0R12Rf(x)G( s  = s  = s )12\nE(f  )(x)D(f  )(x)ao+\n-x--2w+-w2xFigure10Whenanellipsewindowisusedwiththesamesize(area)m,theuncertaintyintervalshownbythethicklinesegmentbecomes\nsmaller.Figure(9.d)showsanotherspecial\ncaseswhere1=216=2.SinceE[f(0)]6=0,theresultingboundary\nwillbe\nabiasedestimateofthetrueboundary\n.Thustheboundary\nwillbe\nmovedtotheregionwhichhaslessvariance.Thiswillbe\nnoticableinthetexturesegmentationoflatesection.Furtheranalysissuggeststhattheprecisionoftheboundary\nwouldbe\nincreasedbyusingellipticalwindowswiththeirmajor\naxesparalleltotheboundary\n,see(10).Thiswouldrelateourapproachmorecloselytostandardedgedetectors.Byusingvarioussurfacemodels\ninthetwoadjacentregions,ourapproachcoulddetectstepedges,creaseedges,orevenC2edges.Thisisasubject\nofcurrentresearch.Secondly,theperformance\nofregioncompetition\nwillhighlydepend\nontheinitialseedsInfact,eachinitialseedisahypothesis\nabout\nthelocationofacertainprobabilitydistributionfamily(oramodel).Therefore,weaseedtobe\n"good"\nif:(i)itiscompletelyinsidea\'true\'region,and(ii)itpicksthecorrectprobabilityfamily(ormodel).\nAseedisbadifitfailstosatisfyeitheroftheseconditions,typicallybecause\nitstraddlestheboundary\nbet\nweentworegions.Thustodecidewhetheraseedisgood\nornotwemusttestthesamplecharacteristics.In[41]\nseveraltestsareproposed\nforthespecial\ncaseofGaussianmodels,\nsuchasskewnessandkurtosis.Itisillustratedthatthesetestsautomaticallyselect"good"\nseedscompletelyinsideregionsandavoidselecting"bad"seedswhichstraddleboundaries.\nEmpiricallyweobservethatatconditionforanoptimalsegmentationisthatatthebeginning\neach`true\'regionincludesatleastonegood\nseed.Butthisisnotanecessarycondition.Itcanbe\nshownbysimulations,that"good"\nseedscanconvert"bad"seedsbyatype\nofdominoIn(11)weshowseveralstagesofregioncompetition\nrunningontheimageshownin(7).whereseed1,2,3,4arebadand18'b'123451234512345a(t=0)b(t=20)c(t=50)512345123451\n23\nd(t=84)e(t=126)f(t=150)Figure11TheDominocomvertingbadseedsintogood\nones.Theimageisin7(a).seed5isgood.\nAtthestage,allbadseedsgrowacrosstheboundaries\n(seet=20).Aftertheycontacteachother,seed5drivesseeds1and2outoftheupper-left\nregion(seet=50).Bytimestept=84,weobservethatseeds1and2havebeen\ncompletelyexpelled\nfromtheupper-left\nregion,andboth\nbecome\ngood\nseeds,whileseeds3and4remainbadseeds.Onceseed1and2become\ngood,\ntheykickseeds3and4outfromtheirterritoriesuntil,attimestept=126,both\nseeds3and4aredrivenintothelower-rightregionandbecome\ngood\nseeds.Finallytheyaremergedintoasingleregionatt=150.Suchdominowillcontinuewhenmoreregionsareinvolvedandwethinkthisisakeybet\nweentheregioncompetition\nalgorithmandconventionalregiongrowingapproaches.Ifseed5wasnotpresentthesegmentationwouldbe\nincorrect,see[41].\n5MultivariateModels:\nColorTheprevioussectionshavedescribed\nsegmentationtechniqueswhereregionsareconsid-eredtohavehomogeneousintensityproperties.\nButtheimageintensityisafunctionboth\nofthematerialproperties\noftheobject,\nitsalbedo,\nandthesurfaceorientationandlighting.Formanyapplicationsimagesegmentationshouldbe\nbasedonthealbedo\nandinde-penden\ntofthelightingconditionsorthegeometricofthematerial.Forexample,ifwearelooking\nataperson\nthentheskinoreachpatchoftheclotheswillhaveconstantalbedo\nproperties\nbuttheintensityoftheskinorclothesmaychangedramaticallyduetothechangesofthegeometric19'b'5.1TheColorModelIfweincludespecularit\nyintheimageformationprocess\nthenthestandardcolordichro-maticmodel\nis[21]:I(~\nri)=(~\nrs)Fb(~v;~\nn;~\ns)E(~\nn;~\ns)+Fs(~v;~\nn;~\ns)E(~\nn;~\ns)+noise(~ri)(26)whereIistheimageasfunctionoftheimageposition\n~riandwavelength,isthesurfacealbedo\nasafunctionofandsurfacelocation\n~rs,Fisthegeometricviewingtermasafunctionofthesurfacenormal~nandthelightsourcedirection~s,andEisthesurfaceirradianceasafunctionof,~nand~s.Ingeneral,thetermcorresponds\ntothebody\nandthesecondtermcorresponds\ntospecularities\n(typicallyhighlights).Thismodel\nhasbeen\ntestedoverarangeofmaterials[25]\nandisshowntobe\nagood\napproximationinmanycases,thoughitfailsforsomedielectrics.Ifweassumered,green,andbluecolorbands,thenwecansimplifyEquation(26)ateachpoin\nt(x;y\n)to:0B@RGB1CA(x;y)=0B@rgb1CAI(x;y)+0B@rsgsbs1CAIS;(x;y)+0B@eregeb1CA(x;y)(27)where(r;g;b\n)isthe(assumed)spatiallyconstantbody\ncolorwithineachregion,(rs;g\ns;b\ns)isthe(assumed)spatiallyconstantcolorofthelightsource,I(x;y)istheillumination,IS;(x;y)isthespecular\ncomponen\nt,andthe(er;e\ng;e\nb)(x;y)aretheresiduals(ornoise).Althoughtherehavebeen\nmanyattemptstoseparatethebody\ncolor(r;g;b\n)fromthespecular\ncolor(rs;g\ns;b\ns)[21],\n[15],\n[34],\ntheseapproacheshavebeen\ndemonstratedonplasticandmetalobjects\nwithniceillumination.Ifthenoiselevelisquitehighandtheintensityaroundthespecular\nregionsareapproximatelysaturated{conditionscommonlyobservedforskinandclothes{itwillbe\nverytoseparateoutthespecularit\nyusingtheseapproaches.Fornowwesimplycombinethehighlightsintothebody\nandtheresiduals(highlightscanbe\ndetected,see(12c),fromtheformoftheresiduals)giving:0B@RGB1CA(x;y)=0B@rgb1CAI(x;y)+0B@eregeb1CA(x;y):(28)Weusenopriorknowledgeabout\ntheilluminationI(x;y)orthecolors(r;g;b\n).Thisisequivalenttoassumingthattheyarecoded\nbyuniformprobabilitydistributions,ratherthantheGaussianmodels\nusedinsection(3).Wenowdeterminetheresidualsbyassumingthattheyareassmallaspossible,\nintheleastsquaressense,whilerequiringthatEquation(28)isTheresiduals,thealbedo\n(r;g;b\n)andtheintensityI(x;y\n)canbe\nfoundbyminimizingthesumofthe20'b'squarederroroverallpoin\nt(x;y\n)withinregionRi:(r;g\n;b\n;I\n(x;y))=argminr;g;b;I\nX(x;y)2Ri0B@RGB1CA(x;y)0B@rgb1CAI(x;y)2:(29)Weminimizethisenergybysteepest\ndescent(thoughSVDcouldalsobe\nused).Thesolutions,(r;g\n;b\n;I\n(x;y)),attheminimummustsatisfy(minimizingequation(29)withrespect\nto~randI(~x)):(r;g\n;b\n)=RRRiI(x;y)(R;G;B\n)(x;y)dxdyRRRiI(x;y)2dxdyI(x;y)=(r;g\n;b\n)(R;G;B\n)(x;y)(30)wherewehaveimposed\nthenormalizationconstraintr2+b2+g2=1.RGB(r ,g ,b )b123aobbbcb***\nFigure12TheColormodels,\na).theirradianceequation,b).residualsdistributionforhomoge-neouscolorregions,c).residualdistributionforahighlightregionsInotherwords,asseeninFigure(12a),weaunitvector(r;g\n;b\n)intheRGBspaceandproject\neachpixelcolorvector(R;G;B\n)(x;y)ontothisvector.Thepro-jectedlength(i.e.theirinnerproduct)\nistheintensityI(x;y).Thentheresidualvector(er;e\ng;e\nb)(x;y)isperpendicular\ntothecolorvectorshowninFigure(12a).Thereforealltheresiduals~Xlieona2Dplanewhosenormalis(r;g\n;b\n).Byanalyzingthedistribution(histogram)ofresidualsf~Xginplaneoverourdatasetofregionswithconstantalbedo\n11,wefoundthatiftheregionsizeislargeenough,saylargerthan100pixels,thentheseresidualscantypicallybe\nmodeled\nbya2DnormaldistributionN(withveryclosetozero.Inourexperimen\nts,wecalculatethe22covariancematrixcanbe\nintuitivelyrepresentedbyanellipseinplanewithitseigenvalues1;\n2(12)asthesquaredlongandshortaxesoftheellipse,andtherotationalangleastheorientationoftheellipse.11Thisdatasetconsistedofclothandskinpatcheschosenfromrealimages.21'b'Figure(12b)showsatypicalresidualdistributionforahomogeneouscolorregion.BycontrastFigure(12c)isatypicalresidualdistributionforahighlightregion.Thecanbe\nseenintheaspect\nratioa=p12.Foraregionwithoutahighlightwetypically1a2,butinahighlightregionweusuallya4.Inotherwords,highlightresidualstendtohavealargercomponen\ntintroduced\nbythespecularit\nyvector,i.e.thesecondterminequation(27).Wethereforeusethispropert\nytodetecthighlights.Hereagainweseethatthewindowattheboundary\nandthesecondordermomentsarecrucialforhighlightdetection.Thiscolormodel\nhasallowedustodecompose\ntheinputcolorimageintoaconstantcolorterm,avaryingintensityterm,andtheresidualsona2Dplane.Ourmethod\ncanbe\ncontrastedtothecurrentlyexistingapproaches,forexample[34],\nwhichtriestoeliminatetheintensitytermbynormalizingtheinputcolorimages,i.e.sendingR(x;y)7!R(x;y)(R+G+B)(x;y).Weclaimthatourmethod\nhasadvantagesbecause\nthestan-dardnormalizationbecomes\nverynoisesensitiveatplaceswhere(R+G+B)(x;y)issmall,butinourmethod\nsuchpoin\ntshavelittleweight,seeFigure(12a)wherepixels(1)and(2)havethesamecolorbuttintensityI{theresidualerrorissmallerfor(1)andtherefore(1)haslessweightindeterminingtheregioncolor(r;g;b\n).Bothapproaches,however,sharethedisadvantagethattheycannotdetectintensityboundaries,\nbecause\ntheyhavefactoredouttheintensity.Ourworkalsofromtheapproachin[18]\nwhoencode\nstructuredmodels\nforthered,green,andbluecomponen\nts{whichissimilartoapplyingourgrey-levelmodel\ndirectlytothreecolordimensions.Forcertaintypes\nofilluminationthiswillbe\nessentiallythesameasourmodel.\nWeargue,however,thatitisimportan\nttofactorouttheilluminantsoastogetsegmenationbasedonalbedo\nratherthancolor.Similarlyourmethod\nfordetectingspecularities\nistfromtheonedeveloped\nin[21]\nwhichcalculatesthe33covariancematrixoneachpatchindependen\ntlyandthecolorpatchesinto23=8classesbasedonthesizeofthethreeeigenvalues.Wearguethatthisapproachisnotapplicabletoourapplicationandthephysicalmeaningoftheeigenvectorsisnotalwaysclear.Forexample,inaregionwithconstantcolorbutheavygradientshadingthebiggesteigenvaluewillcorrespond\ntoilluminationchangeswhileinaregionwithlessshadingbutbignoisethelargesteigenvaluewillinsteadcorrespond\ntonoiseForthesereasonswearguethattheeigenvalueanalysisshouldbe\ndonein2Dinsteadof3D.Bycontrast,analternativeapproach[15]\nworksonnormalizedcolorimagesbutin-volvesaseparateedgedetectionmechanismtohelpgrouptheimageintoregionswithconstantmaterialproperties.\nThetestforspecularit\nyistfromoursandweareunabletocompareitdirectly.5.2ColorSegmentationAsbefore,\ntheregioncompetition\nalgorithmiteratestwosteps.Inthestep,wetheboundary\nandcomputethebest\ncolor(ri;g\ni;b\ni)foreachregionRi.Thenwecalculatetheresiduals~X(x;y)ontheiplane,whosenormalis(ri;g\ni;b\ni),foreach22'b'(x;y\n)2Ri.WethemeanandcovarianceofregionRi(withjRij=N)tobe:\n~i=1NX(x;y)2Ri~X(x;y);i=1NX(x;y)2Ri(~X(x;y)~i)(~X(x;y)~i)(31)Thesecondstepinvolvesmovingtheboundary\nbyminimizingtheMDLcriterion.Forapixelp=(u;v\n)ontheboundary\nofregionRiwecalculate:(i)theprojection\nof(R;G;B\n)(u;v)ontothe(ri;g\ni;b\ni)vector,and(ii)theresidual~Y(u;v)intheiplane.Similarlytothegreylevelcase,wesampleawindowcontainingmpixelsandobtainasetofmeasurements(~Y1;:::;\n~Ym).Wetheprobabilityforthesepixelstobelong\ntoregionRitobe:\nmYj=1P(~Yjj~i;i;(ri;g\ni;b\ni))=1(p2)mjjijjm=2exp12mXj=1(~Yj~i)T1i(~Yj~i)g(32)Wemodify\nequation(17)toincludethesedistributions.Thentheupdate\nequationsfortheboundary\nareobtainedbydoingsteepest\ndescent,asbefore.\nOnceagainwecanrelatethisapproachtoconventionalregiongrowingusingstatisticaltests.Wethewindowmeanandco-varianceby:~Y=1mmXi=1~Yi;S=1mmXi=1(~Yi~Y)(~Yi~Y)T:(33)ThesearetstatisticsfortheGaussiandistribution,thus:mYj=1P(~Yjj~i;i;(ri;g\ni;b\ni))=Ciexpm2f(~Y~i)T1i(~Y~i)+tr1iS)gg(34)whereCi=1(p2)mjjijjm=2,and\\tr(:)"denotesmatrixtrace.ThusthestatisticsforcegeneratedbysingleRiat(x;y\n)isfi~ni,with:fi=12(log(2\n)+logjjijj+(~Y~i1i(~Y~i)+tr1iS))(35)ObservethatEquations(35)generalizesequation(19)tohigherdimensions.AsforthegreylevelcasewecanidentifythetermsontherighthandsideofEqua-tion(35)asthestandardgeneralizationsoftheTandFteststohigherdimensions.Observethatweonlyintroduce\nprobabilitiesafter(r;g;b\n).Ideallywewouldesti-mate(r;g;b\n)andI(x;y)bymaximizingaprobabilitymodel\nP((R;G;B\n)(x;y)j(~i;i);fI(x;y)g;(ri;g\ni;b\ni)),seeequation(9).Howeveritturnsout,see[41],\nthatsuchamodel\nishardertoworkwithandrequiresmorecomplexcomputations.Fortunately,ourmodel\nisequivalenttothefullprobabilitymodel\nprovidedweassumethatthecomponen\ntsoftheresidualvectorshavezeromeanandidenticalvariances.Theseconditionsareapproximatelybyourimages,exceptatspecularities,\nsowearguethatourmodel\nisagood\napproximationwhichtlyreducesthecomputation.23'b'5.3ColorImagesExperimentsFigure(14a)showstheredbandofacolorimageof261116pixel.Observethenoise,shadingintheclothandthehighlightsonseveralpartsoftheskin.Figure(13)illustratestheshadingbyplottingcrosssectionsinthegreylevelimage,(14b),(obtainedasalinearcombinationofthered,green,andbluebands).010203040506070Location Along Line406080100120140160Pixel ValueCross Section: Band 0 Line: (156,45)->(219,62)010203040506070Location Along Line10203040506070Pixel ValueCross Section: Band 0 Line: (121,35)->(177,97)020406080Location Along Line406080100120140160180Pixel ValueCross Section: Band 0 Line: (99,16)->(124,100)Figure13Crosssectionsforthewomanimage,see(14b).Fromlefttorightweshowthecrossectionsontheface,torsoandarmsrespectively\n.Thealgorithmwasimplementedasforthegreylevelcase.Figure(14c)showstheinitialseedsatiterationstept=0.Figures(14d,e,f,g,h)showsthesequenceatstepst=10;20;60;100;135respectiv\nely.Thecompetition\nbet\nweentheseedregionsconvergedatt=100asshowninFigure(14g).Thesmallshadowregionsaretheimagespaceswhicharenotoccupied\nbythe20initialseeds.Insuchregionsweneedtointroduce\nadditionalseedswhichcancompete\nwiththeinitialones.Weobservethattheeyesandmouthareincludedinthefaceregionbecause\ntheyaretoo\nsmall(about\n10to25pixels)andthusaretreatedasnoise.ObserveinFigure(14g)thatthealgorithmdetectsthehighlightsandlabels\nthemcorrectly.Thesehighlightregionsare:(1)ontheneckandshoulder,(2)ontheleftarm,(3)ontheleftleg,(4)onthebreast.Figure(14h)showsthesegmentationafterspreadingadditionalseedsandmerg-ing.Inmostcase,itisdesirableforthecolormodel\ntoeliminateshadingbutinsomecases,itbecome\ndisadvantageous.Forexample,ablackregionlikethehairwillwelltoanycolorregions.Inadditionsmallregionsliketheeyesandteethareincorrectlymerged.Inourimplementation,weputaconstraintinthemergingstepsothattworegionswithenormousintensityshouldnotbe\nmerged.Thispreventsthehairfrombeing\nmergedwithotherregions.Weconsiderthistobe\nanaivewayforintegratingthecolorandintensityclues.Amoresophisticateddatafusionalgorithmisunderimplementation.Wegivetwootherexamplesofouralgorithm.Figure(15)showsahandcorrectlysegmentedfromabackgroundofredandwhitefabricwiththedonutcorrectlylocated.\nThisimageshowsthatthealgorithmworksevenifthebackgroundregionisnotGaussian.Thehighlightsonthenails,andring,arecorrectlydetected(exceptforthesecondwhentheparameterislowbutaremergedwiththewhenisincreased.Figure(16)showsasquirrelbeing\nsuccessfullysegmentedfromagrassybackground.Thecolorofthesquirrel,however,isnotconstantandthealgorithmsegmentsitintothe24'b'a(redband)b(greylevel)c(t=0)d(t=10)1234e(t=20)f(t=60)g(t=100)h(t=130)Figure14Segmentationofacolorimageofawoman.Seetext.25'b"correctcolorparts.Thecolorvariesalotonthetailandsoseveralregionsarefound.abcdFigure15(a)thehandimageshowningreylevel.(b)after70iterationsteps.(c)thesegmentation{thehighlightregionsonthenailsaredetectedcorrectlyexceptonthesecond(d)increasingcausesthenailstomergeintothehandNotethattheimagesinthissectioncanbe\nviewedincolorontheauthor'swwwhomepagehttp://hrl.harvard.edu/people/studen\nts/zhu/zhu.html.6TextureSegmentationWecandirectlyadaptouralgorithmtoperform\ntexturesegmentation.Firstweapplyasetofptexturetotheinputimagetoobtainasetofptextureimages.Thisgivesusamulti-bandinput(s1;:::;s\np)(x;y)ateachpixel(x;y\n).Then~X=(s1;:::;s\np)isconsideredtobe\nap-dimensionalrandomvariableateachpixel.Wethenapplyourmulti-bandmodel,\nassumingmulti-variateGaussiandistributions,usingthe~Xasinput.Inthispaper,\nforpurposes\nofillustration,wesetp=2andset~X=(GIx;G\nIy)whereGisazeromeanGaussianwithstandarddeviationanddenotesconvolution,(Ix;I\ny)=rIisthegradientofimageI.Thisstatisticcapturesthelocal\norientationofthetextureelements(ortextons).Figure(18a)showsatextureimageof172247pixels.Foreachregion{suchasthe26"b"Figure16left:Asquirrelsittingonthegrassdisplayedasgreyimage.right:Thegrasshasveryvariableintensitybutthesegmentationisgood.\ncheetahbody\n,thegrassandthewestudythesecondordertexturestatistics:~=1NNXi=1~Xi;=1NNXi=1(~Xi~X)(~Xi~X)(36)Thelowerhalfof(17)showsthehistogramsofGIx;G\nIyonthethreeregions.SuchGaussian-likehistogramsindicatethatthesecondorderstatisticsaregood\ndiscriminators.Wefoundthatthe~'sareveryclosetozeroforallregions.Thesamplecovariancecanbe\nsimplycharacterizedbyitseigenvalues1;\n2andthedirectionbet\nweenthelargesteigenvectorandthexaxis.Theupper\nhalfof(17)showstheellipsecorresponding\ntovarioustextureregionswith1;\n2;\nlistedontherighthandside.Ouralgorithmproceeds\nasinthecolorcaseusingequation(34)butwithr;g\n;b\nbeing\nsettozero.Firstwecomputethestatistics(~i;i)foreachregionRi.Themeansforalltheregionsareclosetozero,seeFigure(17),sothecovarianceisthemajor\ndiscriminator.Thenwesampleinawindowsurroundingaboundary\npixel(x;y\n)andcomputethesamplemeanandthesamplecovariance.Inordertoobtainenoughdatatocalculatethesesamplecovariancesreliablywechoose\nthewindowsizemtobe\nlarge.Wesetm=68forourexperimen\nts.Thesesamplemeansandcovariancescanbe\nusedtocomputethestatisticalforcesexactlyasinEquation(35).Asbefore\ntheseforces,inconjunctionwiththesmooth\nforces,willupdate\nthepositions\nofthecontourboundaries.\nFigure(18b)istheresultaftermerging,whereweobservethatthebelly\nofthecheetah,whichishighlyshadowed,ismergedwiththegrassunderthebody\n.Thisisduetothesimilarityoftheircovariancematrices,seethecorresponding\nellipsesshowninFigure(17).Sincethevarianceschangedramaticallybet\nweenregions,forexample,thevarianceinthecheetahregionisabout\n62timeslargerthanthatintheregion,itcanbe\nshown[41]\nthatthebiasoftheboundary\nlocation\nwillbe\nnoticeable.ThisexamplehasonlyusedtwotextureRecentlyoneofus[39]\ndeveloped\nanoveltexturemodel\nwhichincorporates\nGabor\nfeaturesintoaprobabilitymodel\nandisabletosynthesizealargenumber\nofrealtextures.Hopefully\n,withthismodel\nitwillbe\n27"b'CheetahGrassBuffaloIxIyll\nqgrass   6.05   3.24   178.9cheetah  14.4   13.9   130.5buffalo  2.58   2.42   119.0shadow\nbelly6.33   5.86   112.4grassunder body5.24   4.58   96.612\n(degree)shadow\nbellygrassunder bodyCheetahGrassIx-21-13-531119Intensity0102030405060Number of PixelsIntensity Histogram (band 0)-16-10-42814Intensity020406080Number of PixelsIntensity Histogram (band 0)-12-7-238Intensity020406080100Number of PixelsIntensity Histogram (band 0)Iy-30-20-100102030Intensity01020304050Number of PixelsIntensity Histogram (band 0)-10-6-226Intensity020406080Number of PixelsIntensity Histogram (band 0)-11-7-315Intensity020406080100Number of PixelsIntensity Histogram (band 0)Figure17ThestatisticsandhistogramsofGIx;GIyonseveralregionsofthetextureimage28'b'abFigure18Segmentationofatextureimagepossible\ntoperform\nanormalizationbet\nweentexturebands,aswedidforthecolorbands,andreducetheofgradientscausedbyshadowsandgeometric7ConclusionWehavedesignedanovelalgorithm,regioncompetition,forimagesegmentationbymini-mizingageneralizedMDLcriterion.Thisalgorithmcombinessomeofthemostattractivefeaturesofsnakes/balloons\nandregiongrowing.Wehavesuccessfullydemonstratedourapproachongreylevelimages,colorimages,andtextureimages.Forcolorimageswehavedeveloped\nnewwaysto:(i)eliminateintensitygradientsduetoshadowsandgeometricfactors,and(ii)todetectspecularities.\nItispossible\ntoextendthisworkby(i)integratinggreylevel,colorandtexturecues,(ii)integratingtheapproachestolocate\ntheedgemoreprecisely,(iii)usingthisalgorithmasafrontendforourobject\nrecognitionsystems[38].\nAcknowledgmentsItisapleasuretoacknowledgemanyhighlystimulatingdiscussionswithDavidMumfordandTaiSingLee.TaiSingLeeworkedwithusonthetexturesectionandisaco-authorfortheversionofthisworkwhichappeared\ninICCV.TheauthorsalsothanksYingnianWuforhisconsultingroleinstatistics.Wewouldalsoliketothanksomeanonymousrefereesandaneditor,ByronDom,forsomeextremelydetailedandhelpfulreviewingwhichgreatlyimprovedthepaper.\nTheauthorwassupported\nbytheNSFgrantDMS-91-21266toDavidMumford,andthisworkwasalsosupported\ninpartbytheBrown/Harvard/MITCenterforIntelligentControlSystemswithU.S.ArmyResearchgrantnumber\nDAAL03-86-K-0171,andARPAforanAirForcecontractF49620-92-J-0466toAlanYuille.29'b"Appendix\nInthepreceedingsectionsweneedtotakefunctionalderivativesofintegralsalongcontoursandintegralsoverregions.Thisappendix\nshowshowtoperform\nthesederivatives.Consider:E(s)]=ZZRf(x;y\n)dxdy;\n(37)where(s)=@R\n=(x(s);y\n(s))istheboundary\ncontouroftheregionR,with0s`isthearc-length.Green'stheorem12statesthat:foraplanarregionR,(P(x;y);Q\n(x;y))isanyvectorwithcontinuousorderderivatives,thenZZR(@Q\n@x\n@P\n@y\n)dxdy=Z@R\nPdx\n+Qdy=Z`0(P_x+Q_y)ds(38)where`_'denotestiationwithrespect\ntos,and@Q\n@x\n@P\n@y\n=f(x;y\n).Forexample,Q(x;y\n)=12Rx0f(t;y\n)dtandP(x;y\n)=12Ry0f(x;t\n)dtwillsatisfytheabo\nverequirement.Thus,using(38),andletL(x;_x;y;\n_y)=Q(x;y\n)_x+P(x;y\n)_ywecanwrite(37)asE(s)]=Z`0L(x;_x;y;\n_y)ds;(39)ByEuler-Lagrangeequation,wegetthegradientofE(s)]withrespect\ntoanypoin\nt(x(s);y\n(s))2:E\nx\n=@L\n@x\ndds@L\n@_xE\ny\n=@L\n@y\ndds@L\n@_y(40)We@L\n@x\ndds@L\n@_x=(@Q\n@x\n@P\n@y\n)_y=f(x;y\n)_y@L\n@y\ndds@L\n@_y=(@Q\n@x\n+@P\n@y\n)_\nx=f(x;y\n)_\nx(41)Since~n(x;y)=(_y;\n_x)isthenormalalongthecontourlet~v=(x;y\n),thuswehave:E\nv\n=f(x;y\n)~n(x;y)(42)Tocomputethefunctionalderivativeofanintegralalongtheboundary\ncontourweneedstartthederivationatEquation(39)bychoosing\nL=p_x2+_y2.Itisstraightfor-ward,forexample,tocheckthatthefunctionalderivativeofthelineintegralR@R\ndsis~n.12Green'sthereomisaspecial\ncaseofStokestheoremandshouldnotbe\nconfusedwithGreen'sidentities.See,forexample,[13].\n30"b'References[1]R.AdamsandL.Bischof.\\Seededregiongrowing".IEEETrans.onPAMI.vol.16.No.6.June1994.[2]J.R.Beveridgeetal.\\Segmentingimagesusinglocalizing\nhistogramsandregionmerging".Int.J.ofCompt.vision.vol.2.1989.[3]A.BlakeandA.Zisserman.VisualReconstruction.Cambridge,MA.MITpress,1987.[4]J.F.Canny.\\Acomputationalapproachtoedgedetection".IEEETrans.Patt.Anal.Mach.Intell.\n.PAMI-8(6):679-698.1986.[5]A.Chakrabort\ny,L.H.StraibandJ.S.Duncan.\\DeformableBoundaryFindingbyRegionHomogeneity".CVPR.Seattle.1994.[6]L.D.CohenandI.Cohen.\\Aelementmethod\nappliedtonewactivecontourmodels\nand3Dreconstructionfromcrosssections".Proc.ThirdInt.Conf.onComputerVisionICCV90.Osaka,Japan.1990.[7]L.D.Cohen.\\OnActiveContourModels\nandBalloons".\nCVGIP:ImageUnderstanding.vol.53,No.2,March,pp211-218.1991.[8]K.Fukunaga.StatisticalPatternRecognition.AcademicPress.SanDiego,CA.1990.[9]D.GeigerandA.L.Yuille."Acommonframeworkforimagesegmentation".Inter.J.ofCom-puterVision6(3),pp227-2431991.[10]S.GemanandD.Geman.\\Stoc\nhasticrelaxation,GibbsdistributionsandtheBayesianrestorationofimages".IEETrans.PAMI6.pp721-741.1984.[11]D.Geman,S.GemanandP.Dong.\\BoundaryDetectionbyConstrainedOptimization".IEEEPAMI12(7)pp609-6281990.[12]M.Grayson,\\TheHeatEquationShrinkingConvexPlaneCurves",JournalofentialGeomerty.vol.23pp285-3141987.[13]M.D.Greenberg.\nFoundationsofAppliedMathematics.Prentice-Hall,NewJersey.1978.[14]R.J.Hathaway,\\AnotherInterpretationfortheEMAlgorithmforMixtureDistributions".Stat.Prob.Lett.4,pp53-56.1986.[15]G.Healey."SegmentingImagesUsingNormalizedColor".IEEETrans.onSystems,Man,andCybernetics,Vol.22,No.1.1992.[16]T.H.HongandA.Rosenfeld.\\CompactRegionExtractionUsingWeightedPixelLinkinginaPyramid".IEEETrans.Patt.Anal.andMach.Intell.\nPAMI-6,No.2.March.pp222-229.1984.[17]R.JohnsonandD.Wichem.AppliedMultivariateStatsiticalAnalysis.Prentice-Hall,Inc.Eaglewood\nNewJersey.1982.[18]T.Kanungo,B.Dom,W.NiblackandD.Steele.\\AfastalgorithmforMDL-basedmulti-bandimagesegmentation".Proc.Comp.VisionandPatt.RecognitionCVPR1994.[19]M.Kass,A.WitkinandD.Terzopoulos.\n\\Snakes:ActiveContourModels".\nProc.Int.Conf.onComputerVisionICCV87.London,England.1987.31'b'[20]K.Keeler.\\MapRepresentationsandCoding-Based\nPriorsforSegmentation".Proc.CVPR.Maui.1991.[21]G.J.Klinker,S.A.ShaferandT.Kanade.\\APhysicalApproachtoColorImageUnderstand-ing".InternationalJournalofComputerVision,4,pp7-38.1990.[22]G.Ko\nC.Lopez\nandJ.M.Morel.\\AMultiscaleAlgorithmforImageSegmentationbyVariationalApproach".SIAMJ.NUMER.ANAL.Vol.31,No.1,pp282-299.February,1994.[23]Y.G.Leclerc.\\ConstructingSimpleStableDescriptionsforImagePartitioning".Interna-tionalJournalofComputerVision,3,pp73-102.1989.[24]Y.G.Leclerc\\RegiongrowingusingtheMDLprinciple".inDARPAimageunderstandingworkshop,1990.[25]H.C.Lee,E.J.Breneman,andC.P.Schulte."Modeling\nlightforcolorcomputervision."IEEETrans.PAMI,PAMI-12(4),pp402-409.1990.[26]A.Leonardis,A.GuptaandR.Bajcsy\n.\\SegmentationofRangeImagesastheSearchforGeometricParametricModels".\nInternationalJournalofComputerVision,Vol.14,No.3,pp253-277.1995.[27]J.M.MorelandS.Solimini.VariationalMethodsinImageSegmentation.Birkhauserpublish-ing.inc.1995.[28]D.MumfordandJ.Shah.\\OptimalApproximationsbyPiecewiseSmooth\nFunctionsandAssociated\nVariationalProblems."Comm.PureAppl.Math.,42,pp577-684.1989.[29]A.P.Pentland.\\AutomaticExtractionofDeformablePartModels".\nInternationalJournalofComputerVision,4,pp107-126.1990.[30]J.Rissanen.\\Modelling\nbyshortestdatadescription"Automatica.14:465-471.1978.[31]J.Rissanen.StochasticComplexityinStatisticalInquiry,WorldScienSingapore,\n1989.[32]R.Ronfard.\\Region-basedstrategiesforactivecontourmodels".\nInt.J.ofcomp.Vision.vol.13.no.2.1994.[33].T-YPhilips,A.RosenfeldandA.C.Sher.\\O(logn)Bimodalit\nyAnalysis".PatternRecog-nition22,pp741-746.1989.[34]K-KSung.\\AVectorSignalProcessing\nApproachtoColor".MITIntelligenceLAboratory\n.TechnicalReport\n1349.1992.[35]Y.Wang,\\ExistenceandRegularityofSolutionstoaVariationalProblemofMumfordandShah",SIAMJ.ofOptimization,1991[36]R.WilsonandG.Granlund.\\Theuncertaintyprincipleinimageprocessing".\nIEEE.trans.onPAMIvol.6,No.6,Nov.1984.[37]G.Xu,E.SegawaandS.Tsuji.\\RobustActiveContourswithInsensitiveParameters".PatternRecognition.Vol.27,No.7,pp879-884.1994.[38]S.C.ZhuandA.L.Yuille.\\FORMS:aFlexibleObject\nRecognitionandModelling\nSystem".InternationalJournalofComputerVision,1996.InPress.32'b'[39]S.C.Zhu,Y.WuandD.B.Mumford.\\FRAME(Filters,RandomFields,andMaximumEntropy):Towardsatheoryfortexturemodelling".\nProc.Int.Conf.onComputerVisionandPatternRecognition,SanFrancisco,June,1996.[40]S.C.ZhuandD.B.Mumford.\\Learningandsamplingthepriordistributionforvisualcomputation".HarvardRobotics\nLaboratory\nTechnicalReport\n95-3.1995.[41]S.C.ZhuandA.L.Yuille."ATheoryforImageSegmenation:RegionCompetition\nanditsAnalysis".HarvardRobotics\nLaboratory\nTechnicalReport\n95-7.1995.33'