b'Internal\nReport\n96{08Face\nRecognitionby\nElasticBunch\nGraphMatching\nbyLaurenzWiskott,\nJean-MarcFellous,\nNorbert\nKruger,\nandChristophvon\nderMalsburgRuhr-Univat\nBochum\nInstitutfur\nNeuroinformatik44780Bochum\nIR-INI96{08April1996ISSN0943-2752c1996Institutfur\nNeuroinformatik,Ruhr-Univat\nBochum,\nFRG\n'b'Thiswork\nhasbeen\nsubmittedtotheIEEEforpossible\npublication.Copyright\nmay\nbe\ntransferredwithoutnotice,afterwhich\nthisversion\nwillbe\nsuperseded.\nFace\nRecognitionby\nElasticBunch\nGraphMatching\nLaurenzWiskott\n1y,Jean-MarcFellous\n2z,Norbert\nKruger\n1,andChristophvon\nderMalsburg1;21Institutfur\nNeuroinformatikRuhr-Univat\nBochum\nD-44780Bochum,\nGermany\nhttp://www.neuroinformatik.ruhr-uni-bochum.de\n2ComputerScienceDepartment\nUniversity\nofSouthernCaliforniaLosAngeles,CA90089,USAApril18,1996AbstractWe\npresent\nasystemforrecognizinghuman\nfacesfromsingleimagesoutofalargedatabasewithoneimageper\nperson.\nThetaskisbecause\nofimagevariance\nintermsofposition,\nsize,expressionandpose.\nThesystemcollapsesmostofthisvariance\nby\nextractingconcisefacedescriptionsintheformofimagegraphs\n.Inthese,points\nontheface(eyes,\nmouthetc.)aredescribed\nby\nsetsofwavelet\ncomponents\n(jets).Imagegraphextractionisbasedonanovel\napproach,\nthebunchgraph\n,which\nisconstructedfromasmallsetofsampleimagegraphs.Recognitionisbasedonastraight-\nforward\ncomparisonofimagegraphs.We\nreport\nhereonrecognitionexperiments\nwithgalleriesof250imagesfromtheFERETdatabase,alsoacrosst\nposes.\nKeywords:\nfacerecognition,t\nposes,\nGabor\nwavelets,\nelasticgraphmatching,\nbunch\ngraph,ARPA/ARL\nFERETdatabase.Supported\nby\ngrants\nfromtheGermanFederal\nMinistryforScienceandTechnology\n(413-5839-01IN101B9)andfromARPA\nandtheU.S.Army\nResearch\nLab(01/93/K-109).yCurrent\naddress:ComputationalNeurobiologyLaboratory,\nTheSalkInstituteforBiologicalStudies,SanDiego,CA92186-5800,http://www.cnl.salk.edu/CNL,\nwiskott@salk.edu.\nzCurrent\naddress:Volen\nCenter\nforComplexSystems,BrandeisUniversity,\nWaltham,\nMA02254-9110.1'b'IR-INI96{08,c1996Institutfur\nNeuroinformatik,Ruhr-Univat\nBochum,\nFRG\n21Introduction\nWe\nsetourselves\nthetaskofrecognizingpersons\nfromsingleimagesby\nreferencetoagallery,\nwhich\nalsocontained\nonlyoneimageper\nperson.\nOurproblemwas\ntoaddressimagevariation\nduetoinheadpose,\nposition,\nandsizeandduetochanging\nfacialexpression(tonameonlythemostimportant).\nOurtaskisthus\natypical\ndiscrimination-in-the-presence-of-variance\nproblem,whereonehastotrytocollapsethevariance\nandtoemphasizedis-criminatingfeatures.Thisisingeneralonlypossible\nwiththehelpofinformationabout\nthestructureofvariations\ntobe\nexpected.\nsystemsvastly\nintermsofnatureandoriginoftheirknowledge\nabout\nimagevariations.\nSystemsinIntelligence\nandComputerVisionoftenstresssp\ndesigner-provided\nstructures,forinstanceexplicitmodels\nofthree-dimensionalobjects\noroftheimage-generationprocess,\nwhereasNeuralNetwork\nmodels\ntendtostressabsorptionofstructurefromexampleswiththehelpofstatisticalestimationtechniques.\nBothoftheseextremesareexpensive\nintheirown\nway\nandfallpainfullyshortoftheeasewithwhich\nnaturalsystemspick\nupessential\ninformationfromjustafewexamples.Part\nofthesuccessofnaturalsystemsmust\nbe\nduetogeneralproperties\nandlaws\nastohow\nobject\nimagestransformundernaturalconditions.Oursystemhasanimportant\ncoreofstructurewhich\nreferstoimagesingeneralandtothefactthattheimagesofcoherent\nobjects\ntendtotranslate,scale,rotateanddeformelasticallyintheimageplane.Ourbasicobject\nrepresentation\nisthelabeled\ngraph;edgesarelabeled\nwithdistanceinformationandnodes\narelabeled\nwithwavelet\nresponses\nlocally\nbundledinjets.Storedmodel\ngraphs\ncanbe\nmatched\ntonewimagestogenerateimagegraphs\n,which\ncanthenbe\nincorporated\ninto\nagalleryandbecome\nmodel\ngraphs.Wavelets\naswe\nusethemarerobusttomoderate\nlighting\nchanges\nandsmallshiftsanddeformations.Model\ngraphscaneasilybe\ntranslated,scaled,oriented\nordeformedduringthematching\nprocess,\nthus\ncompensating\nforalargepartofthevariance\noftheimages.Unfortunately,\nhaving\nonlyoneimageforeach\nperson\ninthegalleriesdoes\nnotprovide\nt\ninformationtohandlerotationindepthanalogously.\nThough,we\npresent\nresultsonrecognitionacrosst\nposes.\nThisgeneralstructureisusefulforhandlingany\nkindofcoherent\nobject\nandmay\nbe\nsuf-t\nfordiscriminatingbetween\nstructurallyt\nobject\ntypes.\nHowever,\nforin-classdiscriminationofobjects,\nofwhich\nfacerecognitionisanexample,itisnecessarytohave\ninformationsp\ntothestructurecommontoallobjects\nintheclass.Thisiscrucialfortheextractionofthosestructuraltraitsfromtheimagewhich\nareimportant\nfordiscrimina-tion(\\toknow\nwheretolook\nandwhattopay\nattention\nto").Inoursystem,class-sp\ninformationhastheformofbunchgraphs\n,oneforeach\npose,\nwhich\narestacks\nofamoder-\natenumber\n(70inourexperiments)\noft\nfaces,jet-sampledinanappropriatesetofpoints\n(placedover\neyes,\nmouth,contour\netc.).Bunch\ngraphsaretreatedascom-binatorialentities\ninthatfort\npoints\njetsfromt\nsamplefacescanbe\nselected,thus\ncreatingahighlyadaptablemodel.\nThismodel\nismatched\ntonewfacialimagesinordertoreliablythepoints\nintheimage.Jetsatthesepoints\nandtheirrelative\npositions\nareextractedandarecombined\ninto\nanimagegraph,arepresentation\nofthefacewhich\nhasnoremainingvariation\nduetosize,position\n(orin-planeorientation,\nnotimplemented\nhere).'b'IR-INI96{08,c1996Institutfur\nNeuroinformatik,Ruhr-Univat\nBochum,\nFRG\n3Abunch\ngraphiscreatedintwo\nstages.Itsqualitative\nstructureasagraph(asetofnodes\nplusedges)aswell\nastheassignment\nofcorresponding\nlabels\n(jetsanddistances)foroneinitialimageisdesigner-provided,\nwhereasthebulkofthebunch\ngraphisextractedsemi-automaticallyfromsampleimagesby\nmatching\ntheembryonic\nbunch\ngraphtothem,lessandlessoftenintervening\ntocorrectincorrectlyiden\npoints.\nImagegraphsareratherrobusttosmallin-depthrotationsofthehead.Largerrotationangles,i.e.t\nposes,\narehandledwiththehelpofbunch\ngraphswitht\ngraphstructureanddesigner-provided\ncorrespondences\nbetween\nnodes\nint\nposes.\nAfterthesepreparationsoursystemcanextractfromsingleimagesconciseinvariant\nfacedescriptionsintheformofimagegraphs(calledmodel\ngraphswheninagallery).Theycontain\nallinformationrelevant\nforthefacediscriminationtask.For\nthepurpose\nofrecognition,imagegraphscanbe\ncomparedwithmodel\ngraphsatsmallcomputingcostby\nevaluating\nthemeanjetsimilarity.\nInsummary,\noursystemisbasedtoamaximum\nonageneraldatastructure|graphslabeled\nwithwavelet\nresponses\n|andgeneraltransformationproperties.\nThesearedesigner-provided,\nbutduetotheirgenerality\nandsimplicity\nthenecessaryisminimal.At\nthepresent\nstageofdevelopment\noursystemmakes\nuseofhand-craftedobject-sp\ngraphstructuresandamoderately\nlabor-intensive\nprocedure\ntogeneratebunch-graphs.\nWe\nplantoeliminatethisneedforhuman\nintervention\nandguess-work\nwiththehelpofstatisticalestimationmethods.\nOursystemcomesclosetothenaturalmodel\nby\nneedingonlyasmallnumber\nofexamplesinordertohandlethecomplextaskoffacerecognition.We\nwillcompareoursystemtoothersandtoourown\npreviouswork\ninthediscussion.2TheSystem2.1Preprocessing\nwithGabor\nWavelets\nTherepresentation\noflocal\nfeaturesisbasedontheGabor\nwavelet\ntransform(seeFigure1).Gabor\nwavelets\narebiologicallymotivated\nconvolution\nkernels\nintheshape\nofplanewaves\nrestrictedby\naGaussianenvelope\nfunction(Daugman\n1988).Thesetofconvolution\nco\ncients\nforkernels\noft\norientations\nandfrequenciesatoneimagepixeliscalledajet.Inthissectionwe\njets,t\nsimilarity\nfunctionsbetween\njets,andourprocedure\nforpreciselocalization\nofjetsinanimage.2.1.1JetsAjetdescribes\nasmallpatch\nofgreyvalues\ninanimageI(~x\n)aroundagiven\npixel~x\n=(x;y).Itisbasedonawavelet\ntransform,asaconvolution\nJj(~x\n)=ZI(~x\n0) j(~x\n~x\n0)d2~x\n0(1)withafamilyofGabor\nkernels j(~x\n)=k2j2exp k2jx222!"exp(\ni~kj~x\n)exp 22!#(2)'b"IR-INI96{08,c1996Institutfur\nNeuroinformatik,Ruhr-Univat\nBochum,\nFRG\n4intheshape\nofplanewaves\nwithwave\nvector\n~kj,restrictedby\naGaussianenvelope\nfunction.We\nemploy\nadiscretesetof5t\nfrequencies,index=0;:::;4,and8orientations,\nindex=0;:::;7,~kj= kjx\nkjy\n!= kcos'ksin'!;k=2+22;\n'=8;(3)withindexj=+8.Thissamplingevenly\ncovers\nabandinfrequencyspace.Thewidth=k\noftheGaussianiscontrolled\nby\ntheparameter=2.Thesecondterminthebracket\nof(2)makes\nthekernels\nDC-free\n,i.e.theintegral\nR j(~x\n)d2~x\nvanishes.\nOnespeaks\nofawavelet\ntransformsincethefamilyofkernels\nisself-similar,allkernels\nbeing\ngeneratedfromonemotherwaveletby\ndilationandrotation.Gabor waveletsjetoriginal imageconvolution resultmagnitudeimaginary partimage graphFigure1:Thegraphrepresentation\nofafaceisbasedontheGabor\nwavelet\ntransform,asetofconvolutions\nwithkernels\nintheshape\nofwavelets.\nThesehave\ntheshape\nofplanewaves\nrestrictedby\naGaussianenvelope\nfunction.We\ncompute40cots\n(5frequencies8orientations).\nCot\nphasevaries\nwithwavelet\nfrequency(seeimaginarypart),magnitudevaries\nslowly.\nThesetof40cots\nobtainedforoneimagepoint\nisreferredtoasajet.Asparsecollectionofsuch\njetstogetherwithsomeinformationabout\ntheirrelative\nlocation\nconstitutesanimagegraph,usedtorepresent\nanobject,\nsuch\nasaface.AjetJisasthesetfJjgof40complexcots\nobtainedforoneimagepoint.\nItcanbe\nwrittenasJj=ajexp(\nij)(4)withamplitudesaj(~x\n),which\nslowly\nvary\nwithposition,\nandphasesj(~x\n),which\nrotatewitharatesetby\nthespatialfrequencyorwave\nvector\n~kjofthekernels\n(seeFigure1).Gabor\nwavelets\nwere\nchosen\nfortheirrobustnessasadataformatandfortheirbiolog-icalrelevance.\nSincetheyareDC-free,theyprovide\nrobustnessagainstvarying\nbrightness\nintheimage.Robustnessagainstvarying\ncontrast\ncanbe\nobtainedby\nnormalizingthejets.Thelimitedlocalization\ninspaceandfrequencyyieldsacertainamount\nofrobustnessagainsttranslation,distortion,rotation,andscaling.Onlythephasechanges\ndrasticallywithtranslation.Thisphasevariation\ncanbe\neitherignored,oritcanbe\nusedforestimating"b'IR-INI96{08,c1996Institutfur\nNeuroinformatik,Ruhr-Univat\nBochum,\nFRG\n5displacement,\naswillbe\nshown\nlater.Adisadvantage\nofthelargekernels\nistheirsensitivity\ntobackground\nvariations.\nItwas\nshown,\nhowever,\nthatiftheobject\ncontour\nisknown\ntheofthebackground\ncanbe\nsuppressed(Potzsch1994).Finally,\ntheGabor\nwavelets\nhave\nsimilarshape\nasthereceptive\nofsimplecellsfoundinthevisualcortexofverte-\nbrateanimals(Pollen&Ronner\n1981;Jones&Palmer\n1987;DeValois\n&DeValois\n1988).2.1.2ComparingJetsDuetophaserotation,jetstaken\nfromimagepoints\nonlyafewpixelsfromeach\notherhave\nvery\nt\ncots,\nalthoughrepresenting\nalmostthesamelocal\nfeature.Thiscancausesevere\nproblemsformatching.\nWe\nthereforeeitherignorethephaseorcompensate\nforitsvariation\nexplicitly.\nThesimilarity\nfunctionSa(J;J0)=Pjaja0jrPja2jPja02j;(5)alreadyusedby\nBuhmannetal.(1992)andLadesetal.(1993),ignoresthephasecom-pletely.\nWithajetJtaken\nataimageposition\nandjetsJ0=J0(~x\n)taken\natvariable\nposition\n~x\n,Sa(J;J0(~x\n))isasmooth\nfunctionwithlocal\noptimaforminglargeattractorbasins(seeFigure2a),leadingtorapidandreliableconvergence\nwithsimplesearch\nmethods\nsuch\nasgradient\ndescent\nor-1-0.500.51-40-2002040horizontal displacement [pixels]similarity without phase (a)similarity with phase (b)estimated displacement / 8 (c)Figure2:a)Similarity\nSa(J(~x\n1);J0(~x\n0))withjetJ0taken\nfromthelefteye\nofthefaceshown\ninFigure1,andjetJtaken\nfrompixelpositions\nofthesamehorizon-talline,~x\n1=~x\n0+(dx;0);dx=50;:::;50(TheimageinFigure1hasawidthof128pixels).Thesimilarity\npotential\nissmooth\nandhasalargeattractorbasin.b)Similarity\nS(J(~x\n1);J0(~x\n0))andc)es-timateddisplacement\n~d(J(~x\n1);J0(~x\n0))forthesamejetsasina(usingfocus\n1).Thesimilarity\npotential\nhasmany\nmorelocal\noptima.Theright\neye\nis24pixelsaway\nfromthelefteye,\ngeneratingalocal\nmaxi-mum\nforboth\nsimilarity\nfunctionsclosetodx=24.Theestimateddisplacement\nisprecisearoundthe0-position\nandrougheratotherlocal\noptima,especially\nattheothereye.\n(Thedisplacement\nvalues\naredividedby\n8totheordinaterange.)'b'IR-INI96{08,c1996Institutfur\nNeuroinformatik,Ruhr-Univat\nBochum,\nFRG\n6Usingphasehastwo\npotential\nadvantages.\nFirstly,\nphaseinformationisrequiredtodiscriminatebetween\npatternswithsimilaramplitudes,shouldtheyoccur,\nandsecondly,\nsincephasevaries\nsoquickly\nwithlocation,\nitprovides\nameansforaccuratejetlocalization\ninanimage.Assumingthattwo\njetsJandJ0refertoobject\nlocations\nwithsmallrelative\ndisplacement\n~d,thephaseshiftscanapproximately\nbe\ncompensated\nforby\ntheterms~d~kj,leadingtoaphase-sensitive\nsimilarity\nfunctionS(J;J0)=Pjaja0jcos(\nj0j~d~kj)rPja2jPja02j:(6)Inordertocomputeit,thedisplacement\n~dhastobe\nestimated.Thiscanbe\ndoneby\nmaximizingSinitsTaylor\nexpansion,asexplainedinthefollowing\nsection.Itisactuallyagreatadvantage\nofthissecondsimilarity\nfunctionthatityieldsthisdisplacement\ninformation.ofsimilaritiesandestimateddisplacements\nareshown\ninFigure2.2.1.3Displacement\nEstimationInordertoestimatethedisplacement\nvector\n~d=(dx;dy),we\nhave\nadoptedamethod\nusedfordisparity\nestimation(Theimer&Mallot1994)basedon(Fleet&Jepson1990).Theideaistomaximizethesimilarity\nSinitsTaylor\nexpansion:S(J;J0)Pjaja0j[10:5(j0j~d~kj)2]rPja2jPja02j:(7)Setting@@d\nxS=@@d\nyS=0andsolvingfor~dleadsto~d(J;J0)= dxdy!=1xxyy\nxyyx\n yy\nyx\nxyxx! xy!;(8)ifxxyy\nxyyx\n6=0,withx=Xjaja0jkjx\n(j0j);xy=Xjaja0jkjx\nkjy\n;andy;xx;yx\n;yy\ncorrespondingly.\nThisequationyieldsastraightforward\nmethod\nforestimatingthedisplacement\nordispar-ity\nbetween\ntwo\njetstaken\nfromobject\nlocations\ncloseenoughthattheirGabor\nkernels\narehighlyoverlapping.\nWithoutfurthermo\nthisequationcandeterminedisplace-ments\nuptohalfthewavelength\nofthehighestfrequencykernel,\nwhich\nwould\nbe\ntwo\npixelsfork0==\n2.Therangecanbe\nincreasedby\nusinglow\nfrequencykernels\nonly.\nFor\nthelargestkernels\ntheestimateddisplacement\nmay\nbe\n8pixels.Onecanthenproceed\nwiththenexthigherfrequencylevel\nandtheresult,possibly\nby\ncorrectingthephasesofthehigherfrequencycots\nby\nmultiples\nof2accordingtothedisplacement\nestimated'b'IR-INI96{08,c1996Institutfur\nNeuroinformatik,Ruhr-Univat\nBochum,\nFRG\n7onthelower\nfrequencylevel.\nWe\nrefertothenumber\noffrequencylevels\nusedforthedisplacement\nestimationasfocus\n.Afocus\nof1indicatesthatonlythelowest\nfrequencylevel\nisusedandthattheestimateddisplacement\nmay\nbe\nupto8pixels.Afocus\nof5indicatesthatalle\nlevels\nareused,andthedisparity\nmay\nonlybe\nupto2pixels.Inany\ncase,alle\nlevels\nareeventually\nusedintheiterative\nt\nprocess\ndescribed\nabove.\nIfonehasaccesstothewholeimageofjets,onecanalsowork\niteratively.\nAssumeajetJistobe\naccuratelypositioned\nintheneighborhood\nofpoint\n~x\n0inanimage.ComparingJwiththejetJ0=J(~x\n0)yieldsanestimateddisplacement\nof~d0=~d(J;J(~x\n0)).ThenajetJ1istaken\nfromposition\n~x\n1=~x\n0+~d0andthedisplacement\nisestimatedagain.Butsincethenewlocation\nisclosertothecorrectposition,\nthenewdisplacement\n~d1willbe\nsmallerandcanbe\nestimatedmoreaccuratelywithahigherfocus,\nconverging\neventually\ntosubpixelaccuracy.\nWe\nhave\nusedthisiterative\nscheme\ninthematching\nprocess\ndescribed\ninSection2.3.2.2Face\nRepresentation\n2.2.1IndividualFaces\nFor\nfaces,we\nhave\nasetofpoints\n,e.g.thepupils,thecornersofthemouth,thetipofthenose,thetopandbottom\noftheears,etc.Alabeled\ngraph\nGrepresenting\nafaceconsistsofNnodes\nonthesepoints\natpositions\n~x\nn;n=1;:::;NandEedgesbetween\nthem.Thenodes\narelabeled\nwithjetsJn.Theedgesarelabeled\nwithdistances~x\ne=~x\nn~x\nn0;e=1;:::;E,whereedgeeconnectsnode\nn0withn.Hencetheedgelabels\naretwo-dimensional\nvectors.\n(Whenwanting\ntorefertothegeometricalstructureofagraph,unlabeled\nby\njets,we\ncallitagrid.)Thisfacegraphisobject-adapted\n,sincethenodes\nareselectedfromface-sp\npoints\npoints,\nseeFigure4).Graphsfort\nheadpose\ningeometryandlocal\nfeatures.Althoughthepoints\nrefertocorresponding\nobject\nlocations,\nsomemay\nbe\noccluded,\nandjetsaswell\nasdistancesvary\nduetorotationindepth.To\nbe\nabletocomparegraphsfort\nposes,\nwe\nmanually\npointers\ntoassociate\ncorresponding\nnodes\ninthet\ngraphs.2.2.2Face\nBunch\nGraphsInordertopoints\ninnewfaces,oneneedsageneralrepresentation\nratherthanmodels\nofindividualfaces.Thisrepresentation\nshouldcover\nawiderangeofpossible\nvaria-\ntionsintheappearance\noffaces,such\nastly\nshaped\neyes,\nmouths,ornoses,t\ntypes\nofbeards,\nvariations\nduetogender,ageandrace,etc.Itisobvious\nthatitwould\nbe\ntoo\nexpensive\ntocover\neach\nfeaturecombination\nby\naseparategraph.We\ninsteadcombine\narepresentative\nsetofindividualmodel\ngraphsinto\nastack-like\nstructure,calledaface\nbunchgraph\n(FBG)(seeFigure3).Each\nmodel\nhasthesamegridstructureandthenodes\nrefertoidentical\npoints.\nAsetofjetsreferringtoonepoint\niscalledabunch.Aneye\nbunch,\nforinstance,may\nincludejetsfromclosed,open,\nfemale,andmaleeyes\netc.tocover\ntheselocal\nvariations.\nDuringthelocation\nofpoints\ninafacenotseenbefore,\ntheprocedure\ndescribed\ninthenextsectionselectsthebest\njet,calledthelocal\nexpert\n,fromthebunch\ndedicatedtoeach\npoint.\nThus,\nthefullcombinatorics\nofjetsinthe'b'IR-INI96{08,c1996Institutfur\nNeuroinformatik,Ruhr-Univat\nBochum,\nFRG\n8bunch\ngraphisavailable,\ncovering\namuch\nlargerrangeoffacialvariation\nthanrepresented\nintheconstitutingmodel\ngraphsthemselves.\nAssumeforaparticularpose\nthereareMmodel\ngraphsGBm(m=1;:::;M)ofidentical\nstructure,taken\nfromt\nmodel\nfaces.Thecorresponding\nFBGBthenisgiven\nthesamestructure,itsnodes\narelabeled\nwithbunches\nofjetsJBmnanditsedgesarelabeled\nwiththeaveraged\ndistances~x\nBe=Pm~x\nBme=M\n.face bunch graphFigure3:TheFace\nBunch\nGraph(FBG)serves\nasarepresentation\noffacesingeneral.Itisdesignedtocover\nallpossible\nvariations\nintheappearance\noffaces.TheFBGcombines\ninformationfromanumber\noffacegraphs.Itsnodes\narelabeled\nwithsetsofjets,calledbunches,\nanditsedgesarelabeled\nwithaverages\nofdistancevectors.\nDuringcomparisontoanimagethebest\njetineach\nbunch\nisselectedindependently,\nindicatedby\ngreyshading.2.3GeneratingFace\nRepresentations\nby\nElasticBunch\nGraphMatching\nSofarwe\nhave\nonlydescribed\nhow\nindividualfacesandgeneralknowledge\nabout\nfacesarerepresented\nby\nlabeled\ngraphsandtheFBG,respectively.\nWe\narenow\ngoingtoexplainhow\nthesegraphsaregenerated.Thesimplestmethod\nistodosomanually,\nby\nmarkingasetofpoints\nforagiven\nimageandlettingedgelabels\nbe\ncomputedasthebetween\nnode\npositions.\nFinallytheGabor\nwavelet\ntransformprovides\nthejetsforthenodes.\nWe\nhave\nusedthismanual\nmethod\ntogenerateinitialgraphsforthesystem,oneforeach\npose,\ntogetherwithpointers\ntoindicatewhich\npairsofnodes\ningraphsfort\nposes\ncorrespond\ntoeach\nother.IfthesystemhasaFBG(possibly\nconsistingofonemodel\nonly),graphsfornewimagescanautomaticallybe\ngeneratedby\nElasticBunch\nGraphMatching.\nInitially,\nwhentheFBGcontains\nonlyfewfaces,itisnecessarytoreviewandcorrecttheresultingmatches,\nbutoncetheFBGisrich\nenough(approximately\n70graphs)onecanrelyonthematching\nandgeneratelargegalleriesofmodel\ngraphsautomatically.\n'b'IR-INI96{08,c1996Institutfur\nNeuroinformatik,Ruhr-Univat\nBochum,\nFRG\n92.3.1TheGraphSimilarity\nFunction\nAkey\nroleinElasticBunch\nGraphMatching\n(EBGM)isplayed\nby\nafunctionevaluating\nthegraph\nsimilaritybetween\nanimagegraphandtheFBGofidentical\npose.\nItdepends\nonthejetsimilaritiesandthedistortionoftheimagegridrelative\ntotheFBGgrid.For\nanimagegraphGIwithnodes\nn=1;:::;Nandedgese=1;:::;EandaFBGBwithmodel\ngraphsm=1;:::;Mthesimilarity\nisasSB(GI;B)=1NXnmaxmS(JIn;JBmn)EXe~x\nIe~x\nBe)2~x\nBe)2;(9)wheredeterminestherelative\nimportance\nofjetsandmetricstructure.Jnarethejetsatnode\nnand~x\nearethedistancevectors\nusedaslabels\natedgese.SincetheFBGprovides\nseveral\njetsforeach\npoint,\nthebest\noneisselectedandusedforcomparison.Thesebest\njetsserve\naslocal\nexperts\nfortheimageface.2.3.2Matching\nProcedure\nThegoalofEBGMonaprobe\nimageistothepoints\nandthus\ntoextractfromtheimageagraphthatmaximizesthesimilarity\nwiththeFBG.Inpractice,onehastoapplyaheuristicalgorithmtocomeclosetotheoptimum\nwithinreasonabletime.We\nuseacoarsetoapproach.\nThematching\nschedule\ndescribed\nhereassumesnormalizedfaceimagesofknown\npose\nsuch\nthatonlyoneFBGisrequired.Themoregeneralcaseofvarying\nsizeissketched\ninthenextsection.Stage1Findapproximate\nfaceposition:\nCondensetheFGB\ninto\nanaverage\ngraph\nby\ntakingtheaverage\namplitudeofthejetsineach\nbunch\noftheFBG(or,alternatively,\nselectonearbitrarygraphasarepresentative).\nUsethisasarigidmodel\n(=1)andevaluate\nitssimilarity\nateach\nlocation\nofasquarelatticewithaspacingof4pixels.At\nthisstagethesimilarity\nfunctionSawithoutphaseisusedinsteadofS.Repeat\nthescanningaroundthebest\nposition\nwithaspacingof1pixel.Thebest\nposition\nserves\nasstartingpoint\nforthenextstage.Stage2position\nandestimatesize:Now\ntheFBGisusedwithoutaveraging,\nvarying\nitinposition\nandsize.Check\nthefourt\npositions\n(3;3)pixelsdisplacedfromtheposition\nfoundinStage1,andateach\nposition\ncheck\ntwo\nt\nsizeswhich\nhave\nthesamecenter\nposition,\nafactorof1:18smallerorlargerthantheFBGaverage\nsize.Thisiswithoutonthemetricsimilarity,\nsincethevectors\n~x\nBearetransformedaccordingly.\nWe\nstillkeep\n=1.For\neach\noftheseeight\nvariations\nthebest\njetforeach\nnode\nisselectedanditsdisplacement\naccordingtoEquation8iscomputed.Thisisdonewithafocus\nof1,i.e.,thedisplacements\nmay\nbe\nofamagnitudeuptoeight\npixels.Thegridsarethenrescaledandrepositioned\ninordertominimizethesquaresumover\nthedisplacements.\nKeepthebest\noftheeight\nvariations\nasstartingpoint\nforthenextstage.Stage3sizeandaspect\nratio:Asimilarrelaxationprocess\nasdescribed\nforStage2isapplied,relaxing,however,\nthex-andy-dimensionsindependently.\nInaddition,thefocus\nisincreasedsuccessively\nfrom1to5.'b'IR-INI96{08,c1996Institutfur\nNeuroinformatik,Ruhr-Univat\nBochum,\nFRG\n10Stage4Local\ndistortion:Inapseudo-randomsequencetheposition\nofeach\nindividualimagenode\nisvaried\ninordertofurtherincreasethesimilarity\ntotheFBG.Now\nthemetricsimilarity\nistaken\ninto\naccount\nby\nsetting=2andusingthevectors\n~x\nBeasobtainedinStage3.Inthisstageonlythosepositions\nareconsideredforwhich\ntheestimateddisplacement\nvector\nissmall(d<1,seeEquation8).For\nthislocal\ndistortionthefocus\nagainincreasesfrom1to5.Theresultinggraphiscalledtheimagegraph\nandisstoredasarepresentation\nfortheindividualfaceoftheimage.Figure4:Object-adapted\ngridsfort\nposes.\nThenodes\narepositioned\nautomati-callyby\nelasticgraphmatching\nagainstthecorresponding\nfacebunch\ngraphs.Thetwo\ntopimagesshow\noriginalswithwidelyingsizeandgridsasusedforthenormaliza-tionstagewithmany\nnodes\nontheoutline.Theotherimagesarealreadyrescaledtonor-malsize.Theirgridshave\nmorenodes\nontheface,which\nismoreappropriateforrecogni-tion(ThegridsusedinSection3.2hadabout\n14additionalnodes\nwhich\narenotshown\nhereforsimplicity).\nOnecanseethatingeneralthematching\nthepoints\nquiteaccurately.\nButmismatches\noccurred\nforex-amplefortheleftfaceinthebottom\nrow.\nThechin\nwas\nnotfoundaccurately;theleftmostnode\nandthenode\nbelow\nitshouldbe\natthetopandthebottom\noftheearrespectively.\n2.3.3Schedule\nofGraphExtractionTo\nminimizecomputingandtooptimizereliability\nwe\nextractafacerepresentation\nintwo\nstages.Thestage,callednormalizationstageanddescribed\ningreaterdetailin(Krugeretal.1995),hasthepurpose\nofestimatingtheposition\nandsizeofthefacein'b'IR-INI96{08,c1996Institutfur\nNeuroinformatik,Ruhr-Univat\nBochum,\nFRG\n11theoriginalimage,sothattheimagecanbe\nscaledandcuttostandardsize.Thesecondstagetakes\nthisimageasinputandextractsapreciseimagegraphappropriateforfacerecognitionpurposes.\nThetwo\nstagesinemphasis.Theonehastodealwithgreateruncertainty\nastosizeandposition\noftheheadandhastooptimizethereliability\nwithwhich\nittheface,butthereisnoneedtopoints\nwithany\nprecisionorextractdataimportant\nforfacerecognition.Thesecondstagecanstartwithlittleuncertainty\nastoposition\nandsizeoftheheadbuthastoextractadetailedfacegraphwithhighprecision.Intheexperiments\ndescribed\nbelow,\noriginalimageshadaformatof256384pixels,andthefacesvaried\ninsizeby\nafactorofthree(seeFigure4).Theposes\nwere\ngiven\nandneedednottobe\ndetermined.ThenormalizationstageusedthreeFBGsofappropriatepose\nwhich\ninfacesize.We\nsomewhatarbitrarilypicked\napproximately\n30imagestoformeach\nFBG.Morecarefulselectionofimagestocover\nawiderrangeofvariations\ncanonlyimprove\nsystemperformance.\nThegridsusedintheconstructionoftheFBGsputlittleemphasis(i.e.,fewnodes)\nontheinterior\nofthefaceandhave\nfewer\nnodes\nthanthoseusedforthesecondstage,seeFigure4fortwo\nexamples.Thesmallernumber\nofnodes\nspeeds\ntheprocess\noffaceUsinganEBGMscheme\nsimilartotheonedescribed\ninSection2.3.2we\nmatch\neach\nofthethreeFBGstotheinputimage.We\nselectthegraphthatmatches\nbest,\ncutaframeofappropriatesizearounditfromtheimageandresizeitto128128pixels.Theposes\ncouldbe\ndeterminedanalogously(Krugeretal.1996),butheretheposes\nareassumedtobe\nknown.\nInourexperiments,\nnormalizationtook\napproximately\n20secondsonaSPARCstation\n10-512witha50MHzprocessor\nandiden\nfaceposition\nandscalecorrectlyinapproximately\n99%oftheimages.Thesecondstageusesthematching\nprocedure\nexactlyasdescribed\ninSection2.3.2,startingthematch\natstandardsizeandposition.\nThefacebunch\ngraphsusedinthisstagehave\nmorenodes,\nwhich\nwe\nhave\nplacedinpositions\nwhich\nwe\nbelieve\nareimportant\nforperson\niden\nemphasizingtheinterior\noftheface.Each\nofthethreeprincipalposes\n(frontal,\nandleft-facingposes\nareed\ntoright-facing\nposes)\nismatched\nwithat\ngridstructureandwithat\nFBG,formedby\nusing70arbitrarilychosen\nimages.Thisstagetook\napproximately\n10seconds.2.4RecognitionAfterhaving\nextractedmodel\ngraphsfromthegalleryimagesandimagegraphsfromtheprobe\nimages,recognitionispossible\nwithrelatively\nlittlecomputationalby\ncomparinganimagegraphtoallmodel\ngraphsandpicking\ntheonewiththehighestsimilarity\nvalue.\nThesimilarity\nfunctionwe\nusehereforcomparinggraphsisanaverage\nover\nthesimilaritiesbetween\npairsofcorresponding\njets.For\nimageandmodel\ngraphsreferringtot\npose,\nwe\ncomparejetsaccordingtothemanually\nprovided\ncorrespondences.\nIfGIistheimagegraph,GMthemodel\ngraph,andifnode\nnn0inthemodel\ngraphcorresponds\ntonode\nn0intheimagegraph,we\ngraph\nsimilarityas:SG(GI;GM)=1N0Xn0Sa(JIn0;JMnn0);(10)wherethesumrunsonlyover\ntheN0nodes\nintheimagegraphwithacorrespondent\ninthemodel\ngraph.We\nusethejetsimilarity\nfunctionwithoutphasehere.Itturnedoutto'b"IR-INI96{08,c1996Institutfur\nNeuroinformatik,Ruhr-Univat\nBochum,\nFRG\n12be\nmorediscriminative,\npossibly\nbecause\nitismorerobustwithrespect\ntochange\ninfacialexpressionandothervariations.\nWe\nhereignorethejetdistortionscreatedby\nrotationindepth,butwilltake\nupthesubject\ninalaterpaper.\nThisgraphsimilarity\ninducesarankingofthemodel\ngraphsrelative\ntoanimagegraph.Aperson\nisrecognizedcorrectlyifthecorrectmodel\nyieldsthehighestgraphsimilarity,\ni.e.,ifitisofrankone.Acriteriononhow\nreliablyaperson\nisrecognizedcaneasilybe\nderived\nfromthestatisticsoftheranking(seeLadesetal.1993).However,\nwe\nhave\nrestrictedourresultstorecognitionrates,which\nalreadygive\nagood\nimpressionofsystemperformance.\n3Experiments\n3.1DatabaseTheimagegallerieswe\nusedinourexperiments\naretaken\nfromtheARPA/ARL\nFERETdatabaseprovided\nby\ntheUSArmy\nResearch\nLaboratory.\nThatdatabaseexplicitlydistin-guishest\nposes,\nandimagesarelabeled\nwithpose\nidentity.\nTheseposes\nare:frontal,\nright\norleft(rotatedby\nabout\n40-70degrees),andright\norleft(seeFigure5forexamples).For\nmostfacestherearetwo\nfrontal\nviewswitht\nfacialexpression.Apartfromafewexceptionstherearenodisguises,variations\ninhairstyle\norinclothing.Thebackground\nisalways\nahomogeneouslight\norgrey,\nexceptforsmoothly\nvarying\nshadows.\nThesizeofthefacesvaries\nby\nabout\nafactorofthree(butisconstant\nforeach\nindividual,infor-mationwhich\nwe\ncouldhave\nusedtoimprove\nrecognitionrates,butdidn't).Theformatoftheoriginalimagesis256384pixels.Inquiriesabout\nthedatabaseshouldbe\ndirectedtoJonathonPhillips(e-mail:jphillip@nvl.army.milorjonathon@arl.mil).3.2ResultsWe\nusedvarious\nmodel\nandprobe\ngallerieswithfacesoft\npose.\nEach\ngallerycon-tained250faceswithjustoneimageper\nperson.\nWe\nreliedontheexplicitlylabeled\npose\nidentity\ninsteadofusingourown\npose\nrecognitioncapability.\nRecognitionresultsareshown\ninTable\n1.Thevery\nhighcorrectrecognitionrateforfrontal\nagainstfrontal\nimagesrow)\ninspiteofthevariation\ninfacialexpressionandtheslight\nvariations\ninpose\nshows\nthegreatpotential\nofoursystem.However,\nallimageswere\ntaken\ninsinglesessions,such\nthatlighting\nconditionsarevery\nsimilarfrompicturetopictureandhairstyle\nandclothingareidentical.\nFurther\nwork\nwillhave\ntoshow\nthedegreeofrobustnessagainstgreaterimagevariation.\nInitialexperiments\nareencouragingBeforecomparingleftagainstright\nposes\nwe\ned\nallright\npose\nimagesover.\nSincehuman\nheadsarebilaterallysymmetrictosomedegreeandsinceatleastourpresent\nsystemperforms\npoorly\nonrotationindepth(seebelow)\nwe\nproceeded\nundertheexpectation\nthatitwould\nbe\neasiertodealwithduetofacialasymmetrythanwithcausedby\nsubstantial\nheadrotation.Thisassumptionisborn\noutatleastby\nthehighrecognitionrateof84%forright\nagainstleft(thirdrow).\nThesharplyreduced"b'IR-INI96{08,c1996Institutfur\nNeuroinformatik,Ruhr-Univat\nBochum,\nFRG\n13(proles left and right)(frontal views aand b)(half proles left and right)fafbhlhrplprFigure5:SamplefacesfromtheARPA/ARL\nFERETdatabase:frontal\nviews,andPicturesforleft-facingposes\nareed\naroundavertical\naxis,andallimageshave\nbeen\nrescaledtostandardsizeby\nournormalizationstage(Section2.3.3).Noticethelargevariation\nintherotationangleofandthatsomefaceshave\nnovariation\ninfacialexpression.recognitionrateof57%(secondrow)\nwhencomparingleftandright\ncouldbe\nduetoinherent\nfacialasymmetry,\nbutthemorelikely\nreasonisthepoor\ncontrol\ninrotationangleinthedatabase|inspection\nofimagesshows\nthatright\nandleftrotationanglesby\nupto30degrees,cf.Figure5.Whencomparinghalfwitheitherfrontal\nviewsoranotherreductioninrecognitionrateisobserved\n(althougheven\nacorrectrecognitionrateof10%outofagalleryof250isstillhighabove\nchance\nlevel,\nwhich\nwould\nbe\n0.4%!).Theresultsareasymmetrical,performance\nbeing\nbetter\niffrontal\norimagesserve\nasmodel\ngallerythanifhalf-areused.Thisisduetothefactthatboth\nfrontal\nandposes\naremuch\nmorestandardizedthanforwhich\ntheanglevaries\nbetween\n40and70degrees.We\ninterpret\nthisasbeing\nduetothefactthatsimilarity\nismoresensitive\ntodepth-rotationthantointer-individual\nfaceThus,\nwhencomparingfrontal\nprobe\nimagestoagallery,\na40degreegalleryimageofawrongperson\nisoftenfavored\nover\nthecorrectgalleryimageifinthelattertheheadisrotatedby\nalargerangle.Alargenumber\nofsuch\nfalsepositives\ndegradesthecorrect-recognitionrateconsiderably.\n'b'IR-INI96{08,c1996Institutfur\nNeuroinformatik,Ruhr-Univat\nBochum,\nFRG\n14Model\nProbe\nFirstrankFirst10ranksgalleryimages#%#%250fa250fb2459824899250hr181hl1035714781250pr250pl2108423694249fa+1fb171hl+79hr441811144171hl+79hr249fa+1fb42179538170hl+80hr217pl+33pr2296727217pl+33pr170hl+80hr31128032Table\n1:Recognitionresultsforcross-runsbetween\nt\ngalleries(f:frontal\nviews;a,b:expressionaandb;h:halfp:l,r:leftandright).\nEach\ngallerycontained\nonlyoneimageper\nperson;\nthet\ncompositions\ninthefourbottom\nlinesareduetothefactthatnotforallpersons\nallposes\nwere\navailable.\nGiven\narenumbers\nonhow\noftenthecorrectmodel\nwas\niden\nasrankoneandhow\noftenitwas\namongthe10(4%).4DiscussionThesystemwe\ndescribe\nisgeneralandItisdesignedforanin-classrecognition\ntask,i.e.forrecognizingmembers\nofaknown\nclassofobjects.\nWe\nhave\nappliedittofacerecognitionbutthesystemisinnoway\nspecialized\ntofacesanditcanbe\ndirectlyappliedtootherin-classrecognitiontasks,such\nasrecognizingindividualsofagiven\nanimalspecies,\ngiven\nthesamelevel\nofstandardizationoftheimages.Incontrast\ntomany\nneuralnetwork\nsystems,noextensive\ntrainingfornewfacesornewobject\nclassesisrequired.Onlyamoderate\nnumber\noftypical\nexampleshave\ntobe\ninspected\ntobuildupabunch\ngraph,andindividualscanthenbe\nrecognizedafterstoringasingleimage.Theperformance\nishighonfacesofsamepose.\nRobustnessagainstrotationindepthuptoabout\n20degreeshasalreadybeen\ndemonstratedwithapreviousversion\nofthesys-tem(Ladesetal.1993).Theconstraint\nofworking\nwithsingleimagesdeprives\nthesystemfrominformationnecessaryforinvariance\ntorotationindepth.Thereforethesystemperfor-\nmanceinrecognizingpeople\ninunfamiliarposes\nistly\ndegraded.Itisknown\nfrompsychophysical\nexperiments\nthatalsohuman\nsubjects\nperform\npoorly\nonthistask.Bruce\netal.(1987)have\nshown\nthatreliability\nonjudgingwhethertwo\nunfamiliarfacesarethesamedegradestly\nwithdepthrotationangle.Intheabsenceofeasilydistinguishedfeaturessuch\nashairstyle,\nbeard\norglassesasimilarresultwas\nobtainedby\nKalocsaietal.(1994).4.1ComparisontoPreviousWork\nIncomparisontothesystem(Ladesetal.1993)onthebasisofwhich\nwe\nhave\ndeveloped\nthesystempresented\nherewe\nhave\nmadeseveral\nmajor\nmo\nWe\nnow\nutilizewavelet\nphaseinformationforrelatively\nprecisenode\nlocalizations,\nwhich\ncouldbe\nusedasanaddi-tionalrecognitioncue(thoughtopography\nisnotusedatallintherecognitionstepofthecurrent\nsystem)|previously,\nnode\nlocalization\nhadbeen\nratherimprecise.We\nhave\nintro-\n'b'IR-INI96{08,c1996Institutfur\nNeuroinformatik,Ruhr-Univat\nBochum,\nFRG\n15ducedthepotential\ntospecialize\nthesystemtosp\nobject\ntypes\nandtohandlet\nposes\nwiththehelpofobject-adapted\ngrids.Theseimprovements\nandtheintroduction\noftheFace\nBunch\nGraphmakes\nitpossible\ntoextractfromimagessparseandlargelyvariance-free\nstructuraldescriptionsintheformofimagegraphs,which\nreliablyrefertopoints\nontheobject.\nThisacceleratesrecognitionfromlargedatabasesconsiderablysinceforeach\nprobe\nimagedatavariance\nneedstobe\nsearched\nonlyonceinsteadofineach\nattemptedmatch\ntoagalleryimage,aswas\npreviouslynecessary.\nTheability\nofthenewsystemtorefertoob\npoints\nirrespective\nofpose\nrepresents\nanadvantage\ninitselfandisessential\nforsomeinteresting\ngraphoperations\n(cf.Section4.3).Thereisaconsiderableliteratureonfacerecognition,andmany\nt\ntechniques\nhave\nbeen\nappliedtothetask(seeSamal&Iyengar1992;Valentin\netal.1994forreviews).Many\nsystemsarebasedonuserface-sp\nfeatures.Yuille(1991),forex-ample,represents\neyes\nby\nacirclewithinanalmond-shape\nandanenergyfunctiontooptimizeatotalof9model\nparametersformatching\nittoanimage.Brunelli\n&Pog-gio(1993)similarlyemploy\nsp\nmodels\nforeyebrows,\nnose,mouth,etc.andderive\n35geometricalfeaturessuch\naseyebrow\nthickness,\nnosewidth,mouthwidth,andeleven\nradiidescribingthechin\nshape.\nThedrawback\nofthesesystemsisthatthefeaturesaswell\nastheprocedures\ntoextractthemmust\nbe\nandprogrammedby\ntheuserforeach\nobject\nclassagain,andthesystemhasnomeanstoadapttosamplesforwhich\nthefeaturesfail.For\nexample,theeye\nmodels\nmentioned\nabove\nmay\nfailforfaceswithsunglassesorhave\nproblemsiftheeyes\nareclosed,orchin\nradiicannotbe\nextractedifthefaceisbearded.\nInthesecasestheuserhastodesignnewfeaturesandnewalgorithmstoextractthem.Withthistype\nofapproach,\nthesystemcannever\nbe\nweaned\nfromdesignerintervention.\nOursys-tem,incontrast,\ncanbe\ntaught\nexceptionalcases,such\nassunglassesorbeards,\norentirely\nnewobject\nclasses,by\nthepresentation\nofexamplesandincorporation\ninto\nbunch\ngraphs.Thestillnecessarydesignerintervention\ntocraftappropriategridswillsoon\nbe\nreplacedby\nautomaticmethods,\nseebelow.\nAnapproach\ntofacerecognitionalsoavoiding\nuserfeaturesisbasedonPrincipalComponent\nAnalysis(PCA)(Sirovich\n&Kirby1987;Kirby&Sirovich\n1990;Turk&Pentland1991;O\'Tooleetal.1993).Inthisapproach,\nfacesarealignedwitheach\notherandthentreatedashigh-dimensionalpixelvectors\nfromwhich\neigenvectors,\nso-calledeigenfaces,arecomputed,togetherwiththecorresponding\neigenvalues.\nAprobe\nfaceisdecomposed\nwithrespect\ntotheseeigenvectors\nandistly\nrepresented\nby\nasmallnumber,\nsay\n30,ofexpansioncots.\n(Thenecessaryimagealignment\ncanbe\ndoneautomaticallywithinthePCAframework,\nseeTurk&Pentland1991).PCAisoptimalwithrespect\ntodatacompressionandseemstobe\nsuccessfulforrecognitionpurposes.\nInitsoriginal,simpleform,PCAtreatsanentire\nfaceasonevector.\nItisthensensitive\ntopartialocclusion\nortoobject\ndeformation.Thisproblemhasbeen\ndealtwithby\ntreatingsmallimageregionscentered\nonpoints\n(eyes,\nnose,mouth)asadditionalpixelvectors\nfromwhich\ntoextractmorefeaturesby\nPCA(Pentlandetal.1994).Theseregionscaneasilybe\nlocated\nby\nmatching\nsubspacesofafewPCstotheimage.ThePCAapproach\ninthisformandourapproach\nbegin\ntolook\nvery\nsimilar:Agraphofpoints,\nlabeled\nwithexample-derived\nfeaturevectors\n(smallsetsofeigenvalues\ninthePCAapproach,\nbunches\nofjetsinourapproach)\nismatched\ntotheimage,andtheoptimallymatching\n\\grid"isusedtoextractastructuraldescriptionfromtheimage.Recognitionisthenbasedonthis.'b'IR-INI96{08,c1996Institutfur\nNeuroinformatik,Ruhr-Univat\nBochum,\nFRG\n16Aremainingbetween\ntheapproaches\nliesinthenatureoftheunderlyingfeaturetypes:\nstatisticallyderived\nprincipalcomponents,\nor\\prejudice-derived"\nwavelets.\nItremainstobe\nseenwhich\noftheapproaches\nhasthegreaterpotential\nfordevelopment.\n4.2Performance\nComparisonTo\nobtainameaningfulperformance\ncomparisonbetween\nt\nfacerecognitionsystems,theArmy\nResearch\nLaboratory\nhasestablishedadatabaseoffaceimages(ARPA/ARL\nFERETdatabase)andcomparedourandseveral\nothersystemsinablindtest.resultswillbe\nreleasedsoon\n(Phillipsetal.1996).Herewe\nsummarizeresultswhich\nothergroupshave\nreported\nfortheirsystemstestedontheFERETdatabase.Therecognitionratesaregiven\ninTable\n2.FirstReferenceMethod\nModel\ngalleryProbe\nimagesrank%Gordon(1995)normalizedcrosscorrelationont\nre-gionsinafacemanually\nlocated\nnormalizationpoints\n202fa+pl202fb+pr96fullyautomaticsystem194fa+pl194fb+pr72194fa194fb62Gutta\netal.(1995)radialbasisfunctionnetwork\nfullyautomaticsystem100fa100fb83Moghaddam\n&Pentland(1994)principalcomponent\nanalysisonthewholefacefullyautomaticsystem150fa150fb99150hr150hl38150pr150pl32Phillips&Vardi\n(1995)trainedmatching\npursuitfort\nregionsinafacemanually\nlocated\nfeaturepoints\n172fa172fb98fullyautomaticsystem172fa172fb97Wiskott\netal.(1996)Gabor\nwavelets,\nlabeled\ngraphsandelasticbunch\ngraphmatching\nfullyautomaticsystem250fa250fb98250hr181hl57250pr250pl84Table\n2:Methods,\nandperformances\nofthet\nsystemsdiscussed.Ourresultsarerepeated\nforcomparison.For\nsomesystemsitisnotreported\nwhetherfaorfbhasbeen\nusedforthemodel\ngallery;we\nconsistently\nindicatethefrontal\nmodel\ngalleryby\nfa.Whencomparingtheresults,noticethattherankrecognitionratesdepend\nongallerysize.For\nlower\nrecognitionratestheratesdecreaseapproximately\nas1/(gallerysize).OnlyMoghad-dam\n&Pentland(1994)have\nreported\nresultsonhalfandonnoneofthegroupshasreported\nresultsacrosst\nposes,\nsuch\nashalfprobe\nimagesagainstgallery.\nGordon(1995)hasdeveloped\nasystemwhich\nautomaticallyselectsregionsaroundlefteye,\nright\neye,\nnose,andmouthforfrontal\nviewsandaregioncovering\nthefor'b'IR-INI96{08,c1996Institutfur\nNeuroinformatik,Ruhr-Univat\nBochum,\nFRG\n17views.Thefacesarethennormalizedforscaleandrotation.Therecognitionisbasedonnormalizedcrosscorrelationofthesee\nregionsascomparedtoreferencemodels.\nResultsaregiven\nonthefullyautomaticsystem,alsoforfrontal\nviewsonly,\nandonasystemwherethenormalizationpoints,\ni.e.pupilcenters,\nnoseandchin\ntip,areselectedby\nhand.For\nthecombined\ngallery(fa+pl)thereisagreatbetween\ntheperformance\nofthefullyautomaticsystemandthatwithmanually\nlocated\nnormalizationpoints.\nThatindicatesthattheautomaticlocation\nofthenormalizationpoints\nisthemainweakness\nofthissystem.Gutta\netal.(1995)have\ncollectedtheimagesfortheFERETdatabase.Theyhave\ntestedtheperformance\nofastandardRBF(radialbasisfunction)network\nandasystembasedongeometricalrelationshipsbetween\nfacialfeatures,such\naseyes,\nnose,mouthetc.Theperformance\nofthelatterisvery\nlow\nandnotsummarizedinTable\n2.Moghaddam\n&Pentland(1994)present\nresultsbasedonthePCAapproach\ndiscussedintheprevioussection.Afront-end\nsystemnormalizesthefaceswithrespect\ntotranslation,scale,lighting,\ncontrast,\naswell\nasslight\nrotationsintheimageplane.Thefaceimagesarethendecomposed\nwithrespect\ntotheeigenvectors\nandthecorresponding\ncots\nareusedforfacerepresentation\nandcomparison.Theperformance\nonfrontal\nviews,which\narehighlystandardized,ishighandcomparabletothatofoursystem,buttheperformance\nonhalfandisrelatively\nlow.\nThatindicatesthattheglobalPCA-approach\nismoresensitive\ntovariations\nsuch\nasrotationindepthorvarying\nhairstyle.\nPhillips&Vardi\n(1995)have\ntrainedtwo\nsetsofmatching\npursuitforthetasksoffacelocation\nandiden\nThefocus\nont\nregions:theinterior\noftheface,theeyes,\nandthenoseforlocation;\ntipofthenose,bridgeofthenose,lefteye,\nright\neye,\nandinterior\nofthefaceforiden\nTheperformance\nishighandcomparabletothatofoursystem.Thesmallperformance\nbetween\nthefullyautomaticsystemandtheiden\nmodule\nindicatesthatthelocation\nmodule\nworks\nreliably.\nInthefollowing\nsectionwe\ndiscusssomemethods\nwhich\ncanpotentially\norhave\nbeen\nshown\ntofurtherimprove\ntheperformance\nofoursystem.Adetailedanalysisofourbasicsystemandsomeoftheseextensionswillbe\ngiven\nby\nLyons\netal.(1996).4.3Further\nDevelopments\nThenewlyintroduced\nfeaturesofthesystemopen\nvarious\npossibilities\ntoimprove\nthesystemfurther.Especially\ntheability\ntoreliablysurfacepoints\nonanobject\ncanbe\nuseful,forinstancewhentheissueislearningabout\nlocal\nobject\nproperties\n(Shams&Spoelstra1996).Onesuch\nlocal\nproperty\nistial\ndegreeofrobustnessagainstdisturbances.Krugeretal.have\ndeveloped\nasystemforlearningweights\nemphasizingthemorediscrim-inative\nnodes\n(Kruger1995;Krugeretal.1996).Onmodel\ngalleriesofsize130{150andprobe\nimagesoft\npose\nanaverage\nimprovement\noftherankrecognitionratesof6%was\nachieved,\nfrom25%withoutto31%withweights\nonaverage.\nAnotherindividualtreatment\nofthenodes\nhasbeen\ndeveloped\nby\nMaurer\n&von\nderMalsburg\n(1995).Theyappliedlinearjettransformationstocompensate\nfortheofrotationindepth.Onafrontal\npose\ngalleryof90facesandhalfprobe\nimagesanaverage\nimprovement\noftherankrecognitionrateof15%was\nachieved,\nfrom36%withoutrotationto50%and53%withrotation,depending\nonwitch\npose\nwas\nrotated.However,\nlineartransformationisobviously\nnott,\nandonemay\nhave\ntotrainandapplymoregeneraltransformations.'b'IR-INI96{08,c1996Institutfur\nNeuroinformatik,Ruhr-Univat\nBochum,\nFRG\n18ByusingphaseinformationandtheFBGs,matching\naccuracyhasimproved\ntly.\nHowever,\nmany\npartialmismatches\nstilloccur.\nThisisprobablyduetotheprimitive\nway\ngraphtopography\nishandled,distortionsbeing\ncontrolled\nby\nindependent\nelasticstretching\nofnode-to-node\nvectors.\nItwould\nbe\nofgreathelpifthesemany\ndegreesoffreedomwere\nreplacedby\njustthefewparametersnecessarytodescribe\ntypical\nglobaldistortionpatterns,due,forinstance,torotationindepth,variation\ninfacialexpressionorhairstyle,\nortotheregularandsymmetricalfaceshape\nvariations\nfromperson\ntoperson\norwithage.Thesewould\nhave\ntobe\nlearnedfromexamples,ofcourse.Betterdeformationmodels\nwould\nyieldinformationonthetype\nofdisturbance,which\nwould\nbe\nofvalue\ninitself,andimprove\nrecognition.Someresearch\ninthisdirectionhas,forexample,been\ndoneby\nLanitisetal.(1995).Whendeterminedwitht\nreliability,\ngraphtopography\ncanitselfbe\nusedasabasisforrecognition(cf.Brunelli\n&Poggio1993).In(Wiskott\n1996)thebunch\ngraphtechnique\nhasbeen\nusedtofairlyreliablydeterminefacialattributesfromsingleimages,such\nasgenderorthepresenceofglassesorabeard.\nIfthistechnique\nwas\ndeveloped\ntoextractindependent\nandstablepersonal\nattributes,such\nasage,skincolor,hairtype\noragaingender,recognitionfromlargedatabasescouldbe\nimproved\nandspeeded\nconsiderablyby\npreselectingcorresponding\nsectorsofthedatabase.Iftherestrictiontosingleprobe\nandgalleryimageswere\nrelaxedandseveral\nimagesorabriefvideosequencecouldbe\ninspected,\nthesystemcouldbe\nenriched\nwithinformationondepthandont\nposes.\nThemergingoft\nposes\ninto\nacoherent\nrepresentation\nandtherecognitionofobjects\nonthisbasisinapose-independent\nway\nhasbeen\ndemonstratedin(von\nderMalsburg\n&Reiser1995).informationcouldbe\naddedtoindividualnodes\nasdiscriminatoryfeaturetoimprove\nrecognitiondirectlyanditcouldbe\nusedtopredictposes\nnotpreviouslyseen.Themanual\nofappropriategridstructuresandsemi-autonomousprocess\nofbunch\ngraphacquisitionwillhave\ntobe\nreplacedby\nanautonomousprocess.\nAutomaticreductionofaFBGtoitsessential\njetsinthebunches\nhasbeen\ndemonstratedby\nKrugeretal.(1996).Thecreationofanewbunch\ngraphismosteasilybasedonimagesequences,which\ncontain\nmany\ncuesforgrouping,segmentation,\nanddetectingcorrespondences.\nThegroupingofnodes\nforsalient\npoints\nonthebasisofcommonmotionhasbeen\ndemonstratedin(Manjunath\netal.1992).Monitoringarotatingobject\nby\ncontinuously\napplyingEBGMcanthenreveal\nwhich\nnodes\nrefertocorresponding\npoints\nint\nposes\n(cf.von\nderMalsburg\n&Reiser1995;Maurer\n&von\nderMalsburg\n1996).Inaboot-strapping\nfashion,object-sp\ngridsandobject\nbunch\ngraphscouldbe\nestablishedby\nstartingwithacrudeorgeneralgrid,such\nasutilizedin(Ladesetal.1993),torecognizeobject\nclassesandestablishapproximate\ncorrespondences\nbetween\nimageswithinaclass,onthebasisofwhich\nmoreobject-sp\ngridsandbunch\ngraphscouldbe\nformedinstages,alittlebitreminiscent\noftheway\ninwhich\nwe\npreciseimagegraphsintwo\nstageshere.Acknowledgements\nWe\nwishtothankIrvingBiederman,LadanShams,Michael\nLyons,\nandThomasMaurerforvery\nfruitfuldiscussionsandtheirhelpinevaluating\ntheperformance\nofthesystem.Thanks'b'IR-INI96{08,c1996Institutfur\nNeuroinformatik,Ruhr-Univat\nBochum,\nFRG\n19goes\ntoThomasMaureralsoforreviewingandoptimizingthecode.\nWe\nacknowledge\nhelpfulcomments\nonthemanuscript\nby\nJonathonPhillips.For\ntheexperiments\nwe\nhave\nusedtheFERETdatabaseoffacialimagescollectedundertheARPA/ARL\nFERETprogram.ReferencesBruce,\nV.,Valentine,\nT.,andBaddeley,A.(1987).Thebasisofthe3/4viewadvantage\ninfacerecognition.Applied\nCognitive\nPsychology\n,1:109{120.Brunelli,\nR.andPoggio,T.(1993).Face\nrecognition:Features\nversus\ntemplates.IEEETransactions\nonPatternAnalysis\nandMachineIntelligence\n,15(10):1042{1052.Buhmann,J.,Lange,J.,von\nderMalsburg,\nC.,Vorbr\nuggen,J.C.,andWurtz,\nR.P.(1992).Object\nrecognitionwithGabor\nfunctionsinthedynamiclinkarchitec-\nture:Parallel\nimplementation\nonatransputernetwork.\nInKosko,\nB.,editor,Neural\nNetworksforSignalProcessing\n,pages121{159.Prentice\nHall,Englewood\nNJ07632.Daugman,\nJ.G.(1988).Completediscrete2-DGabor\ntransformby\nneuralnetworks\nforimageanalysisandcompression.IEEETransactions\nonAcoustics,\nSpeech\nandSignalProcessing\n,36(7):1169{1179.DeValois,\nR.L.andDeValois,\nK.K.(1988).Spatial\nVision.OxfordPress.Fleet,D.J.andJepson,A.D.(1990).Computationofcomponent\nimagevelocity\nfromlocal\nphaseinformation.InternationalJournalofComputerVision,5(1):77{104.Gordon,G.G.(1995).Face\nrecognitionfromfrontal\nandviews.InBichsel,M.,editor,Proceedings\noftheInternationalWorkshoponAutomatic\nFace-\nandGesture-\nRecognition,\nIWAFGR\n,pages47{52,Zurich.\nGutta,\nS.,Huang,J.,Singh,D.,Shah,I.,Takacs,\nB.,andWechsler,H.(1995).Benchmark\nstudiesonfacerecognition.InBichsel,M.,editor,Proceedings\noftheInternationalWorkshoponAutomatic\nFace-\nandGesture-Recognition,\nIWAFGR\n,pages227{231,Zurich.\nJones,J.andPalmer,\nL.(1987).Anevaluation\nofthetwo\ndimensionalGabor\nmodel\nofsimplereceptive\nincatstriatecortex.J.ofNeurophysiology\n,58:1233{1258.Kalocsai,P.,Biederman,I.,andCooper,E.E.(1994).To\nwhatextent\ncantherecog-nitionofunfamiliarfacesbe\naccounted\nforby\narepresentation\nofthedirectoutputofsimplecells.InProceedings\noftheAssociation\nforResearch\ninVisionandOphtalmology,\nARVO\n,Sarasota,Florida.Kirby,M.andSirovich,\nL.(1990).ApplicationoftheKarhunen-Loeve\nprocedure\nforthecharacterization\nofhuman\nfaces.IEEETransactions\nonPatternAnalysis\nandMachineIntelligence\n,12(1):103{108.'b"IR-INI96{08,c1996Institutfur\nNeuroinformatik,Ruhr-Univat\nBochum,\nFRG\n20Kruger,N.(1995).Learningweights\nindiscriminationfunctionsusingaprioriconstraints.\nInSagerer,\nG.,S.Posch,andKummert,\nF.,editors,Mustererkennung\n1995,pages110{117.SpringerVerlag.\nKruger,N.,Potzsch,M.,andvon\nderMalsburg,\nC.(1995).Face\nwithalearnedrepresentation\nbasedonlabeled\ngraphs.SubmittedtoIEEETransactions\nonNeural\nNetworks.Kruger,N.,Potzsch,M.,andvon\nderMalsburg,\nC.(1996).Determinationoffaceposition\nandpose\nwithalearnedrepresentation\nbasedonlabeled\ngraphs.SubmittedtoIEEETransactions\nonNeural\nNetworks.Lades,M.,Vorbr\nuggen,J.C.,Buhmann,J.,Lange,J.,von\nderMalsburg,\nC.,Wurtz,\nR.P.,andKonen,\nW.(1993).Distortioninvariant\nobject\nrecognitioninthedynamiclinkarchitecture.\nIEEETransactions\nonComputers,42(3):300{311.Lanitis,A.,Taylor,\nC.J.,andCootes,T.F.(1995).Anautomaticfaceiden\nsystemusingappearance\nmodels.\nImageandVisionComputing,13(5):393{401.Lyons,\nM.,Shams,L.,Maurer,\nT.,Wiskott,\nL.,Fellous,J.-M.,Kruger,N.,andvon\nderMalsburg,\nC.(1996).Performance\noftheeidosfacerecognitionsystemintheFERETcompetition.\nInpreparation.Manjunath,\nB.S.,Chellappa,\nR.,andvon\nderMalsburg,\nC.(1992).Afeaturebasedapproach\ntofacerecognition.Technical\nReport\nCAR-TR-604orCS-TR-2834,ComputerVisionLaboratory,\nUniversity\nofMaryland,ColledgePark,\nMD20742{3411.Maurer,\nT.andvon\nderMalsburg,\nC.(1995).Linearfeaturetransformationstorecognizefacesrotatedindepth.InProceedings\noftheInternationalConference\nonA\nNeural\nNetworks,ICANN'95,pages353{358,Paris.\nMaurer,\nT.andvon\nderMalsburg,\nC.(1996).Tracking\nandlearninggraphsonimagesequencesoffaces.SubmittedtotheInternationalConference\nonA\nNeural\nNetworksICANN'96,Bochum.\nMoghaddam,\nB.andPentland,A.(1994).Face\nrecognitionusingview-basedandmod-\nulareigenspaces.InProc.\nSPIEConference\nonAutomatic\nSystemsfortheation\nandInspection\nofHumans,volume\nSPIE2277,pages12{21.O'Toole,A.J.,Abdi,H.,Deffenbacher,\nK.A.,andValentin,\nD.(1993).Low-\ndimensionalrepresentation\noffacesinhigherdimensionsofthefacespace.JournaloftheOptical\nSociety\nofAmerica\nA,10(3):405{411.Pentland,A.,Moghaddam,\nB.,andStarner,\nT.(1994).View-basedandmodular\neigenspacesforfacerecognition.InIEEEProc.\nComputerVisionandPatternRecogni-\ntion,pages84{91."b"IR-INI96{08,c1996Institutfur\nNeuroinformatik,Ruhr-Univat\nBochum,\nFRG\n21Phillips,P.J.,Rauss,\nP.,andDer,S.(1996).FERET(facerecognitiontechnol-\nogy)recognitionalgorithmdevelopment\nandtestreport.\nTechnical\nreport,\nU.S.Army\nResearch\nLaboratory.\nPhillips,P.J.andVardi,\nY.(1995).Datadriven\nmethods\ninfacerecognition.InBichsel,M.,editor,Proceedings\noftheInternationalWorkshoponAutomatic\nFace-\nandGesture-Recognition,\nIWAFGR\n,pages65{70,Zurich.\nPollen,D.A.andRonner,\nS.F.(1981).Phaserelationshipbetween\nadjacent\nsimplecellsinthevisualcortex.Science\n,212:1409{1411.Potzsch,M.(1994).DieBehandlungderWavelet-Transformation\nvon\nBilderninderahe\nvon\nObjektkanten.\nTechnical\nReport\nIR-INI94-04,Institutfur\nNeuroinformatik,Ruhr-Univat\nBochum,\nD-44780Bochum,\nGermany.\nDiplomathesis.Samal,A.andIyengar,P.A.(1992).Automaticrecognitionandanalysisofhuman\nfacesandfacialexpressions:Asurvey.\nPatternRecognition\n,25(1):65{77.Shams,L.andSpoelstra,J.(1996).LearningGabor-based\nfeaturesforfacedetection.SubmittedtoWorldCongress\nonNeural\nNetworks'96.Sirovich,\nL.andKirby,M.(1987).Low-dimensional\nprocedure\nforthecharacterization\nofhuman\nfaces.JournaloftheOptical\nSociety\nofAmerica\nA,4(3):519{524.Theimer,W.M.andMallot,H.A.(1994).Phase-basedbinocular\nvergence\ncontrol\nanddepthreconstructionusingactive\nvision.CVGIP:\nImageUnderstanding,60(3):343{358.Turk,M.andPentland,A.(1991).Eigenfacesforrecognition.JournalofCognitive\nNeuroscience\n,3(1):71{86.Valentin,\nD.,Abdi,H.,O'Toole,A.J.,andCottrell,G.W.(1994).Connectionistmodels\noffaceprocessing:\nAsurvey.\nPatternRecognition\n,27(9):1209{1230.von\nderMalsburg,\nC.andReiser,K.(1995).Pose\ninvariant\nobject\nrecognitioninaneuralsystem.InProceedings\noftheInternationalConference\nonA\nNeural\nNetworksICANN'95,pages127{132,Paris.\nEC2&Cie.Wiskott,\nL.(1996).Phantom\nfacesforfaceanalysis.Technical\nReport\nIR-INI96-06,Institutfur\nNeuroinformatik,Ruhr-Univat\nBochum,\nD-44780Bochum,\nGermany.\nSubmittedtoPatternRecognition\n.Yuille,A.L.(1991).Deformabletemplatesforfacerecognition.JournalofCognitive\nNeuroscience\n,3(1):59{70."