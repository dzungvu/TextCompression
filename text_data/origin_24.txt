b'LowCostDebugArchitectureusingLossyCompressionforSiliconDebugEhabAnisandNicolaNicoliciDepartmentofElectricalandComputerEngineeringMcMasterUniversity,Hamilton,ONL8S4K1,CanadaEmail:anise@mcmaster.ca,nicola@ece.mcmaster.caAbstractThesizeofon-chiptracebuffersusedforat-speedsili-condebuglimitstheobservationwindowinanydebugses-sion.Wheneverthedebugexperimentcanberepeated,weproposeanovelarchitectureforat-speedsilicondebugthatenablesamethodologywherethedesignercaniterativelyzoomonlyintheintervalscontainingerroneoussamples.Whencomparedtoincreasingthesizeofthetracebuffer,theproposedarchitecturehasasmallimpactonsiliconarea,whilereducingthenumberofdebugsessions.1.IntroductionForsystem-on-a-chip(SOC)designs,visamajorcontributingfactortotheimplementationcycle.Asaconsequence,workhasbeendoneintheareaofpre-siliconvwheredesignerrors(orbugs)arecaughtthroughformalmethodsorextensivefunctionalsim-ulation[14].ThegrowingSOCcomplexitycombinedwiththediftoaccuratelymodelintegratedcircuits(ICs),makesthepre-siliconvmethodsinadequatetoguaranteeaproductwithouterrorsbeforeanalyzingthesilicon.Furthermore,manyelectricalproblems(e.g.,leak-ageordrivecannotbescreenedwithouttheusageofthefabricatedIC[11].Consequently,duetotheescalatingmaskcostsitisimperativethattheundetectedfunctionalandelectricalbugsareedassoonasthesiliconisavailable.Toachievethischallenge,silicondebug,whichistheprocessoflocatingandidentifyingdesignbugsinthepost-siliconphase[2],isbecominganecessity.1.1.PriorWorkToplacethecontributionofthispaperinalargercontext,thissubsectiondiscussesthemaindirectionsinsiliconde-bugofdigitalICs.Numerousphysicalprobingtechniques,suchaselectronorionbeamtechniques,havebeenusedextensivelyoverthepastfewdecadesinICfailureanaly-sis[19].Todealwithmultiplemetallayers(commontomodernICs),timeresolvedphotoemission,thatoperatesthroughthesiliconsubstrate,hasemerged[6].Physicalprobingcanalsobeusedforscreeningelectricalbugs,how-ever,despitetherecentadvancementsinthisresearchthecomplexityofstate-of-the-artdevicesrequiresalocal-izationsteptoprecedethedestructiveICfailureanalysis.Thisstep,whichwecalllogicprobing,correlatesthesimu-lationdatatowhatisobservedinthesilicon(eitherontheinput/outputs(I/Os)orontheinternalsignals,whichareob-servedasdiscussedinthefollowingparagraphs)inordertoidentifyasubsetofcircuitnodesthatneedtobephysicallyprobed[20].Inaddition,becausemanydesignerrorsinap-plicationintegratedcircuits(ASICs)areundetectedfunctionalbugs,physicalprobingisofnouseforidenti-fyingthemduringthepost-siliconphase.Moreover,logicprobingisalsoessentialfordebuggingdesignsmappedtogatearrays(FPGAs).Therefore,duetotheirimportanceforbothfunctionalandelectri-calbugs,nextweoverviewthelogicprobingtechniques.ThedebugofmemoriesembeddedinSOCsreliesonthebuilt-inself-test(BIST)ordirectmemoryaccessinfras-tructure,whicharecommonlyavailableon-chipformanu-facturingtestanddiagnosis.However,whenevertheabovearenotprovided,asitisthecaseforsmallembeddedmem-ories(e.g.,storebuffersorinstructionqueues)methodsthatrelyonclockcontrolandtheinternalscanchainsneedtobeemployed[13].ThedebugmethodsbasedoninternalscanchainshavebeenusedextensivelyfordebuggingcomplexdigitalICs[22].Inscan-baseddebug,thenormaloperationofthecircuitiscapturedaftertheoccurrenceofatriggerevent(orbreakpoint).Subsequentlythecircuitstateisobservedbytransferringittothedebugsoftwareeitherthroughthescanchannels,ifdebuggingontheautomatictestequipment(ATE),orthroughtheJTAGinterface[18],whendebuggingonthetargetapplicationboard.Oneapproachtoreusingthescanlogicforsiliconde-bugistointegrateadebugmodule,which,inadditiontocontrollingthebreakpoints[21],itcanstart,stop,resumeorsingle-steptheexecution.Thisapproachobviouslypro-videshighobservabilityofcircuitbehavior,nonethelessitislimitedtothecasewhentheinputstimuliarenotpro-videdinreal-time.Analternativeapproachthatisapplica-bletoreal-timeinputstimuli,reliesonstoppingthefunc-tionaltestprogramwhenafailureisobservedonanoutputandsubsequently,byre-runningthedebugexperimentwith978-3-9810801-2-4/DATE07  2007 EDAA \n 'b'differenttriggerpoints,itwillscanthestatebeforeandaftertheobservedfailurepoint.Thereafter,post-processingalgo-rithms,suchaslatchdivergenceanalysis[4]orfailureprop-agationtracing[3],canbeusedtoanalyzethescandumpsandidentifythefailingstateelements.Thisapproach,nevertheless,needstostopthecircuitexecutionafterafail-ingpointisthusignoringanyfurthererroneousbehaviors.Becausehard-to-detectfunctionalbugsappearincircuitstateswhichmaybeexercisedbillionsofcyclesapart[11],itisthereforedesirabletocontinuetheexecutionafterafailingpointwithouthalting.However,tocompleteascandumpwhilecontinuingthereal-timeexecution,itisnecessarytodoublebufferthestateelementsinthescanchain,whichwilllikelyleadtounacceptableareapenalty[12].Acomplementaryapproachtoscanistomonitoronlyasubsetofinternalsignalsthataredumpedinreal-timeinatracebuffer.Whilescan-baseddebugconceptshaveemergedfromthemanufacturingtestresearch,tracebuffer-baseddebug,whichisdiscussednext,hasbeenbysoftwaredebuggingusedinembeddedsystems[16].Real-timesystemscenteredaroundembeddedproces-sorsormicro-controllersandhavebeentraditionallyde-buggedusingin-circuitemulator(ICE)devices.ICEsareconstructedusingbond-outchips,whichconnectinternalnodestoadditionaldeviceI/Osinordertomakethemvisi-bleoff-chiptoexternalinstruments.ThelimitationofusingICEsforstate-of-the-artSOCdevicesliesnotonlyintheincreasinggapbetweentheon-chipandoff-chipfrequen-cies,butalsoinalargefootprintofthebound-outchipscausedbytheadditionalI/Osusedonlyfordebug.Asaconsequence,forSOCdesigns(bothFPGAandASICim-plementations)therehasbeenatrendtowardplacingtheinstrumentationon-chip,thusenablingat-speedsamplingthroughembeddedlogicanalysis[10,17].Thesampleddataissubsequentlysentviaalowbandwidthinterfacefromtheinternaldebugmoduletotheexternaldebugsoftwareforpost-processing.Thetracebuffer-baseddebugmeth-odscanbebroadlyas:special-purpose(i.e..,spe-toembeddedprocessors)[8,9]orgeneric(i.e.,appli-cabletoanytypeofcustomSOCs)[1,15];withcentralizedtracingwhereonetracebufferisusedperSOC(withdif-ferentinterconnecttopologiesbetweentheembeddedcoresandthetracebuffer)[1,8,9]ordistributedsamplingwithtracebuffersallocatedtoindividualcores[15].Regardlesswethertheyarespecial-purpose,generic,centralizedordis-tributed,thedistinguishedofthetracebuffer-basedmethodsistheabilitytodoat-speeddebug,whichisalsosuitableforanalyzingtheno-trouble-foundparts[5].1.2.MotivationandObjectiveGiventheuseandat-speedsamplingadvantagesoftracebuffer-baseddebugmethods,anobviousquestioniswhatkindofdrawbacksarelimitingtheiruse?Thefunc-tionalbugsthatarehard-to-detectwillmanifestthemselvesonlyseveraltimesoveralargeexecutiontime[11].There-fore,toacceleratetheoftherootofaproblem,onewouldliketocorrelatethefewdifferentfailingobser-vationsthatoccurwhilerunningalongdebugexperiment.Toachievethis,theobservationwindowofanexperimentneedstobeextended,however,giventhelimitedon-chipareaavailablefortracebuffers,thenumberofdebugses-sions(i.e.,thenumberoftimesthesameexperimentisre-runwithdifferenttriggerpointsthatinitiateon-chipsam-pling)mayincrease.Therefore,theanswertotheabovequestionliesinthetrade-offbetweenthetrace-bufferareaandthenumberofdebugsessionsforagivenobservationwindow.Thetrace-bufferareaisdeterminedbyitswidth,whichconstrainsthenumberofsignalstobeprobed,anditsdepth,whichlimitsthenumberofsamplestobestored.Toextractasmuchdataaspossiblefromagivendebugsession,withoutincreasingtheon-chiparea,compressionforthewidthanddepthofthetracebuffercanbeemployed.Thisideahasbeenexploredindifferentwaysforbothspecial-purposeandgenericscenarios.Ontheonehand,forthespecial-purposecase(e.g.,[8])thecompressionsolutionsarewellestablished[10,16].Thekeyideaforwidthcompressionistoprobeasubsetofsignalsfromwhichthestateoftheembeddedprocessorcanbereconstructedasaccuratelyaspossible(e.g.,pipelinestatussignalsorindirectbranchsignals).Thedepthcom-pressionisaccomplishedbyeliminatingtheredundanttem-poralinformationondataoraddressbusses(e.g.,throughdifferentialcompression)orbysettingupthrough-outtheobservationwindowthatenableselectivesamplingintime,whichhelpsavoidtracebufferovws.Ontheotherhand,forthegenericcasethecompressionsolutionsarecurrentlyemerging.Forexample,widthcompressioncanbeachievedbyautomaticallyanalyzingthedesignandidentifyingasubsetofessentialsignals,which,afterbe-ingcapturedon-chip,willbeoff-lineusingtheknowledgeofthedesign[1].Motivatedbythefactthat,tothebestofourknowledge,therearenomethods(reportedinthepublicdomain)fordepthcompressionapplicabletoanydesign,itistheaimofthispapertoinvestigatethisproblem.2.ProposedIterativeDebugFrameworkThemethodproposedinthispaperisapplicabletothecasewherethedebugdataisknowna-prioriandadetermin-isticexecutionofinputdatawillalwaysproducethesameoutputdata.ThisisthecasewhendebuggingonanATEanditisalsocommononatargetapplicationboardwherestim-uliareappliedsynchronously(e.g.,audio/videodecoder)andtheexpectedresponsescanbecomputedusingarefer-encebehavioralmodelofthecircuitunderdebug(CUD).Thisdebuggingmethodisalsoreferredtoascyclicdebug-gingordeterministicreplayinthesoftwareengineeringlit-eratureandhavinganexperimentaltestbedthatsupportsitisapre-requisitefortheiterativedebugwdescribednext.2'b'J\nT\nA\nGUser DefinedLogicEmbedded     CoresDebug ModuleCUD(2)1(1)3(1)4(1)1(2)4(2)3(2)2(1)2..J\nT\nA\nGUser DefinedLogicUser DefinedLogicEmbedded     CoresEmbedded     CoresDebug ModuleDebug ModuleCUD(2)1(1)3(1)4(1)1(2)4(2)3(2)2(1)2..Figure1.TheIterativeDebugFlowThebasicintuitionofourapproachcanbeexplainedasfollows.Incyclicdebugging,byre-runningthesameexper-imentdeterministically,theuseofdifferentdebugmodule(suchasdecidingtostartsamplingatdis-tincttimesindifferentdebugsessions)canfacilitatethere-constructionofthecircuitbehavioroveralongobservationwindow.Thestraightforwardwayofachievingthisisre-sumesamplinginanewdebugsessionfromthesamepointintimewherethepreviousdebugsessionhasstopped.How-ever,ifthetracebufferonthechipissmallandthetargetedobservationwindowislong,thiswillleadtounnecessarilylargenumberofdebugsessions.Therefore,weproposetorunthedebugsessioninacompressedmodeandlearnfromitwhichintervalsintheobservationwindowareerror-free.Thiscanbeachievedthroughlossycompressionbymappingintervalsontosignatures.Thetargetedobserva-tionwindowandthesizeoftheon-chiptracebufferwillde-terminethecompressionlevel.AsshowninFigure1(wheremeansstepindebugsession),thedebugsoftwarewillprepareandloadtheCUDdata()forthedebugsession.Then,thedebugexperimentisrunon-chipandthecompressedintervals(i.e.,signatures)willbesampledintothetracebuffer(,notethehardwarerequiredtoachievethiswillbediscussedinthefollowingsection).Thenthetracebuffercontentwillbeoftothedebugsoftware(),wherethefailingsignatures(andhenceintervals)willbe().Ifasignatureiserror-free,then,intheremainingdebugsessions,theinter-valwhosesequenceofsamplesmapsontotherespectivesignature,willbeskippedandnosampleswillbeextractedfromit.Inthefollowingdebugsessionthesamestepsarecompleted(,,and).Note,however,usingthefailinginformationfromtheprecedingdebugsessiontheusercansetuptheCUDsuchthathezooms-inonlyintothefailingintervals.Thisprocessisrepeatediter-ativelyinthesucceedingdebugsessionsuntilallthefailingintervalsareextracted.Thestemfromthefactthatwecanobservethefailingbehaviorswithinalongobserva-tionwindowwithoutwastinganydebugsessionsforsam-plingtheerror-freeintervals.Thedebugarchitecturethatfacilitatesthisiterativedebugwisdescribednext.CTRL-word(0)CTRL-word(S-1)TRIG-pointer(0)Event-countEventDetectorEventSequencerM\nI\nS\nRTrace BufferTrace Buffer CTRLSerializerJ\nT\nA\nGTRIG-pointer(S-1)MISR-SPS....Seg.-enMISR-enDebug DataTrigger SignalsCTRLX\nO\nRSeg-size(0)Seg-size(S-1)St_enSp_enCTRL-word(0)CTRL-word(S-1)TRIG-pointer(0)Event-countEventDetectorEventSequencerM\nI\nS\nRM\nI\nS\nRTrace BufferTrace Buffer CTRLSerializerJ\nT\nA\nGTRIG-pointer(S-1)MISR-SPS....Seg.-enMISR-enDebug DataTrigger SignalsCTRLX\nO\nRSeg-size(0)Seg-size(S-1)St_enSp_enFigure2.TheEmbeddedDebugModule3.DebugArchitectureforLossyCompressionThissectiondescribesthedistinguishingfeaturesoftheproposeddebugarchitecture.Westartbyexplainingthecommonfeaturesinanembeddeddebugmodule.Thisisfollowedbythehardwarerequiredtosupporttheiterativedebugwbasedonlossycompression.3.1.EmbeddedDebugModuleAsshowninFigure2,atthecoreofadebugmoduleusedforembeddedlogicanalysisisaneventdetector.Itspurposeistomonitoragroupoftriggersignalssoitcandeterminewhenthedatasignalswillbesampledinthetracebuffer.Inourimplementationtriggeringcanbedonebasedonbitwise,reduction,comparisonandlogicaloper-ationsbetweenthetriggersignals.Threelevelsofopera-torscanbecombinedandtheoperationscanbeperformedbetweentwotriggersignalsselectedbythecontrolword().Sincetheeventdetectorcontainsmanylevelsoflogic,ifnecessary,itsspeedcanbeimprovedtosupporthighersamplingfrequenciesbypipeliningit.Toen-ablesequentialeventdetection,basedontheofthecontrolwordsandthe(whichthenumberoftriggerevents),theeventdetectorisinterfacedtoaneventsequencer.Whenthesegmentedmode(45)7689)7+)isenabled,thetracebufferisdividedintomultiple4segments.Note,however,inthismodea,aswellasasegmentsize(45)76:<;)),needstobesupplied(aspartoftheCUDdataprovidedforadebugsession)foreachofthe4segments.Afterthetracebufferiswithsamples,itscontentisserializedandsentbacktotheoff-chipdebuggersoftwareviaalow-bandwidthinterfacesuchasJTAG.Ifthestreammodeisenabled()thedebugdatawillbestreamedasitissampled(providedthatthetracebufferhasonereadandonewriteport).Thiswillincreasethenumberofsam-plesacquiredinonedebugsession,nonethelessthetracebufferwilleventuallybecomefull,sincethebandwidthforstreamingislimited.3'b'Level 0SPS0= 4096Level 1SPS1=32Level 2SPS2=1Session1Session4Session5Session6Session2Session3S0S1S2S3S0S1S2S0S1S2S3S0S1S2S3S0S1S2S3S3N = 221M = 512S = 4Level 0SPS0= 4096Level 1SPS1=32Level 2SPS2=1Session1Session4Session5Session6Session2Session3S0S1S2S3S0S1S2S0S1S2S3S0S1S2S3S0S1S2S3S3N = 221M = 512S = 4Figure3.AnIllustrativeDebugExample3.2.LossyCompressionOurproposedsolutionreliesonamultipleinputsigna-tureregister(MISR)(commonlyusedinBIST),whichisplacedattheinputofthetracebuffer.ThisMISRperformslossycompressionontheselecteddebugdatasignalswithacompressionleveldeterminedbythesamplespersigna-ture(BDC*45E45FG4)parameter,whenevertheMISRenableisenabled.Atthebeginningofadebugses-sion,theMISRcounter(whichisplacedinthecontrollerofthedebugmodule)isinitializedtozero.Afterthetriggerconditionoccurs,theMISRcounterstartscountinganditresetsbacktozeroeachtimeitreachesBDC*45J4KFG4,atwhichpointthesignatureiswritteninthetracebuffer.Thenumberofsignaturesstoredineachsegmentisdeterminedby4K)L6KE;).Afterthedebugsession,inordertostartsamplingatthebeginningofanintervalofinterest,atriggerpointer()isusedforeachsegment.Thevalueofthistriggerpointerispre-computedoff-line(basedonthefailinginformationfromthepreviousdebuglevel)anditisalsopassedaspartoftheCUDdataatthebeginningofeachdebugsession.WhenallthefailingintervalsoflengthsmallerthanthesegmentsizehavebeenthecompressiondoesnotneedtobeperformedanymoreandBDC*45RS)7+isdeactivated.Duetospacelimitationswecannotelaborateonallthesteps,algorithmsandequationsusedtoupdatetheCUDdatafromonedebugsessiontoanother.Asaconsequence,weuseFigure3andthefollowingexampletoshowhowthefeaturesdescribedinthissectioncanbeusedfortheproposediterativedebugw.Example1Weassumethetracebufferhas4DTVUseg-mentsanditsdepthisBTXWlocations,andthetar-getedobservationwindowisYZTsamples.Westartwithaninitialdebugsessionthatcompressestheentireobservationwindowwiththecompressionlevelgivenby(45FG4-fisthenumberofsamplespersignatureatdebuglevel).Debuglevel0hasonlyonedebugsession,inwhichthetracebufferisunsegmented.Aftertheinitialdebugsession,eachoftheeightfailingsignaturescovers4096samples,which,forthisparticularcase,isgreaterthanthesizeofthetracebuffer(512loca-tions).Therefore,wewillhaveanintermediatedebuglevel1,whichwillfurther-outtheerrorfreeintervals.Forallthesubsequentdebugsessions,thememorysegmentsareusedinsuchwaythatinsteadofexpandingonefailingsignatureperdebugsession,4failingsignaturesareex-panded.45FG4canbecalculatedas45FG4[_Thg.Thetriggerpointersineachdebugsessionarecalculatedbasedonthe45FG4ofthecurrentdebuglevelandthestart-ingpointofthefailingsignaturesfromthepreviousdebuglevel.Inthelastdebuglevel2,nocompressionwillbeap-plied(45FG4T).Tobetterutilizetheavailablememory,beforerunninganysessionindebuglevel2,thedebuggersoftwarewillcheckifanyneighboringsignaturesfromlevel1canbemergedsuchthatmorethanonesignaturecanbeexpandedintoonesegmentindebuglevel2.InFigure3,twoofthefailingsignaturesfromsession2atdebuglevel1canbeexpandedinonesegmentindebuglevel2.Therefore,sincethenumberoferroneousintervalsisonly12(itequalsthenumberofsegmentswithfailingsamplesinthelastde-buglevel)thenumberofdebugsessionsfortheproposedapproachis6.Inthej(i.e.,nocom-pression),thetotalnumberofsessionstocollectdataoverthesameobservationwindowwouldbe.Ifthenumberoffailingsamplesishighthenthepro-posedmethodwillunlikelybringanybecauseiter-ativelywewillhavetozoominalargenumberofintervals.However,forlowerrorrates,whichwouldbearealisticas-sumptionwhensearchingforhard-to-detectbugsthatoccurspuriouslyinlargeobservationwindows[11],thereductioninthenumberofdebugsessionsisconsiderableasshownintheexperimentalsection.3.3.TheAdditionofSpatialCompressionTheshowninFigure2isusedtoenablespatialcompression.InthiscasewidthcompressioncanbeemployedbeforetheMISRbyusingano9p8networkinwhichmultiplechannelsofdebugdataarecompressedintoasingleone.Thisfeaturecanbeusedinallthedebuglevelsexceptthelastone,wherenocompressionisperformedandthedebugmoduleselectsonlyonechannelatatime.Note,whileboththespatialcompressorandtheMISRmayrunintothealiasingproblemitisunlikelythatalltheerroneoussamplescausedbyaparticularbugwillleadfault-lesssig-naturesinallthepossibleintervalsofoccurrence.3.4.CombiningStreamingandCompressionAninterestingobservationisthatifthelengthoftheobservationwindowislargeandifthefailingsignaturesaresparse,thenthereisplentyofidletimeinbetweenanytwotriggerpointsinthetracebuffer.Therefore,anadditionalarchitecturalfeature(inFigure2)enablesthestreamingofthesamplesstoredinthetracebufferthroughtheJTAGportwhilethedebugexperimentisstillrunningontheCUD.Thebasicprinciplecanbeexplainedasfollows.Wethestreamingdistanceastheminimumdis-tancebetweentwotriggerpointsthatcanbemappedonto4'b'thesegmentofthetracebuffer,withoutovwingitwhenthestreammodeisenabled.Thestreamingdistanceiscalculatedbasedontheon-chipsamplingfrequency,theoff-chipserialinterfacefrequencyandthetracebufferseg-mentsize.Whilestreamingoutthecontentsofthesegment,anothertriggerpointerthatthestreamingdistancecanbeuploadedtothedebugmodule.Theprocessofstreamingoutthesegmentcontentsanduploadinganewtriggerpointerforthesamesegmentisrepeatedun-tilthelast4qsignaturesinthecurrentdebuglevelarereached.Subsequently,afterofthecontentofthetracebuffertothedebuggersoftware,theabovestepsarere-peatediterativelyuntilallthefailingintervalsaredetected.4.ExperimentalResultsThissectiondiscussestheexperimentsconcerningtheareainvestmentandcompressionoftheiterativede-bugwpresentedinthispaper.Itshouldbenoted,theproposedsolutionhasnotbeenimplementedintoanASIC.Nonetheless,thearearesultshavebeenestimatedusinga180nmASICstandardcelllibrary.Therestoftheexper-imentshavebeendoneusingthedataavailablefromtheFPGAprototypingofanMP3audiodecoder[7]orusingrandomdata,asexplainedlaterinthissection.4.1.AreaoftheProposedDebugModuleTable1showstheareaofthedebugmodule(withoutthetracebuffer)intermsof2inputNAND(NAND2)gates.Theresultsshownarefordifferentnumberofvariable-sizedsegments(4bT,4bTrUand4bTts)forthefollowingcases:nocompressionandnohighspeedsamplingfeatures;nospatialcompression()andspatialcompressionwithdifferentnumberofchannels(,and)wherestreamingcompressionisenabledandhighspeedsamplingisfacilitatedbypipeliningtheeventdetec-tor.Theresultsfromthetablereferonlytothelogicareaanddonotaccountforthetracebuffer.ToensurethatthedebugmodulecanbesharedbetweenmultiplelogiccoresontheSOC,weconnect8differentgroupsofsignalstothesamedebugmodule.Inaddition,itisimportanttohaveasmanyfeaturesaspossibleinthecontrolword(suchascompareagainstaconstantormixseveraltypesoflogicorrelationaloperators),thecontrolword(whichisstoredforeachsegment)willgrowinsize.Shouldallthesefeaturesberemoved,theareaofthedebugmodulecanbereduced,neverthelessthedebugcapabilitieswillbeseverelylimited,whichwedonotconsidertobeagoodmotivation.ThedifferentvariantsoftheproposedarchitectureareobviouslylargerthanthedebugarchitecturethatdoesnotSegmentsNoCompressionNumberCompressionx?y{zP|x?y{z~}x?y"z]z~}2318458546494725488033336169623463146468z~53599044910891889343Table1.AreainNAND2EquivalentsNoStreamingStreamingError%NoSpatialSpatialNoSpatialSpatial0.16445.059.776.2111.61.5906.88.712.318.06.1432.43.14.66.9Table2.ReductioninDebugExecutionTimeforMP3(YT,BZTJW,4T<U,)haveanycompressionorhigh-speedfeatures.Whatisinter-estingtonote,however,asthenumberofchannelsusedforspatialcompressionincreases,theaddedareabecomesin-Nonetheless,asshownlaterinthissectionspa-tialcompressionfeaturecanfurtherreducethenumberofdebugsessions.Itisessentialtonotealsothattheincreaseinthelogicareaofthedebugmodulehaslesspenaltythanscalingthetracebuffer.Forexample,for8segmentsand8channelsthatarespatiallycompressed,theaddedlogicareaforcompressionisstilllessthanoneofthesizeofanembeddedmemoryof4Kbytesimplementedinthesametechnology.4.2.MP3DecoderExperimentsAnMP3decoderhasbeenimplementedandprototypedonanFPGAboard.Itwasinvestigatedhowfunctionaler-rorsintheRTLcode,canbedetectedusingtheproposedmethodology.Table2showsthereductionratiosintermsofthedebugexecutiontimefortheentireobservationwin-dow,whereandQLmMarethedebugexecutiontimesforthesequential(i.e.,nocompression)andtheproposeddebugmethodsrespectively.Tocomputethedebugexecu-tiontimeweneedtoconsidernotonlythenumberofthedebugsessions,butalsotheon-chipsamplingtimeandthecommunicationtime(neededforoff-loadingthetracebuffercontenttothedebuggersoftwarethroughtheJTAGinter-face)foreachofthedebugsessions.Ontheonehand,thecommunicationtimeisdeterminedbytheJTAGfrequencyandthecapacityofthetracebufferandthereforeitiscon-stantforallthedebugsessions.Ontheotherhand,fortheproposedmethodtheon-chipsamplingtimeisdependentonhowmanyon-chipclockcycleselapsefromthetriggereventuntilthetracebufferisonlywithfailinginter-vals,whichareofinterestinthecurrentdebugsession(e.g.,inFigure3theon-chipsamplingtimefordebugsession3willbelargerthanfordebugsession2).Therefore,thistimevariesfromonedebugsessiontoanotheranditisdependentonthedistributionofthefailingsamplesintheobservationwindow.Itshouldbenotedthatthedebuggersoftwaredoesnotincuranyadditionallatencybecausetheprocessingofdebugdatacanbedoneatthesametimewhilethedebugex-perimentsarerunningon-chipand/orthedataistransferredto/fromthedebuggersoftware.ThedatareportedinTable2isforprobingthedatabussesafterthestereodecodermoduleintheMP3decoder\'spipe[7]for3differentfunctionalbugsaffectingonlysev-eralstereomodes.Theerrorchoicesaremotivatedbythefactthatonlyafewmusicframesthroughoutanentiresong5'b"Error%Burstlength641282565121.5537.111.918.3262.32458.31318.43.0773.96.510.114.43.8313.25.38.311.8Table3.ReductioninDebugExecutionTimeversusError%ofRandomDataforDifferentBurstLengthswithYT,BZT,4STRUwilluseastereomode,thusjustifyingthecondi-tionthatthebugsareverydiftoandtheymanifestthemselvesonlyspuriouslyoververylongobservationwin-dows(theerrorratesare.16%,1.59%and6.14%respec-tively).Inthisparticularcase,theobservationwindowrep-resents1820MP3frames(thereare1152samplesperMP3frame),whichgivesYT.ThespatialcompressionisappliedonbothmusicchannelsoftheMP3decoderand,asclearlyshowninTable2,streamingcanbringsubstantialimprovements.Thereductioninthedebugexe-cutiontimewhenusingstreamingisduetothefactthatbyusingtheproposediterativedebugw,bysamplingonlythefailingintervalsfromthepreviousdebuglevelwecanusethetimeinbetweentwointervalstostreamoutsamplesthathavebeensampledinthesamedebugsession.4.3.RandomDataExperimentsToshowthesensitivityoftheresultsonthedistributionoffailingsamples,Table3showsthereductionindebugex-ecutiontimefordifferentsetsofrandomdataexperimentsthathavedistincterrordistributions.Therandomdataex-perimentsassumeYT,BTcUHs,4DTU,andthatnospatialcompressionandnostreamingcompressionareenabled.Theburstlengthrepresentsthenumberoferro-neoussamplesthatoccurconsecutivelyandalltheburstsarerandomlydistributedovertheentireobservationwin-dow.Asitcanbeclearlyobservedfromthetable,whentheburstlengthincreases,thereductionratiosgrow.Thisisbecausewhentheburstlengthisapproachingthesegmentsize,foragivenerrorpercentage,thenumberofuncom-presseddebugsessions(thelastlevelofdebug)arereduced(alsothenumberofdebugsessionsintheintermediatelev-elsareindirectlyreducedaslessfailingsignaturesneedtobeprocessed).Finally,asexpected,astheerrorpercentageincreases,thereductionratiosdecreaseforthesameburstlengthsincemoredebugsessionswillbenecessarytode-tecttheerroneousintervals.5.ConclusionThispaperhasshownhowlossycompressioncanbeusedfordevelopinganewdebugarchitectureandaniter-ativedebugwthatenableanincreaseintheobservationwindowwhilesupportingtheexistingdepthorwidthcom-pressiontechniquesforat-speedsilicondebugofgenericdigitalICs.Theproposedsolutioncanbeusedasanaidtotheexistingmethodsfortracebuffer-baseddebug,when-evercyclicdebuggingispermitted.References[1]M.AbramoviciandY.-C.Hsu.ANewApproachtoSiliconDe-bug.InIEEEInternationalSiliconDebugandDiagnosisWorkshop(SDD),November2005.[2]M.Abramovici,E.J.Marinissen,M.Ricchetti,andB.West.Sug-gestedTerminologyStandardforSiliconDebugandDiagnosis.InIEEEInternationalSiliconDebugandDiagnosisWorkshop(SDD),November2005.[3]O.Caty,P.Dahlgren,andI.Bayraktaroglu.MicroprocessorSiliconDebugBasedonFailurePropagationTracing.InProceedingsIEEEInternationalTestConference(ITC),pages284293,October2005.[4]P.Dahlgren,P.Dickinson,andI.Parulkar.LatchDivergencyinMi-croprocessorFailureAnalysis.InProceedingsIEEEInternationalTestConference(ITC),pages755763,October2003.[5]S.Davidson.UnderstandingNTFComponentsfromtheField.InProceedingsIEEEInternationalTestConference(ITC),pages333342,October2005.[6]R.Desplats,F.Beaudoin,P.Perdu,N.Natara,T.Lundquist,andK.Shah;.FaultLocalizationUsingTimeResolvedPhotonEmis-sionandSTILWaveforms.InProceedingsIEEEInternationalTestConference(ITC),pages254263,October2003.[7]S.Hacker.MP3:TheGuide.O'Reilly&Associates,Inc.,Mar.2000.[8]A.HopkinsandK.McDonald-Maier.DebugSupportStrategyforSystems-on-ChipswithMultipleProcessorCores.IEEETransac-tionsonComputers,55(2):174184,February2006.[9]Y.HuangandW.-T.Cheng.UsingEmbeddedInfrastructureIPforSOCPost-SiliconVInProceedingsACM/IEEEDesignAutomationConference(DAC),pages674677,June2003.[10]IEEEIndustryStandardsandTechnologyOrganization.TheNexus5001ForumStandardforaGlobalEmbeddedProcessorDebugIn-terface.http://www.nexus5001.org,2003.[11]D.Josephson.TheManicDepressionofMicroprocessorDebug.InProceedingsIEEEInternationalTestConference(ITC),pages657663,October2002.[12]D.JosephsonandB.Gottlieb.TheCrazyMixedupWorldofSili-conDebug.InProceedingsIEEECustomIntegratedCircuitsCon-ference(CICC),pages665670,October2004.[13]Y.-J.Kwon,B.Mathew,andH.Hao.FakeFault:ASiliconDebugSoftwareToolforMicroprocessorEmbeddedMemoryArrays.InProceedingsIEEEInternationalTestConference(ITC),pages727732,October1998.[14]W.K.Lam.HardwareDesignVSimulationandFormalMethod-BasedApproaches.PrenticeHall,2005.[15]R.LeathermanandN.Stollon.AnEmbeddedDebuggingArchitec-tureforSOCs.IEEEPotentials,24(1):1216,February2005.[16]C.MacNameeandD.Heffernan.EmergingOn-chipDebuggingTechniquesforReal-TimeEmbeddedSystems.IEEComputing&ControlEngineeringJournal,11(6):295303,December2000.[17]K.Morris.On-ChipDebugging-Built-inLogicAnalyzersonyourFPGA.JournalofFPGAandStructuredASIC,2(3),January2004.[18]K.Parker.TheBoundary-ScanHandbook:AnalogandDigital.KluwerAcademicPublishers,2ndedition,1998.[19]J.SoldenandR.Anderson.ICFailureAnalysis:TechniquesandToolsforQualityandReliabilityImprovement.ProceedingsoftheIEEE,81(5):703715,May1993.[20]D.Vallett.ICFailureAnalysis:TheImportanceofTestandDi-agnostics.IEEEDesignandTestofComputers,14(4):7682,July1997.[21]B.Vermeulen,M.andS.Goel.AutomaticGenera-tionofBreakpointHardwareforSiliconDebug.InProceedingsACM/IEEEDesignAutomationConference(DAC),pages514517,June2004.[22]B.Vermeulen,T.Waayers,andS.K.Goel.Core-BasedScanArchi-tectureforSiliconDebug.InProceedingsIEEEInternationalTestConference(ITC),pages638647,October2002.6"